$(function(){EventClass=function(){return{add:function(a,b,d){a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent?a.attachEvent("on"+b,d):a["on"+b]=d},remove:function(a,b,d){a.removeEventListener?a.removeEventListener(b,d,!1):a.detachEvent?a.detachEvent("on"+b,d):a["on"+b]=null}}}();var t=function(a){this.ctrs=[];this.style=this.rowspan=this.colspan=-1;for(var b in a)this[b]=a[b]};t.prototype.getStyle=function(){return-1==this.style?"":this.style};t.prototype.setStyle=function(a){this.style=
a};t.prototype.setRowSpan=function(a){this.rowspan=a};t.prototype.setColSpan=function(a){this.colspan=a};t.prototype.getControls=function(){return this.ctrs};t.prototype.setControls=function(a){this.ctrs=clone(a)};t.prototype.addControls=function(a){for(var b=0;b<a.length;b++)this.ctrs.push(a[b])};t.prototype.deleteControlWithRowIndex=function(a){this.ctrs.keySort(Controller.getObjectSortFromPosCol());a=TemplateList.getArrayControlFromColumn(this.ctrs,-1);$.each(a,function(){controls.splice(controls.indexOfObject(this),
1)});a.splice(this.ctrs.pos_row-1,1);for(var b=0;b<a.length;b++)a[b].pos_row=b+1};t.prototype.deleteControl=function(a){for(var b=!1,d=0;d<this.ctrs.length;d++)!0===b?this.ctrs[d].pos_row-=1:this.ctrs[d].control_id==a&&(this.ctrs.splice(this.ctrs.indexOfObject(this.ctrs[d]),1),b=!0)};t.prototype.clear=function(){this.ctrs=[];this.colspan=this.rowspan=-1;this.style=""};var v=function(a){var b;this.maxCol=this.maxRow=1;for(b in a)this[b]=a[b];if(this.items)for(a=0;a<this.maxRow;a++)for(b=0;b<this.maxCol;b++){var d=
this.items["cell_"+a+"-"+b];d&&new t({ctrs:d.ctrs,colspan:d.colspan,rowspan:d.rowspan})}else for(this.items={},a=0;a<this.maxRow;a++)for(b=0;b<this.maxCol;b++)this.items["cell_"+a+"-"+b]=new t({ctrs:[],colspan:-1,rowspan:-1})};v.prototype.setItems=function(a){this.items=a};v.prototype.getItems=function(){return this.items};v.prototype.getCell=function(a,b){return this.items["cell_"+a+"-"+b]};v.prototype.createCell=function(a,b,d,e,f){this.items["cell_"+a+"-"+b]=new t({rowspan:d,colspan:e,ctrs:f})};
v.prototype.getCellFromKey=function(a){return this.items[a]};v.prototype.deleteCellFromKey=function(a){delete this.items[a]};v.prototype.deleteCell=function(a,b){var d=this.items["cell_"+a+"-"+b];if(d)return d=clone(d.getControls()),delete this.items["cell_"+a+"-"+b],d};v.prototype.updateCellFromKey=function(a,b){var d=this.getCellFromKey(a);return void 0!==d?("undefined"!=typeof b.rowspan&&d.setRowSpan(b.rowspan),"undefined"!=typeof b.colspan&&d.setColSpan(b.colspan),"undefined"!=typeof b.ctrs&&
d.addControls(b.ctrs),"undefined"!=typeof b.style&&d.setStyle(b.style),!0):!1};v.prototype.updateCell=function(a,b,d){a=this.getCell(a,b);if(void 0!==a){"undefined"!=typeof d.rowspan&&a.setRowSpan(d.rowspan);"undefined"!=typeof d.colspan&&a.setColSpan(d.colspan);if("undefined"!=typeof d.ctrs){b=a.getControls();for(var e=0;e<d.ctrs.length;e++)d.ctrs[e].pos_row=b.length+e+1;a.addControls(d.ctrs)}"undefined"!=typeof d.style&&a.setStyle(d.style);return!0}return!1};v.prototype.getMultiCell=function(a){for(var b=
[],d=0;d<a.length;d++)b.push(this.getCell(a[d].rowIndex,a[d].cellIndex));return b};Controller={MapType:{text:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/ui-text-input-icon.png",tag:"input",type:"text",label:MyLang.getMsg("HTML_TEXT_BOX"),config:{attributes:{lblname:"",showlblname:!0,widthlbl:"100px",style:"width:100%",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,
showlblname:!0,widthlbl:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,value:!0,maxlength:!0,disabled:!0,readOnly:!0,placeholder:!0}}},textarea:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/ui-text-area-icon.png",tag:"textarea",label:MyLang.getMsg("HTML_TEXT_AREA"),type:null,config:{attributes:{lblname:"",widthlbl:"100px",showlblname:!0,style:"width:100%",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",
aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,value:!0,cols:!0,rows:!0,disabled:!0,readOnly:!0}}},label:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/ui_text_label.png",tag:"label",label:MyLang.getMsg("HTML_TEXT_LABEL"),config:{attributes:{lblname:"",class:"detail_name",showlblname:!1,style:"",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",
aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,showlblname:!1,beforecontent:!1,aftercontent:!1,name:!1,style:!0,class:!0,new_attrs:!1,value:!1,maxlength:!1,disabled:!1,readOnly:!1,placeholder:!0}}},serial_number:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/serial-numbers-icon.png",tag:"serial_number",label:MyLang.getMsg("HTML_TEXT_SERIAL_LABEL"),config:{attributes:{},settingfields:{}}},date:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/date.png",tag:"input",
type:"text",label:MyLang.getMsg("HTML_INPUT_DATE"),config:{attributes:{lblname:"",widthlbl:"100px",showlblname:!0,style:"width:100%",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:"",class:"date"},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,value:!0,maxlength:!0,disabled:!0,readOnly:!0,placeholder:!0}}},time:{show:!0,
iconUrl:BASE_URL+"/images/icon_ctr/time.png",tag:"input",type:"time",label:MyLang.getMsg("HTML_INPUT_TIME"),config:{attributes:{lblname:"",widthlbl:"100px",showlblname:!0,style:"width:100%",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:"",class:"time"},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,value:!0,maxlength:!1,
disabled:!0,readOnly:!0,placeholder:!0}}},color:{show:!1,iconUrl:BASE_URL+"/images/icon_ctr/color_wheel.png",tag:"input",type:"color",label:MyLang.getMsg("HTML_INPUT_COLOR"),config:{attributes:{lblname:"",widthlbl:"100px",showlblname:!0,style:"width:100%",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,
style:!0,class:!0,new_attrs:!0,value:!0,maxlength:!0,disabled:!0,readOnly:!0,placeholder:!0}}},email:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/mail.png",tag:"input",type:"email",label:MyLang.getMsg("HTML_INPUT_MAIL_ADDRESS"),config:{attributes:{lblname:"",widthlbl:"100px",showlblname:!0,style:"width:100%",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,widthlbl:!0,
showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,value:!0,maxlength:!0,disabled:!0,readOnly:!0,placeholder:!0}}},file:{show:!1,iconUrl:BASE_URL+"/images/icon_ctr/attach.png",tag:"input",type:"file",label:MyLang.getMsg("HTML_INPUT_UPLOAD_FILE"),config:{attributes:{lblname:"",widthlbl:"100px",showlblname:!0,style:"width:100%",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",
new_attrs:""},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,value:!0,maxlength:!0,disabled:!0,readOnly:!0,placeholder:!0}}},button:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/ui_button.png",tag:"input",type:"button",label:MyLang.getMsg("HTML_INPUT_BUTTON"),config:{attributes:{lblname:"",widthlbl:"100px",showlblname:!0,style:"width:100%",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",
aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!1,aftercontent:!1,name:!0,style:!0,class:!0,new_attrs:!0,value:!0,maxlength:!1,disabled:!0,readOnly:!0,placeholder:!0}}},submit:{show:!1,iconUrl:BASE_URL+"/images/icon_ctr/form_input_button_ok.png",tag:"input",type:"submit",label:MyLang.getMsg("HTML_INPUT_BUTTON_SUBMIT"),config:{attributes:{lblname:"",widthlbl:"100px",showlblname:!0,style:"width:100%",beforecontent:"",
beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,value:!0,maxlength:!0,disabled:!0,readOnly:!0,placeholder:!0}}},select:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/ui_combo_box_edit.png",tag:"select",type:null,label:MyLang.getMsg("HTML_INPUT_PULLDOWN"),config:{items:[],attributes:{lblname:"",
widthlbl:"100px",showlblname:!0,style:"width:100%",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,multiple:!0,value:!0,selectedIndex:!0,items:!0,disabled:!0}}},checkbox:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/checkbox_checked.png",tag:"input",type:"checkbox",label:MyLang.getMsg("HTML_INPUT_CHECKBOX"),
config:{attributes:{lblname:"",widthlbl:"100px",showlblname:!0,beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,checked:!0,disabled:!0,value:!0}}},checkboxgroup:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/group_input_checkbox.png",tag:"div",label:MyLang.getMsg("HTML_INPUT_CHECKBOX_GROUP"),
config:{items:[],attributes:{name:"",lblname:"",widthlbl:"100px",showlblname:!0,style:"",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",rbgdirection:"horizontal"},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,rbgdirection:!0,rbgitems:!0}}},radio:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/radio-button-on-icon.png",tag:"input",type:"radio",label:MyLang.getMsg("HTML_INPUT_RADIO"),
config:{attributes:{lblname:"",widthlbl:"100px",showlblname:!0,style:"",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,checked:!0,disabled:!0,value:!0}}},radiogroup:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/group_input_radio.png",tag:"div",label:MyLang.getMsg("HTML_INPUT_RADIO_GROUP"),
config:{items:[],attributes:{name:"",lblname:"",widthlbl:"100px",showlblname:!0,style:"",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",rbgdirection:"horizontal"},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,rbgdirection:!0,rbgitems:!0}}},boxgroup:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/ui-group-box-icon.png",tag:"div",label:MyLang.getMsg("HTML_INPUT_GROUP"),
config:{items:[],attributes:{name:"",lblname:"",widthlbl:"100px",showlblname:!0,style:"",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",bgdirection:"horizontal"},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,beforecontent:!0,aftercontent:!0,class:!0,new_attrs:!0,name:!0,style:!0,bgdirection:!0,bgitems:!0}}},box:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/html_input_box.png",tag:"div",label:MyLang.getMsg("HTML_INPUT_BOX"),
config:{html:"",attributes:{name:"",lblname:"",widthlbl:"100px",showlblname:!0,style:"",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:""},settingfields:{lblname:!0,widthlbl:!0,showlblname:!0,name:!0,style:!1,class:!1,new_attrs:!1,html:!0}}},hidden:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/ui_label_field.png",tag:"input",type:"hidden",label:MyLang.getMsg("HTML_INPUT_HIDDEN"),config:{attributes:{lblname:"",
widthlbl:"",showlblname:!1,style:"width:100%",new_attrs:""},settingfields:{lblname:!0,widthlbl:!1,showlblname:!1,beforecontent:!1,aftercontent:!1,name:!0,style:!1,class:!0,new_attrs:!0,value:!0,maxlength:!1,disabled:!1,readOnly:!1,placeholder:!1}}},grid:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/grid.png",tag:"div",label:"Grid\uff08\u30b0\u30ea\u30c3\u30c9\uff09",config:{items:[],attributes:{style:"width:100%",class:"",max_col:1,max_row:1,new_attrs:'cellspacing="0" cellpadding="0"'},settingfields:{name:!0,
style:!0,class:!0,new_attrs:!0,max_col:!0,max_row:!0}}},canvas:{show:!0,iconUrl:BASE_URL+"/images/icon_ctr/ui-canvas-icon.png",tag:"canvas",type:"canvas",label:MyLang.getMsg("HTML_CANVAS"),config:{attributes:{lblname:"",showlblname:!0,widthlbl:"100px",style:"border:solid 1px silver; float:left;",beforecontent:"",beforecontentcolor:"#000000",beforecontentbold:"normal",aftercontent:"",aftercontentcolor:"#000000",aftercontentbold:"normal",new_attrs:'width="72" height="72"'},settingfields:{lblname:!0,
showlblname:!0,widthlbl:!0,beforecontent:!0,aftercontent:!0,name:!0,style:!0,class:!0,new_attrs:!0,value:!1,maxlength:!1,disabled:!0,readOnly:!1,placeholder:!1}}}},clean:function(a){var b="lblname widthlbl showlblname beforecontent beforecontentcolor beforecontentbold aftercontent aftercontentcolor aftercontentbold new_attrs rbgdirection bgdirection".split(" "),d="name style class maxlength cols rows placeholder".split(" "),e=function(a){$.each($(a).children(),function(){var a=this;$.each(d,function(){void 0!=
$(a).attr(this)&&""==$(a).attr(this).trim()&&$(a).removeAttr(this)});$.each(b,function(){$(a).removeAttr(this)});0<$(a).children().length&&e(a)})};$.each(d,function(){void 0!=$(a).attr(this)&&""==$(a).attr(this).trim()&&$(a).removeAttr(this)});$.each(b,function(){$(a).removeAttr(this)});e(a);return a},addNewAttrs:function(a,b){b=b.replace(/\\\"/g,'"');b=unescapeAndDecodeHtml(b);try{var d="";if(""!=b.toString().trim()&&-1<b.toString().search('"')){var e="<span "+b+"></span>",f=document.createElement("div");
$(f).append(e);var c=$(f).children()[0];$.each(c.attributes,function(){""!==this.value?($(a).attr(this.name,this.value),d.result+=" "+this.name+'="'+this.value+'"'):($(a).attr(this.name,""),d.result+=" "+this.name,RenderLayout.addSpecialAttrs(this.name))})}else if(b=b.toString().trim().replace(/\"/g,""),-1<b.search("="))for(e=b.split(";"),f=0;f<e.length;f++){var g=e[f].split("=");g[0]&&g[1]&&($(a).attr(g[0].trim(),g[1]),d+=g[0].trim()+'="'+g[1]+'" ')}else e=b.split(" "),$.each(e,function(){$(a).attr(this.toString(),
"");d+=this.toString()+" ";RenderLayout.addSpecialAttrs(this.toString())});return escapeAndEncodeHtml(d.trim())}catch(h){return escapeAndEncodeHtml(b)}},isMarkMandatory:function(a){var b=!1;if("undefined"!=typeof a.config.items)if("boxgroup"===a.map_type_control){var d=[],e=null;$.each(a.config.items,function(){if("undefined"!=typeof this.config&&"undefined"!=typeof this.config.attributes&&"undefined"!=typeof this.config.attributes.name&&""!=this.config.attributes.name){var a=!1;"undefined"!=typeof this.config.attributes.class&&
-1<this.config.attributes.class.search("mandatory")&&(a=!0);d.push({name:this.config.attributes.name,is_mandatory:a});e=this.config.attributes.name}});e&&(b=!0,$.each(d,function(){if(this.name.toString()!=e||!this.is_mandatory)return b=!1}))}else $.each(a.config.items,function(){if("undefined"!=typeof this.config&&"undefined"!=typeof this.config.attributes&&"undefined"!=typeof this.config.attributes.class&&-1<this.config.attributes.class.search("mandatory"))return b=!0,!1});return b},create:function(a,
b,d){"undefined"==typeof d&&(d=!1);if("undefined"==typeof Controller.MapType[a.map_type_control]||"undefined"==typeof Controller.MapType[a.map_type_control].tag){var e=document.createElement("div");a.map_type_control="text";a.config={};a.config.attributes={};a.config.attributes.name=MyLang.getMsg("HTML_NOT_SUPPORT_TAG");a.config.attributes.lblname=MyLang.getMsg("HTML_NOT_SUPPORT_TAG");a.config.attributes.class="no_support";a.config.attributes.value=MyLang.getMsg("HTML_NOT_SUPPORT_TAG");a.config.config=
{};return Controller.create(a,b,d)}var f=clone(Controller.MapType[a.map_type_control]),e=document.createElement(f.tag);"undefined"!==typeof f.type&&null!=f.type&&e.setAttribute("type",f.type);if(f.config){var c=f.config;if(c.attributes){for(var g in c.attributes)e.setAttribute(g,c.attributes[g]);c.attributes.new_attrs&&(c.attributes.new_attrs=Controller.addNewAttrs(e,c.attributes.new_attrs))}}if("undefined"!=typeof a.config){if(a.config.attributes){for(g in a.config.attributes)"textarea"==a.map_type_control&&
"value"==g?e.setAttribute(g,unescapeAndDecodeHtml(a.config.attributes[g])):e.setAttribute(g,a.config.attributes[g]);a.config.attributes.new_attrs&&(c.attributes.new_attrs=Controller.addNewAttrs(e,a.config.attributes.new_attrs))}if("select"==a.map_type_control&&"undefined"!=typeof a.config&&"undefined"!=typeof a.config.items&&a.config.items)for(f=0;f<a.config.items.length;f++)c=a.config.items[f],g=new Option,g.text=c.text,g.value=c.value,""!=a.config.attributes.value&&a.config.attributes.value==c.value&&
g.setAttribute("selected","selected"),e.options.add(g)}if("TEXTAREA"==e.tagName&&void 0!=$(e).attr("class")&&-1<$(e).attr("class").search("richtext"))if(void 0!=a.config.attributes.style)if(f=a.config.attributes.style,-1<f.search("width"))for(c=f.split(";"),f=0;f<c.length;f++){if(g=c[f].split(":"),2==g.length&&"width"==g[0]&&""==g[1].trim()){e.style.width="0px";break}}else";"==f[f.length-1]&&f.substring(0,f.length-1),e.style.width="0px";else a.config.attributes.style="width:0px",e.style.width="0px";
if("radiogroup"==a.map_type_control)for("undefined"==typeof a.config.attributes.rbgdirection&&(a.config.attributes.rbgdirection="horizontal"),c=Controller.isMarkMandatory(a),f=0;f<a.config.items.length;f++){g=Controller.create(a.config.items[f],b,c);var h="",h=h+g.outerHTML,l="";!1!=Controller.getShowLabelName(g)&&(l=Controller.getLabelName(g));void 0!=$(g).attr("class")&&-1<$(g).attr("class").search("mandatory")&&!c&&(l+='&nbsp;<font color="red">*</font>');h+=""!=l.trim()?"<span>"+l+"</span>":l;
"horizontal"!=a.config.attributes.rbgdirection&&(h+="<br>");$(e).append(h)}if("checkboxgroup"==a.map_type_control)for("undefined"==typeof a.config.attributes.rbgdirection&&(a.config.attributes.rbgdirection="horizontal"),c=Controller.isMarkMandatory(a),f=0;f<a.config.items.length;f++)g=Controller.create(a.config.items[f],b,c),h="",h+=g.outerHTML,l="",!1!=Controller.getShowLabelName(g)&&(l=Controller.getLabelName(g)),void 0!=$(g).attr("class")&&-1<$(g).attr("class").search("mandatory")&&!c&&(l+='&nbsp;<font color="red">*</font>'),
h+=""!=l.trim()?"<span>"+l+"</span>":l,"horizontal"!=a.config.attributes.rbgdirection&&(h+="<br>"),$(e).append(h);if("boxgroup"==a.map_type_control){c=Controller.isMarkMandatory(a);h="";"undefined"==typeof a.config.attributes.bgdirection&&(a.config.attributes.bgdirection="horizontal");if("horizontal"==a.config.attributes.bgdirection){h+='<table style="width: 100%;" cellspacing="0" cellpadding="0"><tr>';for(f=0;f<a.config.items.length;f++){g=Controller.create(a.config.items[f],!1,c);h="label"!=a.config.items[f].map_type_control&&
"true"==a.config.items[f].config.attributes.showlblname.toString()?h+('<td class="'+a.config.items[f].config.attributes.class+'">'):h+"<td>";if("label"==a.config.items[f].map_type_control){$(g).text(a.config.items[f].config.attributes.lblname);var k=document.createElement("div");$(k).attr("style",$(g).attr("style"));k.className=g.className;Controller.clean(g);g.className="";$(k).append(g);h+=k.outerHTML}else{l="";!1!=Controller.getShowLabelName(g)&&(l=Controller.getLabelName(g));c||void 0!=$(g).attr("class")&&
-1<$(g).attr("class").search("mandatory")&&(l+='&nbsp;<font color="red">*</font>');h+=""!=l.trim()?"<span>"+l+"</span>":l;h+="</td><td>";"textarea"==a.config.items[f].map_type_control&&($(g).text(unescapeAndDecodeHtml($(g).attr("value"))),$(g).removeAttr("value"));k=document.createElement("label");if(g.hasAttribute("beforecontent")){var l=Controller.getValueFromAttrName(g,"beforecontentcolor"),m=Controller.getValueFromAttrName(g,"beforecontentbold");""!=g.getAttribute("beforecontent").trim()&&$(k).append('<span style="color:'+
l+";font-weight:"+m+'">'+g.getAttribute("beforecontent")+"</span>")}$(k).append(g);g.hasAttribute("aftercontent")&&(l=Controller.getValueFromAttrName(g,"aftercontentcolor"),m=Controller.getValueFromAttrName(g,"aftercontentbold"),""!=g.getAttribute("aftercontent").trim()&&$(k).append('<span style="color:'+l+";font-weight:"+m+'">'+g.getAttribute("aftercontent")+"</span>"));h+=k.innerHTML}h+="</td>"}h+="</tr></table>"}else for(f=0;f<a.config.items.length;f++)h+='<table style="width: 100%;" cellspacing="0" cellpadding="0"><tr>',
g=Controller.create(a.config.items[f],!1,c),h="label"!=a.config.items[f].map_type_control&&"true"==a.config.items[f].config.attributes.showlblname.toString()?h+('<td class="'+a.config.items[f].config.attributes.class+'">'):h+"<td>","label"==a.config.items[f].map_type_control?($(g).text(a.config.items[f].config.attributes.lblname),k=document.createElement("div"),$(k).attr("style",$(g).attr("style")),k.className=g.className,Controller.clean(g),g.className="",$(k).append(g),h+=k.outerHTML):(l="",!1!=
Controller.getShowLabelName(g)&&(l=Controller.getLabelName(g)),c||void 0!=$(g).attr("class")&&-1<$(g).attr("class").search("mandatory")&&(l+='&nbsp;<font color="red">*</font>'),h+=""!=l.trim()?"<span>"+l+"</span>":l,h+="</td><td>","textarea"==a.config.items[f].map_type_control&&($(g).text(unescapeAndDecodeHtml($(g).attr("value"))),$(g).removeAttr("value")),k=document.createElement("label"),g.hasAttribute("beforecontent")&&(l=Controller.getValueFromAttrName(g,"beforecontentcolor"),m=Controller.getValueFromAttrName(g,
"beforecontentbold"),""!=g.getAttribute("beforecontent").trim()&&$(k).append('<span style="color:'+l+";font-weight:"+m+'">'+g.getAttribute("beforecontent")+"</span>")),$(k).append(g),g.hasAttribute("aftercontent")&&(l=Controller.getValueFromAttrName(g,"aftercontentcolor"),m=Controller.getValueFromAttrName(g,"aftercontentbold"),""!=g.getAttribute("aftercontent").trim()&&$(k).append('<span style="color:'+l+";font-weight:"+m+'">'+g.getAttribute("aftercontent")+"</span>")),h+=k.innerHTML),h+="</td>",
h+="</tr></table>";$(e).append(h)}"undefined"==typeof b&&(b=!1);if(!1==b)return e;k=document.createElement("label");if("label"==a.map_type_control)return $(e).text($(e).attr("lblname")),$(e).removeAttr("value"),k=document.createElement("div"),$(k).attr("style",$(e).attr("style")),k.className=e.className,Controller.clean(e),e.className="",$(k).append(e),k;if("box"==a.map_type_control)return $(e).html(unescapeAndDecodeHtml(a.config.html)),e;e.hasAttribute("lblname")&&(l=e.getAttribute("lblname"),void 0!=
$(e).attr("class")&&-1<$(e).attr("class").search("mandatory")&&!d&&(l+='&nbsp;<font color="red">*</font>'),k.setAttribute("lblname",l));e.hasAttribute("widthlbl")&&k.setAttribute("widthlbl",e.getAttribute("widthlbl"));e.hasAttribute("showlblname")&&k.setAttribute("showlblname",e.getAttribute("showlblname"));e.hasAttribute("beforecontent")&&(k.setAttribute("beforecontent",e.getAttribute("beforecontent")),e.hasAttribute("beforecontentcolor")&&k.setAttribute("beforecontentcolor",e.getAttribute("beforecontentcolor")),
e.hasAttribute("beforecontentbold")&&k.setAttribute("beforecontentbold",e.getAttribute("beforecontentbold")),l=Controller.getValueFromAttrName(e,"beforecontentcolor"),m=Controller.getValueFromAttrName(e,"beforecontentbold"),""!=e.getAttribute("beforecontent").trim()&&$(k).append('<span style="color:'+l+";font-weight:"+m+'">'+e.getAttribute("beforecontent")+"</span>"));"textarea"==a.map_type_control&&($(e).text($(e).attr("value")),$(e).removeAttr("value"));$(k).append(e);e.hasAttribute("aftercontent")&&
(k.setAttribute("aftercontent",e.getAttribute("aftercontent")),e.hasAttribute("aftercontentcolor")&&k.setAttribute("aftercontentcolor",e.getAttribute("aftercontentcolor")),e.hasAttribute("aftercontentbold")&&k.setAttribute("aftercontentbold",e.getAttribute("aftercontentbold")),l=Controller.getValueFromAttrName(e,"aftercontentcolor"),m=Controller.getValueFromAttrName(e,"aftercontentbold"),""!=e.getAttribute("aftercontent").trim()&&$(k).append('<span style="color:'+l+";font-weight:"+m+'">'+e.getAttribute("aftercontent")+
"</span>"));return k},getLabelName:function(a){return a.hasAttribute("lblname")?$(a).attr("lblname"):""},getShowLabelName:function(a){return a.hasAttribute("showlblname")&&"true"==$(a).attr("showlblname")?!0:!1},getValueFromAttrName:function(a,b){return a.hasAttribute(b)&&"undefined"!=$(a).attr(b)?$(a).attr(b):""},getObjectSortFromPosCol:function(){return{pos_col:"asc",pos_row:"asc"}},moveControlOutGrid:function(a,b,d,e,f,c,g){var h=$(b).attr("cell_key");a=a.getCellFromKey(h);var l=a.getControls();
l.keySort(Controller.getObjectSortFromPosCol());h=TemplateList.getArrayControlFromColumn(l,-1);$.each(h,function(){l.splice(l.indexOfObject(this),1)});d=h.splice(d-1,1)[0];d.pos_col=c;for(var k=[],m=0;m<h.length;m++){var p=h[m];p.pos_row=m+1;k.push(p)}$.each(k,function(){$(b).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});l=l.concat(h);a.setControls(l);h=TemplateList.getArrayControlFromColumn(e,c);$.each(h,function(){e.splice(e.indexOfObject(this),1)});h.splice(g,
0,d);k=[];for(m=0;m<h.length;m++)p=h[m],p.pos_row=m+1,k.push(p);$.each(k,function(){$(f).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});return e=e.concat(h)},findGridNameByControl:function(a){return a?0<$(a).parent("div[grideditor=true]").length?$(parent[0]).attr("name"):null:null},moveControlInGrid:function(a,b,d,e,f,c){if($(e).attr("cell_key")===$(b).attr("cell_key")){debugLog("*** case 1: move control in cell grid");var g=$(e).attr("cell_key"),g=a.getCellFromKey(g),
h=g.getControls();h.keySort(Controller.getObjectSortFromPosCol());if(c){var l=1;$.each(h,function(){if(this.control_id===c)return f=l,!1;l++})}var k=TemplateList.getArrayControlFromColumn(h,-1);$.each(k,function(){h.splice(h.indexOfObject(this),1)});d=k.splice(d-1,1)[0];k.splice(f,0,d);for(var m=[],p=0;p<k.length;p++){var n=k[p];n.pos_row=p+1;m.push(n)}}else{debugLog("*** case 2: move control in other cell grid");g=$(b).attr("cell_key");g=a.getCellFromKey(g);h=g.getControls();h.keySort(Controller.getObjectSortFromPosCol());
k=TemplateList.getArrayControlFromColumn(h,-1);$.each(k,function(){h.splice(h.indexOfObject(this),1)});d=k.splice(d-1,1)[0];m=[];for(p=0;p<k.length;p++)n=k[p],n.pos_row=p+1,m.push(n);$.each(m,function(){$(b).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});h=h.concat(k);g.setControls(h);g=$(e).attr("cell_key");g=a.getCellFromKey(g);h=g.getControls();h.keySort(Controller.getObjectSortFromPosCol());k=TemplateList.getArrayControlFromColumn(h,-1);$.each(k,function(){h.splice(h.indexOfObject(this),
1)});k.splice(f,0,d);m=[];for(p=0;p<k.length;p++)n=k[p],n.pos_row=p+1,m.push(n)}$.each(m,function(){$(e).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});h=h.concat(k);g.setControls(h);debugLog(a)},moveControlToGrid:function(a,b,d,e,f,c,g){a.keySort(Controller.getObjectSortFromPosCol());d=TemplateList.getArrayControlFromColumn(a,d);$.each(d,function(){a.splice(a.indexOfObject(this),1)});e=d.splice(e-1,1)[0];e.pos_col=-1;for(var h=[],l=0;l<d.length;l++){var k=d[l];k.pos_row=
l+1;h.push(k)}$.each(h,function(){$(b).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});a=a.concat(d);d=$(c).attr("cell_key");f=f.getCellFromKey(d);var m=f.getControls();m.keySort(Controller.getObjectSortFromPosCol());d=TemplateList.getArrayControlFromColumn(m,-1);$.each(d,function(){m.splice(m.indexOfObject(this),1)});d.splice(g,0,e);h=[];for(l=0;l<d.length;l++)k=d[l],k.pos_row=l+1,h.push(k);$.each(h,function(){$(c).find('div[id="'+this.control_id+'"]').attr("pos_row",
this.pos_row.toString());$(c).find('div[id="'+this.control_id+'"]').attr("section_id",$(c).attr("section_id"))});m=m.concat(d);f.setControls(m);return a},moveCellControlToGrid:function(a,b,d,e,f,c){var g=$(b).attr("cell_key"),g=a.getCellFromKey(g),h=g.getControls();h.keySort(Controller.getObjectSortFromPosCol());a=TemplateList.getArrayControlFromColumn(h,-1);$.each(a,function(){h.splice(h.indexOfObject(this),1)});d=a.splice(d-1,1)[0];d.pos_col=-1;for(var l=[],k=0;k<a.length;k++){var m=a[k];m.pos_row=
k+1;l.push(m)}$.each(l,function(){$(b).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});h=h.concat(a);g.setControls(h);g=$(f).attr("cell_key");g=e.getCellFromKey(g);h=g.getControls();h.keySort(Controller.getObjectSortFromPosCol());a=TemplateList.getArrayControlFromColumn(h,-1);$.each(a,function(){h.splice(h.indexOfObject(this),1)});a.splice(c,0,d);l=[];for(k=0;k<a.length;k++)m=a[k],m.pos_row=k+1,l.push(m);$.each(l,function(){$(f).find('div[id="'+this.control_id+'"]').attr("pos_row",
this.pos_row.toString());$(f).find('div[id="'+this.control_id+'"]').attr("section_id",$(f).attr("section_id"))});h=h.concat(a);g.setControls(h)},changePosControlInControlsSamePosCol:function(a,b,d,e,f){a.keySort(Controller.getObjectSortFromPosCol());var c=null;d=TemplateList.getArrayControlFromColumn(a,d);$.each(d,function(){a.splice(a.indexOfObject(this),1)});c=d.splice(e-1,1)[0];d.splice(f-1,0,c);e=[];for(f=0;f<d.length;f++)c=d[f],c.pos_row=f+1,e.push(c);$.each(e,function(){$(b).find('div[id="'+
this.control_id+'"]').attr("pos_row",this.pos_row.toString())});return a=a.concat(d)},changePosControlInControlsNotSamePosCol:function(a,b,d,e,f,c,g){a.keySort(Controller.getObjectSortFromPosCol());d=TemplateList.getArrayControlFromColumn(a,d);e=d.splice(e-1,1)[0];e=a.splice(a.indexOfObject(e),1)[0];e.pos_col=c;for(var h=[],l=0;l<d.length;l++){var k=d[l];k.pos_row=l+1;h.push(k)}$.each(h,function(){$(b).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});d=TemplateList.getArrayControlFromColumn(a,
c);$.each(d,function(){a.splice(a.indexOfObject(this),1)});d.splice(g,0,e);h=[];for(l=0;l<d.length;l++)k=d[l],k.pos_row=l+1,k.pos_col=c,h.push(k);$.each(h,function(){$(f).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});return a=a.concat(d)},moveControlToOrtherSection:function(a,b,d,e,f,c,g,h){a.keySort(Controller.getObjectSortFromPosCol());f.keySort(Controller.getObjectSortFromPosCol());d=TemplateList.getArrayControlFromColumn(a,d);$.each(d,function(){a.splice(a.indexOfObject(this),
1)});var l=d.splice(e-1,1)[0];l.pos_col=g;$(c).attr("section_id")&&(l.section_id=$(c).attr("section_id"),$(c).find('div[id="'+l.control_id+'"]').attr("section_id",l.section_id),$.each($(c).find('div[id="'+l.control_id+'"]').find("div.droptrue.ui-sortable"),function(){$(this).attr("section_id",l.section_id)}));e=[];for(var k=0;k<d.length;k++){var m=d[k];m.pos_row=k+1;e.push(m)}$.each(e,function(){$(b).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});a=a.concat(d);d=TemplateList.getArrayControlFromColumn(f,
g);$.each(d,function(){f.splice(f.indexOfObject(this),1)});d.splice(h,0,l);e=[];for(k=0;k<d.length;k++)m=d[k],m.pos_row=k+1,e.push(m);$.each(e,function(){$(c).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});f=f.concat(d);return{controls_old:a,controls_new:f}},asyncItemsInControls:function(a,b,d,e){$.each(b,function(){this.control_id=MainLayout.createNewControlId();this.section_id=d;"radiogroup"==a.map_type_control&&"undefined"!=typeof a.config&&"undefined"!=typeof a.config.attributes&&
"undefined"!=typeof a.config.attributes.name&&"undefined"!=typeof this.config&&"undefined"!=typeof this.config.attributes&&"undefined"!=typeof this.config.attributes.name&&(this.config.attributes.name=a.config.attributes.name);"checkboxgroup"==a.map_type_control&&"undefined"!=typeof a.config&&"undefined"!=typeof a.config.attributes&&"undefined"!=typeof a.config.attributes.name&&"undefined"!=typeof this.config&&"undefined"!=typeof this.config.attributes&&"undefined"!=typeof this.config.attributes.name&&
(this.config.attributes.name=a.config.attributes.name);"undefined"!=typeof this.config&&"undefined"!=typeof this.config.attributes&&"undefined"!=typeof this.config.attributes.name&&e&&(this.config.attributes.name+="_copy");"undefined"!=typeof this.config&&"undefined"!=typeof this.config.items&&e&&Controller.asyncItemsInControls(this,this.config.items,d)})},asyncControls:function(a,b){$.each(a,function(){this.control_id=MainLayout.createNewControlId();this.section_id=b;"undefined"!=typeof this.config&&
"undefined"!=typeof this.config.items&&Controller.asyncItemsInControls(this,this.config.items,b)})}};TemplateList={data:[],getTemplateDetail:function(a){for(var b=0;b<TemplateList.data.length;b++)if(a==TemplateList.data[b].id)return TemplateList.data[b];return null},getSectionDetail:function(a,b){var d=TemplateList.getTemplateDetail(a);if(d)for(var e=0;e<d.sections.length;e++){var f=d.sections[e];if(b==f.section_id)return f}return null},getControlDetail:function(a,b,d){if(a=TemplateList.getSectionDetail(a,
b))for(b=0;b<a.controls.length;b++){var e=a.controls[b];if(d==e.control_id)return e}return null},findSectionIdInTemplate:function(a,b){return TemplateList.getSectionDetail(a,b)?!0:!1},findControlIdInSection:function(a,b,d){return TemplateList.getControlDetail(a,b,d)?!0:!1},findControlIdInTemplate:function(a,b){var d=TemplateList.getTemplateDetail(a);if(d)for(var e in d.sections){var f=d.sections[e],c;for(c in f.controls){var g=f.controls[c];if(b==g.control_id)return g.section_id=f.section_id,g}}return null},
getArrayControlFromColumn:function(a,b){return $.grep(a,function(a){return parseInt(a.pos_col)==parseInt(b)})},requestSaveBuilderJsonMemcache:function(a,b){var d=$("#template_id").val(),e=$("#copy_template_id").val(),f=$("#copy_type").val(),c=$("#revision_id").val();Ext.Ajax.request({params:""!==c?{builder_json:a,revision_id:c}:{builder_json:a,copy_template_id:e,copy_type:f},url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+APP_ID+"/"+d+"/htmlbuilder",method:"POST",timeout:12E4,success:function(a,
c){"status=ok"==a.responseText?b(!0):b(!1)},failure:function(a){b(!1)}})},requestGetTemplateDetail:function(a,b){Ext.Ajax.request({params:{action:"get_template_detail",template_id:a},url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+APP_ID+"/"+a+"/htmlbuilder",method:"POST",timeout:12E4,success:function(a,e){var f=Ext.decode(a.responseText);b(f)},failure:function(a){b(!1)}})}};TrashTemplate={data:[],getTemplateDetail:function(a){for(var b=0;b<TrashTemplate.data.length;b++)if(a==TrashTemplate.data[b].id)return TrashTemplate.data[b];
return null},getControlDetails:function(a,b){var d=TrashTemplate.getTemplateDetail(a);if(d)for(var e=0;e<d.controls.length;e++)if(b==d.controls[e].control_id)return d.controls[e];return null},popControlInTrash:function(a,b){var d=TrashTemplate.getTemplateDetail(a);if(d)for(var e=0;e<d.controls.length;e++)if(b==d.controls[e].control_id){var f=d.controls[e];d.controls.splice(e,1);return f}return null},pushControlToTrash:function(a,b,d){var e=TrashTemplate.getTemplateDetail(a);e?(e.name=b,TrashTemplate.getControlDetails(a,
d.control_id)||(e.controls||(e.controls=[]),e.controls.push(clone(d)))):(e={},e.id=a,e.name=b,e.controls=[],e.controls.push(clone(d)),TrashTemplate.data.push(e))}};MainLayout={layout:[],elmTemplateList:null,elmLayoutMain:null,elmMainMatrix:null,elmTrashTemplate:null,posSection:0,objectTmp:null,nextTab:function(a){a=parseInt(a);MyPanel.tabSet.setActiveTab(MyPanel.tabDefine[a].name)},saveTemplate:function(a){"undefined"==typeof a&&(a=!1);var b=MainLayout.elmTemplateList.val(),d=TemplateList.getTemplateDetail(b),
e=MainLayout.elmMainMatrix.find(".infoBlk"),f=[],c=!0;$.each(e,function(){var a=TemplateList.getSectionDetail(b,this.id);a.className=!0==c?"infoBlk":!0==a.show_header?"infoBlk mgt25":"infoBlk mgt5";c=!1;f.push({section_id:a.section_id,secname:a.secname,collapsible:a.collapsible,sec_class:a.sec_class,sec_attr_name:a.sec_attr_name,sec_attrs:a.sec_attrs,column_cof:a.column_cof,show_header:a.show_header,show_inner_header:a.show_inner_header,setting_inner_header:a.setting_inner_header,controls:a.controls})});
d.sections=f;!1==a&&(b=MainLayout.elmTemplateList.val(),a=TrashTemplate.getTemplateDetail(b),a||(a={},a.id=b,a.name=d.name,a.controls=[]),MainLayout.nextTab(1))},moveUpSection:function(a){var b=MainLayout.elmTemplateList.val(),d=TemplateList.getTemplateDetail(b);a=$(a).attr("section_id");b=TemplateList.getSectionDetail(b,a);b=d.sections.indexOfObject(b);0<b&&(a=d.sections.splice(b,1)[0],d.sections.splice(b-1,0,a),MainLayout.init())},moveDownSection:function(a){var b=MainLayout.elmTemplateList.val(),
d=TemplateList.getTemplateDetail(b);a=$(a).attr("section_id");b=TemplateList.getSectionDetail(b,a);b=d.sections.indexOfObject(b);b<d.sections.length&&(a=d.sections.splice(b,1)[0],d.sections.splice(b+1,0,a),MainLayout.init())},randomStringId:function(a){for(var b=["a","b","c","d","e","f","g","h","i","j","k","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",1,2,3,4,5,6,7,8,9,0],d="",e=0;16>
e;e++)var f=Math.floor(Math.random()*b.length),d=d+b[f];b=new Date;b=(new Date(b.getTime()+6E4*b.getTimezoneOffset())).getTime();return a+"-"+b+d},createNewSectionId:function(){return MainLayout.randomStringId("sec_id")},createNewControlId:function(){return MainLayout.randomStringId("ctr_id")},init:function(a){MainLayout.elmTemplateList=$("#templatelist");MainLayout.elmLayoutMain=$("#layoutMain");MainLayout.elmMainMatrix=$("#mainMatrix");MainLayout.elmTrashTemplate=$("#sortable_trash");MainLayout.elmSateraitoFormScript=
$("#sateraito_form_script_render");MainLayout.elmTemplateList.empty();MainLayout.addOptToElmTemplateList();MainLayout.loadMainMatrix();MainLayout.elmTemplateList.change(function(){MainLayout.loadMainMatrix(MainLayout.elmTemplateList.val())});"function"==typeof a&&a()},reload:function(a){MainLayout.addOptToElmTemplateList();"function"==typeof a&&a()},addOptToElmTemplateList:function(){MainLayout.elmTemplateList.empty();for(var a=TemplateList.data,b=0;b<a.length;b++){var d=a[b];MainLayout.elmTemplateList.append('<option value="'+
d.id+'" selected>'+d.name+"</option>")}},setEventToggleSection:function(){$.each(MainLayout.elmMainMatrix.find(".toggle_section"),function(){$(this).unbind("click");$(this).click(function(){var a=this;$("#"+$(this).attr("section_id")).find(".tblCtrls").slideToggle(200,function(){"up"==$(a).attr("status")?($(a).attr("status","down"),$(a).attr("class","toggle_section x-tool toggle-")):($(a).attr("status","up"),$(a).attr("class","toggle_section x-tool toggle_plus"))})})})},loadMainMatrix:function(a){MainLayout.elmMainMatrix.html("");
a="undefined"==typeof a?MainLayout.elmTemplateList.val():a;var b=TemplateList.getTemplateDetail(a);if(b){for(var b=b.sections,d=0;d<b.length;d++)MainLayout.createSection(b[d]);MainLayout.setEventToggleSection()}if(MainLayout.sateraito_script){var b={section_id:"sec_sateraito_from_script",secname:MyLang.getMsg("MSG_INPUT_JAVASCRIPT_SECTION")},d=""+MainLayout.createHtmlHeaderSection(b,!0),d=d+'<table class="tblCtrls" id="sec_sateraito_from_script_table" style="display: none;"><tr>',d=d+"<td>",d=d+'<textarea name="sateraito_from_script_content" cols="1" rows="5" style="width: 100%;resize:both;" >',
d=d+MainLayout.sateraito_script.textContent,d=d+"</textarea>",d=d+"</td>",d=d+"</tr>",d=d+"</table>",e=document.createElement("div");e.id=b.section_id;e.className="infoBlk mgt25";e.innerHTML=d;MainLayout.elmSateraitoFormScript.html("");MainLayout.elmSateraitoFormScript.append(e);MainLayout.elmSateraitoFormScript.find('textarea[name="sateraito_from_script_content"]').mouseout(function(){MainLayout.sateraito_script.textContent=$(this).val()});MainLayout.elmSateraitoFormScript.find('textarea[name="sateraito_from_script_content"]').keydown(function(){MainLayout.sateraito_script.textContent=
$(this).val()});$("#toggle_"+b.section_id).click(function(){var a=this;$("#sec_sateraito_from_script_table").slideToggle(200,function(){"up"==$(a).attr("status")?($(a).attr("status","down"),$(a).attr("class","x-tool toggle-")):($(a).attr("status","up"),$(a).attr("class","x-tool toggle_plus"))})})}MainLayout.loadTrashTemplate(a)},loadTrashTemplate:function(a){MainLayout.elmTrashTemplate.html("");if(a=TrashTemplate.getTemplateDetail(a)){a=a.controls;for(var b=0;b<a.length;b++){var d=a[b];MainLayout.elmTrashTemplate.append(MainLayout.createHtmlDivControl(d.section_id,
d))}}},deleteForeverTrash:function(){Ext.Msg.show({icon:Ext.MessageBox.QUESTION,msg:MyLang.getMsg("MSG_DELETE_COMP"),buttons:Ext.Msg.OKCANCEL,fn:function(a){"ok"==a&&(a=MainLayout.elmTemplateList.val(),TemplateList.getTemplateDetail(a)&&(a=TrashTemplate.getTemplateDetail(a)))&&(a.controls=[],$("#sortable_trash").html(""))}})},updateCfg:function(){MainLayout.setEventToggleSection();MainLayout.processInitEvents()},showCreateNewCF:function(){if(!1!=MainLayout.hasSelectedTemplate()){var a=MainLayout.elmTemplateList.val();
(a=TemplateList.getTemplateDetail(a))&&0==a.sections.length?Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_MUST_CREATE_SECTION"),buttons:Ext.Msg.OK}):PopupToolsCtr.show(null,function(a){var d=MainLayout.elmTemplateList.val(),e=a.section_id,f=a.map_type,d=TemplateList.getSectionDetail(d,e),c=d.controls,g=a.column_section;if("serial_number"==f)if(a=a.serial_number_setting,"horizontal"==a.direction)for(var h=g;h<=d.column_cof;h++){c.keySort(Controller.getObjectSortFromPosCol());var l=
TemplateList.getArrayControlFromColumn(c,h);$.each(l,function(){c.splice(c.indexOfObject(this),1)});var k=MainLayout.createNewControlId(),m=clone(Controller.MapType.label);m.map_type_control="label";m.control_id=k;m.pos_col=h;m.pos_row=l.length+1;e=a.custom_name+h;m.config.attributes.lblname=e;m.config.attributes.style=a.style;m.config.attributes.class=a.class;l.push(m);d.controls=d.controls.concat(l)}else{c.keySort(Controller.getObjectSortFromPosCol());l=TemplateList.getArrayControlFromColumn(c,
g);$.each(l,function(){c.splice(c.indexOfObject(this),1)});for(h=0;h<a.length;h++)k=MainLayout.createNewControlId(),m=clone(Controller.MapType.label),m.map_type_control="label",m.control_id=k,m.pos_col=g,m.pos_row=l.length+1,e=a.custom_name+(h+1),m.config.attributes.lblname=e,m.config.attributes.style=a.style,m.config.attributes.class=a.class,l.push(m);d.controls=d.controls.concat(l)}else{c.keySort(Controller.getObjectSortFromPosCol());l=TemplateList.getArrayControlFromColumn(c,g);$.each(l,function(){c.splice(c.indexOfObject(this),
1)});for(h=0;h<a.number_control;h++){var p=clone(a),n=p.attributes,k=MainLayout.createNewControlId(),m={};m.control_id=k;m.map_type_control=f;m.pos_col=g;m.pos_row=l.length+1;m.config={};m.config.attributes=n;k=void 0!=n.name?n.name:"";0<h&&(k+=""+h);m.config.attributes.name=k;"undefined"!=typeof p.items&&(k=p.items,Controller.asyncItemsInControls(m,k,e),m.config.items=k);"undefined"!=typeof p.html&&(m.config.html=p.html);l.push(m)}d.controls=d.controls.concat(l)}MainLayout.updateControlInSection(d)})}},
showPopupEditCtr:function(a){a=$(a).attr("control_id");var b=TemplateList.findControlIdInTemplate(MainLayout.elmTemplateList.val(),a);b&&PopupToolsCtr.show(b,function(a){var e=MainLayout.elmTemplateList.val(),f=b.section_id;if(!0==a.mode_delete){e=MainLayout.elmTemplateList.val();TemplateList.getTemplateDetail(e);var e=TemplateList.getSectionDetail(e,f),c=e.controls;c.keySort(Controller.getObjectSortFromPosCol());a=TemplateList.getArrayControlFromColumn(c,b.pos_col);$.each(a,function(){c.splice(c.indexOfObject(this),
1)});a.splice(b.pos_row-1,1);for(f=0;f<a.length;f++){var g=a[f];g.pos_row=f+1}e.controls=e.controls.concat(a)}else{var g=a.map_type,h=a.attributes,e=TemplateList.getSectionDetail(e,f);b.map_type_control=g;b.config.attributes=h;"undefined"!=typeof a.items&&(b.config.items=clone(a.items),Controller.asyncItemsInControls(b,b.config.items,f));"undefined"!=typeof a.html&&(b.config.html=clone(a.html));if(!0==a.mode_save_and_copy){c=e.controls;c.keySort(Controller.getObjectSortFromPosCol());a=TemplateList.getArrayControlFromColumn(c,
b.pos_col);g=a.indexOfObject(b);h=clone(b);h.control_id=MainLayout.createNewControlId();h.config.attributes.name+="_copy";h.config.attributes.lblname+=MyLang.getMsg("MSG_COMP_COPY");"undefined"!=typeof h.config.items&&Controller.asyncItemsInControls(h,h.config.items,f);$.each(a,function(){c.splice(c.indexOfObject(this),1)});a.splice(g+1,0,h);for(f=0;f<a.length;f++)g=a[f],g.pos_row=f+1;e.controls=e.controls.concat(a)}}MainLayout.updateControlInSection(e)})},processInitEvents:function(){function a(a){function d(a,
b){"undefined"===typeof b&&(b=!1);b?$(a).find("td.pos_import_edit").append('<span control_id="'+a.id+'" section_id="'+$(a).attr("section_id")+'" onclick="GridUtil.go_edit_ctr_cell_grid(this)" class="img_edit_ctr floatR"></span>'):$(a).find("td.pos_import_edit").append('<span control_id="'+a.id+'" section_id="'+$(a).attr("section_id")+'" onclick="MainLayout.showPopupEditCtr(this)" class="img_edit_ctr floatR"></span>')}a.mouseover(function(){var a=$(this).find(".img_edit_ctr"),b=$(this).parent();b.attr("in_grid")&&
"true"===b.attr("in_grid")?0==a.length?d(this,!0):"GridUtil.go_edit_ctr_cell_grid(this)"!=a.attr("onclick")&&a.attr("onclick","GridUtil.go_edit_ctr_cell_grid(this)"):0==a.length?d(this):"MainLayout.showPopupEditCtr(this)"!=a.attr("onclick")&&a.attr("onclick","MainLayout.showPopupEditCtr(this)");a.show()});a.mouseout(function(){$(this).find(".img_edit_ctr").hide()})}debugLog("=> function processInitEvents()");$("table[gridEditor=true]").off("click",".cell-sortable");$("table[gridEditor=true]").on("click",
".cell-sortable",GridUtil.handlerOnClick);$(".ui-sortable").sortable({placeholder:"dragging_highlight",scroll:!0,revert:!1,cancel:".img_edit_ctr",forcePlaceholderSize:!0,tolerance:"pointer",cursorAt:{top:15,left:10},start:function(a,d){var e=0;-1<$(d.item).attr("class").search("mgt25")&&(e=25);d.placeholder.css({marginTop:e,marginBottom:0})},beforeStop:function(a,d){},stop:function(a,d){debugLog("DRAG-START: ui-sortable ");var e=!0;"false"==d.item.attr("move_trash")&&"sortable_trash"==d.item[0].parentNode.id&&
(e=!1,setTimeout(function(){Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_COMP_DROP_DRAG_ERR"),buttons:Ext.Msg.OK})},50));MainLayout.saveTemplate(!0);debugLog("DRAG-END: ui-sortable ");return e}}).disableSelection();$("div.droptrue").sortable({connectWith:".droptrue",placeholder:"dragging_highlight",scroll:!0,revert:!1,forcePlaceholderSize:!0,tolerance:"pointer",items:"> .item_jig",cursorAt:{top:15,left:10},start:function(a,d){var e=d.item[0].parentNode;$(e).find("> .item_jig").each(function(a,
c){$(c).attr("pos_row",a+1)});var f=$(d.item[0]).prev(),c=1;0!=f.length&&(c=parseInt($(f[0]).attr("pos_row"))+1);MainLayout.objectTmp=new ObjectsTemporary;MainLayout.objectTmp.set({parent:e,beforeElm:f,pos_row:c})},stop:function(b,d){debugLog(" => DRAG-START: droptrue ");var e=d.item[0].parentNode,f=parseInt($(e).attr("pos_col")),c=$(e).attr("section_id"),g=MainLayout.elmTemplateList.val(),h=TemplateList.getSectionDetail(g,c),l=MainLayout.objectTmp.get(),k=l.parent,m=l.beforeElm,l=l.pos_row,p=parseInt($(k).attr("pos_col")),
n=!1,q=!1,s=!1;$(d.item[0]).attr("map_type")&&"grid"===$(d.item[0]).attr("map_type")&&(debugLog(" *** GRID CONTROL"),n=!0);$(e).attr("in_grid")&&"true"===$(e).attr("in_grid")&&(debugLog(" *** DRAG TO IN GRID"),q=!0);$(k).attr("in_grid")&&"true"===$(k).attr("in_grid")&&(debugLog(" *** DRAG TO OUT GRID"),s=!0);if(!0===n&&!0===q)return!1;if($(k).attr("section_id")==$(e).attr("section_id")){if(!0===q){var n=$(k).attr("section_id"),m=TemplateList.getSectionDetail(g,n),n=TemplateList.getControlDetail(g,
c,$(e).attr("control_id")),h=null,q=$(d.item[0]).prev(),r=0;0<q.length&&(r=parseInt($(q[0]).attr("pos_row")),h=q[0].id);if(!0===s)return p=Controller.findGridNameByControl(k),s=Controller.findGridNameByControl(e),null!=p&&null!=s&&p==s?(debugLog("*** Only grid"),Controller.moveControlInGrid(n.config.items,k,l,e,r,h)):(debugLog("*** Other grid"),n=$(k).attr("section_id"),m=TemplateList.getSectionDetail(g,n),s=TemplateList.getControlDetail(g,n,$(k).attr("control_id")),g=TemplateList.getControlDetail(g,
c,$(e).attr("control_id")),q=$(d.item[0]).prev(),r=0,0<q.length&&(r=parseInt($(q[0]).attr("pos_row"))),Controller.moveCellControlToGrid(s.config.items,k,l,g.config.items,e,r)),!0;debugLog("*** MOVE: control to grid");m.controls=Controller.moveControlToGrid(m.controls,k,p,l,n.config.items,e,r);return!0}if(!0===s)return debugLog("*** MOVE: control from cell grid to section"),n=$(k).attr("section_id"),n=TemplateList.getControlDetail(g,n,$(k).attr("control_id")),q=$(d.item[0]).prev(),r=0,0<q.length&&
(r=parseInt($(q[0]).attr("pos_row"))),h.controls=Controller.moveControlOutGrid(n.config.items,k,l,h.controls,e,f,r),!0;if($(k).attr("pos_col")==$(e).attr("pos_col")){q=$(d.item[0]).prev();r=1;if(0<q.length){if($(q).attr("pos_row")==$(m).attr("pos_row"))return;var r=parseInt($(m).attr("pos_row"))>parseInt($(q).attr("pos_row"))?parseInt($(q[0]).attr("pos_row"))+1:parseInt($(q[0]).attr("pos_row")),w=h.controls}else{if(0==m.length)return;w=h.controls}h.controls=Controller.changePosControlInControlsSamePosCol(w,
e,f,l,r)}else return q=$(d.item[0]).prev(),r=0,0<q.length&&(r=parseInt($(q[0]).attr("pos_row"))),w=h.controls,h.controls=Controller.changePosControlInControlsNotSamePosCol(w,k,p,l,e,f,r),!0}else{if("sortable_trash"==e.id){r=!0;"false"==d.item.attr("move_trash")&&"sortable_trash"==d.item[0].parentNode.id&&(r=!1,setTimeout(function(){Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_COMP_DROP_DRAG_ERR"),buttons:Ext.Msg.OK})},50));"sortable_trash"==d.item[0].parentNode.id&&(d.item.unbind("mouseover"),
d.item.unbind("mouseout"),0<d.item.find("img.img_edit_ctr").length&&d.item.find("img.img_edit_ctr").hide());if(!1==r)a(d.item);else if("sortable_trash"==d.item[0].parentNode.id){m=$(d.item[0]).attr("section_id");g=MainLayout.elmTemplateList.val();c=TemplateList.getTemplateDetail(g).name;m=TemplateList.getSectionDetail(g,m);w=m.controls;w.keySort(Controller.getObjectSortFromPosCol());if(!0===s){var n=$(k).attr("section_id"),m=TemplateList.getSectionDetail(g,n),n=TemplateList.getControlDetail(g,n,$(k).attr("control_id")),
p=n.config.items,s=$(k).attr("cell_key"),s=p.getCellFromKey(s),u=s.getControls();u.keySort(Controller.getObjectSortFromPosCol());p=TemplateList.getArrayControlFromColumn(u,-1);$.each(p,function(){u.splice(u.indexOfObject(this),1)});l=p.splice(l-1,1)[0];h=[];for(f=0;f<p.length;f++)n=p[f],n.pos_row=f+1,h.push(n);$.each(h,function(){$(e).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});u=u.concat(p);s.setControls(u)}else{p=TemplateList.getArrayControlFromColumn(w,p);$.each(p,
function(){w.splice(w.indexOfObject(this),1)});l=p.splice(l-1,1)[0];h=[];for(f=0;f<p.length;f++)n=p[f],n.pos_row=f+1,h.push(n);$.each(h,function(){$(k).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});m.controls=m.controls.concat(p)}TrashTemplate.pushControlToTrash(g,c,l)}return r}if(!0===q)return!0===s?(debugLog("*** MOVE CASE 1: control from cell grid to other grid"),n=$(k).attr("section_id"),m=TemplateList.getSectionDetail(g,n),s=TemplateList.getControlDetail(g,n,
$(k).attr("control_id")),g=TemplateList.getControlDetail(g,c,$(e).attr("control_id")),q=$(d.item[0]).prev(),r=0,0<q.length&&(r=parseInt($(q[0]).attr("pos_row"))),Controller.moveCellControlToGrid(s.config.items,k,l,g.config.items,e,r)):(debugLog("*** MOVE CASE 2: control grid to other grid"),n=$(k).attr("section_id"),m=TemplateList.getSectionDetail(g,n),s=TemplateList.getControlDetail(g,n,$(k).attr("control_id")),g=TemplateList.getControlDetail(g,c,$(e).attr("control_id")),q=$(d.item[0]).prev(),r=
0,0<q.length&&(r=parseInt($(q[0]).attr("pos_row"))),m.controls=Controller.moveControlToGrid(m.controls,k,p,l,g.config.items,e,r)),!0;if(!0===s)return n=$(k).attr("section_id"),m=TemplateList.getSectionDetail(g,n),n=TemplateList.getControlDetail(g,n,$(k).attr("control_id")),debugLog("*** MOVE: control from cell grid to other section"),h.controls=Controller.moveControlOutGrid(n.config.items,k,l,h.controls,e,f,r),!0;n=$(k).attr("section_id");m=TemplateList.getSectionDetail(g,n);q=$(d.item[0]).prev();
r=0;0<q.length&&(r=parseInt($(q[0]).attr("pos_row")));g=Controller.moveControlToOrtherSection(m.controls,k,p,l,h.controls,e,f,r);m.controls=g.controls_old;h.controls=g.controls_new}debugLog(" => DRAG-END: droptrue ")}}).disableSelection();$("#sortable_trash").sortable({connectWith:".droptrue",placeholder:"dragging_highlight",scroll:!0,revert:!1,forcePlaceholderSize:!0,tolerance:"pointer",cursorAt:{top:15,left:10},stop:function(b,d){debugLog(" => DRAG-START: sortable_trash");var e=MainLayout.elmTemplateList.val(),
f=$(d.item[0].parentNode).attr("section_id"),c=d.item[0].parentNode,g=parseInt($(d.item[0].parentNode).attr("pos_col")),h=TemplateList.getSectionDetail(e,f),l=h.controls;if(h){var k=!1;$(c).attr("in_grid")&&"true"===$(c).attr("in_grid")&&(debugLog(" *** DRAG TO IN GRID"),k=!0);var m=TrashTemplate.popControlInTrash(e,d.item[0].id);"grid"==m.map_type_control?(m.config.items=GridUtil.createObjToGridClass(m.config.items),$(c).find('div[id="'+m.control_id+'"]').find(".item_jig").each(function(){$(this).parent().attr("in_grid",
"true");a($(this))})):a(d.item);if(m){var p=$(d.item[0]).prev(),n=0;0<p.length&&(n=parseInt($(p[0]).attr("pos_row")));if(k){debugLog("    --\x3e drag control to cell grid");m.pos_col=-1;var h=TemplateList.getControlDetail(e,f,$(c).attr("control_id")).config.items,e=$(c).attr("cell_key"),h=h.getCellFromKey(e),q=h.getControls();q.keySort(Controller.getObjectSortFromPosCol());e=TemplateList.getArrayControlFromColumn(q,-1);$.each(e,function(){q.splice(q.indexOfObject(this),1)});e.splice(n,0,m);m=[];for(n=
0;n<e.length;n++)f=e[n],f.pos_row=n+1,m.push(f);$.each(m,function(){$(c).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString());$(c).find('div[id="'+this.control_id+'"]').attr("section_id",$(c).attr("section_id"))});q=q.concat(e);h.setControls(q);return!0}m.pos_col=g;l.keySort(Controller.getObjectSortFromPosCol());e=TemplateList.getArrayControlFromColumn(l,g);$.each(e,function(){l.splice(l.indexOfObject(this),1)});e.splice(n,0,m);m=[];for(n=0;n<e.length;n++)f=e[n],f.pos_row=
n+1,m.push(f);$.each(m,function(){$(c).find('div[id="'+this.control_id+'"]').attr("pos_row",this.pos_row.toString())});l=l.concat(e);h.controls=l}}debugLog(" => DRAG-END: sortable_trash")}}).disableSelection();$.each($(".sortableCtr"),function(){$.each($(this).find(".item_jig"),function(){$(this).attr("map_type")&&"grid"===$(this).attr("map_type")||a($(this))})})},createSection:function(a){a.column_cof="undefined"==typeof a.column_cof?1:parseInt(a.column_cof);a.collapsible="undefined"==typeof a.collapsible?
!1:"true"==a.collapsible.toString()?!0:!1;"undefined"==typeof a.sec_class&&(a.sec_class="");"undefined"==typeof a.sec_attr_name&&(a.sec_attr_name="");"undefined"==typeof a.sec_attrs&&(a.sec_attrs="");a.show_header="undefined"==typeof a.show_header?!1:"true"==a.show_header.toString()?!0:!1;a.show_inner_header="undefined"==typeof a.show_inner_header?!1:"true"==a.show_inner_header.toString()?!0:!1;"undefined"==typeof a.setting_inner_header&&(a.setting_inner_header=null);"undefined"==typeof a.section_id&&
(a.section_id=MainLayout.createNewSectionId());"undefined"==typeof a.secname&&(a.secname="");"undefined"==typeof a.controls&&(a.controls=[]);MainLayout.elmMainMatrix.append(MainLayout.createHtmlSection(a));var b=MainLayout.elmTemplateList.val();!0!=TemplateList.findSectionIdInTemplate(b,a.section_id)&&TemplateList.getTemplateDetail(b).sections.push(a);MainLayout.updateCfg()},createHtmlHeaderSection:function(a,b){"undefined"==typeof b&&(b=!1);var d;d='<div class="infoHdrBlk x-panel-header x-unselectable"><table cellpadding="5" cellspacing="0" width="100%">';
d+="<tbody>";d+='<tr><td><b class="secname">'+a.secname+"</b></td>";d+='<td class="alignright pR5" style="width: 120px;">';!0!=b?(d+='<img section_id="'+a.section_id+'" class="infoHdrEditIc pointer" onclick="MainLayout.getSecDetails(this)" src="'+BASE_URL+'/images/icons/spacer.gif" alt="'+MyLang.getMsg("BTN_EDIT")+'" title="'+MyLang.getMsg("BTN_EDIT")+'">',d+="&nbsp;",d+='<img section_id="'+a.section_id+'" class="infoHdrCopyIc pointer" onclick="MainLayout.copySecDetails(this)" src="'+BASE_URL+'/images/icons/spacer.gif" alt="'+
MyLang.getMsg("BTN_MULTI_COPY")+'" title="'+MyLang.getMsg("BTN_MULTI_COPY")+'">',d+="&nbsp;",d+='<img section_id="'+a.section_id+'" class="infoHdrDelIc pointer" onclick="MainLayout.deleteSection(this)" src="'+BASE_URL+'/images/icons/spacer.gif" alt="'+MyLang.getMsg("BTN_DELETE")+'" title="'+MyLang.getMsg("BTN_DELETE")+'">',d+="&nbsp;",d+='<span section_id="'+a.section_id+'" class="moveSection mgl5" onclick="MainLayout.moveUpSection(this)" alt="'+MyLang.getMsg("BTN_MOVE_UP")+'" title="'+MyLang.getMsg("BTN_MOVE_UP")+
'">\u25b2</span>',d+="&nbsp;",d+='<span section_id="'+a.section_id+'" class="moveSection" onclick="MainLayout.moveDownSection(this)" alt="'+MyLang.getMsg("BTN_MOVE_DOWN")+'" title="'+MyLang.getMsg("BTN_MOVE_DOWN")+'">\u25bc</span>',d+="&nbsp;",d+='<div section_id="'+a.section_id+'" class="toggle_section mgl5 x-tool toggle-" status="down">&nbsp;</div>'):d+='<div class="x-tool toggle_plus" status="up" id="toggle_'+a.section_id+'">&nbsp;</div>';d+="</td></tr></tbody></table>";return d+="</div>"},createHtmlSection:function(a){var b;
b=""+MainLayout.createHtmlHeaderSection(a);b+=MainLayout.createControlsInSection(a);var d=document.createElement("div");d.id=a.section_id;d.className=!0==a.show_header?"infoBlk mgt25":"infoBlk mgt5";d.setAttribute("column_cof",a.column_cof.toString());d.setAttribute("sec_class",a.sec_class.toString());d.setAttribute("sec_attr_name",a.sec_attr_name.toString());d.setAttribute("sec_attrs",a.sec_attrs.toString());d.setAttribute("collapsible",a.collapsible.toString());d.setAttribute("show_header",a.show_header.toString());
d.setAttribute("show_inner_header",a.show_inner_header.toString());"undefined"!=typeof a.setting_inner_header&&d.setAttribute("setting_inner_header",JSON.stringify(a.setting_inner_header));d.innerHTML=b;return d},hasSelectedTemplate:function(){return 0==TemplateList.data.length||""==MainLayout.elmTemplateList.val()?(Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_SELECT_TEMPLATE"),buttons:Ext.Msg.OK}),!1):!0},copySecDetails:function(a){if(!1!=MainLayout.hasSelectedTemplate()&&a){var b=
MainLayout.elmTemplateList.val(),d=$(a).attr("section_id");a=TemplateList.getTemplateDetail(b);b=TemplateList.getSectionDetail(b,d);b=clone(b);b.section_id=MainLayout.createNewSectionId();b.secname+=MyLang.getMsg("MSG_COMP_COPY");Controller.asyncControls(b.controls,b.section_id);a.sections.push(b);MainLayout.init()}},getSecDetails:function(a){if(!1!=MainLayout.hasSelectedTemplate())if(a){var b=$("#"+$(a).attr("section_id"));a={section_id:$(a).attr("section_id"),secname:b.find("b.secname").text(),
column_cof:parseInt(b.attr("column_cof")),sec_class:b.attr("sec_class"),sec_attr_name:b.attr("sec_attr_name"),sec_attrs:b.attr("sec_attrs"),collapsible:"true"==b.attr("collapsible")?!0:!1,show_header:"true"==b.attr("show_header")?!0:!1,show_inner_header:"true"==b.attr("show_inner_header")?!0:!1,setting_inner_header:JSON.parse(b.attr("setting_inner_header")),mod:"edit"};PopupSecDetails.show(a,function(a){MainLayout.updateSection(b,parseInt(b.attr("column_cof")),a)})}else a={secname:"",column_cof:1,
show_header:!1,sec_class:"",sec_attr_name:"",sec_attrs:"",collapsible:!1,mod:"new"},PopupSecDetails.show(a,function(a){MainLayout.createSection({secname:a.secname,column_cof:a.column_cof,show_header:a.show_header,sec_class:a.sec_class,sec_attr_name:a.sec_attr_name,sec_attrs:a.sec_attrs,collapsible:a.collapsible,show_inner_header:a.show_inner_header,setting_inner_header:a.setting_inner_header})})},deleteSection:function(a){Ext.Msg.show({icon:Ext.MessageBox.QUESTION,msg:MyLang.getMsg("MSG_DELETE_SECTION"),
buttons:Ext.Msg.OKCANCEL,fn:function(b){if("ok"==b){b=$(a).attr("section_id");$("#"+b).remove();for(var d=TemplateList.getTemplateDetail(MainLayout.elmTemplateList.val()).sections,e=0;e<d.length;e++)d[e].section_id==b&&d.splice(e,1)}}})},updateSection:function(a,b,d){var e=TemplateList.getSectionDetail(MainLayout.elmTemplateList.val(),d.section_id);e.secname=d.secname;e.column_cof=d.column_cof;e.sec_class=d.sec_class;e.sec_attr_name=d.sec_attr_name;e.sec_attrs=d.sec_attrs;e.collapsible=d.collapsible;
e.show_header=d.show_header;e.show_inner_header=d.show_inner_header;e.setting_inner_header=d.setting_inner_header;var f=parseInt(d.column_cof);if(b!=f){b=e.controls;b.keySort(Controller.getObjectSortFromPosCol());for(var c=0,g={},h=1;h<f+1;h++)g[h]=[];for(;c<b.length;)for(h=1;h<f+1&&!(g[h].push("1 row"),b[c].pos_col=h,b[c].pos_row=g[h].length,c++,c>=b.length);h++);}!0==d.show_header?a.attr("class","infoBlk mgt25"):a.attr("class","infoBlk mgt5");a.find("b.secname").text(d.secname);a.attr("column_cof",
d.column_cof.toString());a.attr("sec_class",d.sec_class.toString());a.attr("sec_attr_name",d.sec_attr_name.toString());a.attr("sec_attrs",d.sec_attrs.toString());a.attr("collapsible",d.collapsible.toString());a.attr("show_header",d.show_header.toString());a.attr("show_inner_header",d.show_inner_header.toString());a.attr("setting_inner_header",JSON.stringify(d.setting_inner_header));MainLayout.updateControlInSection(e)},createHtmlDivControl:function(a,b){var d="",e=Controller.isMarkMandatory(b),f=
Controller.create(b,!1,e),c=Controller.getLabelName(f),g=Controller.getValueFromAttrName(f,"class");-1<g.search("mandatory")?$(f).attr("move_trash","false"):$(f).attr("move_trash","true");if("grid"===b.map_type_control){d=f.hasAttribute("move_trash")?d+('<div id="'+b.control_id+'" map_type="'+b.map_type_control+'" section_id="'+a+'" class="item_jig" pos_row="'+b.pos_row+'" move_trash="'+f.getAttribute("move_trash")+'">'):d+('<div id="'+b.control_id+'" map_type="'+b.map_type_control+'" section_id="'+
a+'" class="item_jig" pos_row="'+b.pos_row+'">');d+='<table gridEditor="true" style="width:100%" name="'+b.config.attributes.name+'" class="'+b.config.attributes.class+'">';e=b.config.items;if(!0===isEmpty(e))for(b.config.items=new v({maxRow:b.config.attributes.max_row,maxCol:b.config.attributes.max_col}),f=0;f<b.config.attributes.max_row;f++){d+="<tr>";for(c=0;c<b.config.attributes.max_col;c++)d+='<td class="cell-sortable" cell_key="cell_'+f+"-"+c+'">',d+='<div class="droptrue" in_grid="true" control_id="'+
b.control_id+'" section_id="'+a+'" cell_key="cell_'+f+"-"+c+'">',d+="",d+="</div>",d+="</td>";d+="</tr>"}else for(e instanceof v||(b.config.items=e=GridUtil.createObjToGridClass(e)),f=0;f<e.maxRow;f++){d+="<tr>";for(c=0;c<e.maxCol;c++)if(g=e.getCell(f,c))d+='<td class="cell-sortable"',-1<g.rowspan&&(d+=' rowspan="'+g.rowspan+'" '),-1<g.colspan&&(d+=' colspan="'+g.colspan+'" '),d+=' cell_key="cell_'+f+"-"+c+'">',d+='<div class="droptrue" in_grid="true" control_id="'+b.control_id+'" section_id="'+a+
'" cell_key="cell_'+f+"-"+c+'">',d+=GridUtil.createControlInCellGrid(g,a),d+="",d+="</div>",d+="</td>";d+="</tr>"}return d+="</table></div>"}c=escapeHtml(c);15<c.length&&(c=c.substring(0,15)+"...");d=f.hasAttribute("move_trash")?d+('<div title="'+c+'" id="'+b.control_id+'" map_type="'+b.map_type_control+'" section_id="'+a+'" class="item_jig" pos_row="'+b.pos_row+'" move_trash="'+f.getAttribute("move_trash")+'">'):d+('<div title="'+c+' id="'+b.control_id+'" map_type="'+b.map_type_control+'" section_id="'+
a+'" class="item_jig" pos_row="'+b.pos_row+'">');d+='<table style="width:100%"><tr><td style="width: 10px;min-width: 10px;">';d+='<img class="dotLine floatL" src="'+BASE_URL+'/images/icons/spacer.gif" alt="">';d+='</td><td width="16">';d+='<img class="img_ctr_in_sec" width="20" height="20" src="'+Controller.MapType[b.map_type_control].iconUrl+'" />';d+="</td><td>";d+='<span class="'+g+'" style="white-space: pre;">'+c+"</span>";d+='</td><td width="5px">';if(-1<g.search("mandatory")||e)d+='<span class="validate_require">*</span>';
d+='</td><td class="pos_import_edit"></td></tr></table>';return d+="</div>"},createControlsInSection:function(a){var b;b='<table class="tblCtrls">';if(a.show_inner_header&&"undefined"!=typeof a.setting_inner_header&&a.setting_inner_header&&("undefined"==typeof a.setting_inner_header.v_cfg&&(a.setting_inner_header.v_cfg={},a.setting_inner_header.v_cfg.inner_header_show_title1=void 0!=a.show_inner_header?a.show_inner_header:!1,a.setting_inner_header.v_cfg.inner_header_show_title2=!1,a.setting_inner_header.v_cfg.title=
"",a.setting_inner_header.v_cfg.width="",a.setting_inner_header.v_cfg.align=""),a.setting_inner_header.v_cfg.inner_header_show_title1)){b+="<tr>";if(a.setting_inner_header.v_cfg.inner_header_show_title2){var d=a.setting_inner_header.v_cfg;b+='<td style="vertical-align: middle;width:'+d.width+";text-align:"+d.align+'">';b+="</td>"}for(d=1;d<a.column_cof+1;d++){var e=a.setting_inner_header[d];b+='<td class="inner_header" style="vertical-align: middle;width:'+e.width+";text-align:"+e.align+'">';b+="<span>"+
e.title+"</span>";b+="</td>"}b+="</tr>"}if("undefined"==typeof a.controls){b+="<tr>";a.show_inner_header&&"undefined"!=typeof a.setting_inner_header&&a.setting_inner_header&&("undefined"==typeof a.setting_inner_header.v_cfg&&(a.setting_inner_header.v_cfg={},a.setting_inner_header.v_cfg.inner_header_show_title1=void 0!=a.show_inner_header?a.show_inner_header:!1,a.setting_inner_header.v_cfg.inner_header_show_title2=!1,a.setting_inner_header.v_cfg.title="",a.setting_inner_header.v_cfg.width="",a.setting_inner_header.v_cfg.align=
""),a.setting_inner_header.v_cfg.inner_header_show_title2&&(d=a.setting_inner_header.v_cfg,b+='<td class="inner_header" style="vertical-align: middle;width:'+d.width+";text-align:"+d.align+'">',b+="<span>"+d.title+"</span>",b+="</td>"));for(d=0;d<a.column_cof;d++){var f="50%";"undefined"!=typeof a.setting_inner_header&&a.setting_inner_header&&(e=a.setting_inner_header[d+1],f=e.width);b+='<td style="vertical-align: top;width:'+f+'">';b+='<div style="width: 100%;" class="sortableCtr droptrue" section_id="'+
a.section_id+'" pos_col="1">';b+="</div>";b+="</td>"}return b+="</tr></table>"}a.controls.keySort(Controller.getObjectSortFromPosCol());b+="<tr>";a.show_inner_header&&"undefined"!=typeof a.setting_inner_header&&a.setting_inner_header&&("undefined"==typeof a.setting_inner_header.v_cfg&&(a.setting_inner_header.v_cfg={},a.setting_inner_header.v_cfg.inner_header_show_title1=void 0!=a.show_inner_header?a.show_inner_header:!1,a.setting_inner_header.v_cfg.inner_header_show_title2=!1,a.setting_inner_header.v_cfg.title=
"",a.setting_inner_header.v_cfg.width="",a.setting_inner_header.v_cfg.align=""),a.setting_inner_header.v_cfg.inner_header_show_title2&&(d=a.setting_inner_header.v_cfg,b+='<td class="inner_header" style="vertical-align: middle;width:'+d.width+";text-align:"+d.align+'">',b+="<span>"+d.title+"</span>",b+="</td>"));for(var c={},g=1;g<a.column_cof+1;g++){f="50%";"undefined"!=typeof a.setting_inner_header&&a.setting_inner_header&&(e=a.setting_inner_header[g],f=e.width);e="";e+='<td style="vertical-align: top;width:'+
f+'">';e=2>=g?e+('<div style="width: 100%;min-width: 200px;" class="sortableCtr droptrue" section_id="'+a.section_id+'" pos_col="'+g+'">'):e+('<div style="width: 100%;min-width: '+f+'" class="sortableCtr droptrue" section_id="'+a.section_id+'" pos_col="'+g+'">');f=TemplateList.getArrayControlFromColumn(a.controls,g);for(d=0;d<f.length;d++)e+=MainLayout.createHtmlDivControl(a.section_id,f[d]);e+="</div></td>";c["html_"+g]=e}for(var h in c)b+=c[h];b+="</tr>";return b+="</table>"},updateControlInSection:function(a){debugLog("=> function updateControlInSection()");
var b=$("#"+a.section_id);b.find("table.tblCtrls").remove();a=""+MainLayout.createControlsInSection(a);b.append(a);MainLayout.processInitEvents()},createTemplateFromHtml:function(a){function b(a,c){for(var b=0;b<c.length;b++)if(a==c[b])return!0;return!1}function d(a,c,b,d,e,f){var g={};g.control_id=MainLayout.createNewControlId();"undefined"!=typeof e&&(g.pos_row=e);g.pos_col=1;g.config={};g.config.attributes={};g.config.attributes.name=b;g.map_type_control=c;g.tag=d;var h="";$.each(a.attributes,
function(){"class"!=this.name&&"name"!=this.name&&"type"!=this.name&&"style"!=this.name&&"value"!=this.name&&("undefined"!=typeof f&&this.name in f||(h=""!==this.value?h+(this.name+'="'+this.value+'" '):h+(this.name+" ")));g.config.attributes[this.name]=this.value});g.config.attributes.new_attrs=escapeAndEncodeHtml(h.trim());a.hasAttribute("style")&&(g.config.attributes.style=$(a).attr("style").toString());a.hasAttribute("lblname")?g.config.attributes.lblname=$(a).attr("lblname"):g.config.attributes.lblname=
b;g.config.attributes.lblname.showlblname=!0;a.hasAttribute("class")?g.config.attributes.class=$(a).attr("class"):g.config.attributes.class="";"select"==d&&(g.config.items=[],$(a).find("option").each(function(){g.config.items.push({value:this.value,text:this.text})}));return g}var e=$(document.createElement("div"));e.html(a.html_template);var f={};f.id=a.template_id;f.name=a.template_name;var c=[],g=[],h=[],l=1;$.each(e.find("*"),function(){if(this.tagName&&("INPUT"==this.tagName||"TEXTAREA"==this.tagName||
"SELECT"==this.tagName)){var a="";this.name&&(a=this.name);var f,k="";if("INPUT"==this.tagName){f=this.type;k=this.tagName.toLowerCase();if("radio"==f&&""!=a.trim()){var m;m=1<e.find('input:radio[name="'+a+'"]').length?!0:!1;if(m){!0!=b(a,g)&&g.push(a);return}}if("checkbox"==f&&""!=a.trim()&&(m=1<e.find('input:checkbox[name="'+a+'"]').length?!0:!1,m)){!0!=b(a,h)&&h.push(a);return}}else f=this.tagName.toLowerCase(),k=this.tagName.toLowerCase();if(a=d(this,f,a,k,l)){if("undefined"==typeof a.config.attributes.style||
""==a.config.attributes.style)a.config.attributes.style="width:100%";c.push(a);l++}}});for(a=0;a<g.length;a++){var k="radiogroup",m=clone(Controller.MapType[k]),p=g[a],n=e.find('input:radio[name="'+p+'"]'),q=[];$.each(n,function(){q.push(d(this,"radio",p,"input",void 0,["value"]))});m.control_id=MainLayout.createNewControlId();m.map_type_control=k;m.config.attributes.lblname=p;m.config.attributes.name=p;m.pos_row=l;m.pos_col=1;m.config.items=clone(q);c.push(m);l++}for(a=0;a<h.length;a++)k="checkboxgroup",
m=clone(Controller.MapType[k]),p=h[a],n=e.find('input:checkbox[name="'+p+'"]'),q=[],$.each(n,function(){q.push(d(this,"checkbox",p,"input",void 0,["value"]))}),m.control_id=MainLayout.createNewControlId(),m.map_type_control=k,m.config.attributes.lblname=p,m.config.attributes.name=p,m.pos_row=l,m.pos_col=1,m.config.items=clone(q),c.push(m),l++;f.sections=[{section_id:MainLayout.createNewSectionId(),secname:f.name,column_cof:1,controls:c}];TemplateList.data.push(f)},cleanBuilder:function(){TemplateList.data=
[];TrashTemplate.data=[];RenderLayout.hasInit=!1},createNewTemplate:function(a,b,d,e,f){MainLayout.cleanBuilder();var c={};c.template_id=a;c.template_name=b;c.html_template=d;a=$(document.createElement("div"));a.html(d);a=a.find('script[name="sateraito_form_script"]');d=document.createElement("script");d.type="text/javascript";d.setAttribute("name","sateraito_form_script");d.textContent=0<a.length?$(a[0]).text():MyLang.getMsg("MSG_INPUT_JAVASCRIPT_SECTION_1");MainLayout.sateraito_script=d;if(e&&""!=
e.trim()){c=null;try{c=JSON.parse(Base64.decode(e))}catch(g){e=Base64.decode(e).replace(/&quot;/g,"");if(c=e.match(/new_attrs\\\":\\\"([^,])*\\\",/g))for(a=0;a<c.length;a++)b=c[a].substring(14,c[a].length-3),""!=b&&(e=e.replace(b,escapeAndEncodeHtml(b)));c=JSON.parse(e)}c&&c.template_list_json_string&&TemplateList.data.push(JSON.parse(c.template_list_json_string));c&&c.trash_template_list_json_string&&TrashTemplate.data.push(JSON.parse(c.trash_template_list_json_string));c&&c.sateraito_script_content&&
(d.textContent=c.sateraito_script_content,MainLayout.sateraito_script=d)}else MainLayout.createTemplateFromHtml(c);"function"==typeof f&&f()}};RenderLayout={elmRenderResult:null,hasInit:!1,specialAttrs:[],addSpecialAttrs:function(a){-1===$.inArray(a,this.specialAttrs)&&this.specialAttrs.push(a)},fixRenderSpecialAttrs:function(){$.each(RenderLayout.specialAttrs,function(){RefactorCode.result=RefactorCode.result.replace(new RegExp(this.toString()+'=""',"g"),this.toString())})},init:function(){if(!Ext.getCmp("form_panel_renderResult")){var a;
a='<div id="renderResult" class="pwie"><div id="render_date">';a+="</div>";a+="</div>";new Ext.form.FormPanel({renderTo:"form_panel_renderResult_render",bodyStyle:"border:none;background-color:white;",layout:"fit",id:"form_panel_renderResult",formId:"form_renderResult",autoScroll:!0,html:a,region:"center"})}RenderLayout.afterInit()},afterInit:function(){RenderLayout.elmRenderResult=$("#renderResult");RenderLayout.renderNow();RenderLayout.hasInit=!0},renderNow:function(){RenderLayout.elmRenderResult.html("");
var a=MainLayout.elmTemplateList.val();(a=TemplateList.getTemplateDetail(a))&&RenderLayout.create(a,RenderLayout.elmRenderResult);RenderLayout.specialAttrs=[]},create:function(a,b,d){"undefined"==typeof d&&(d=!0);b.html("");b.append('<div id="template_body_renderResult"></div>');$.each(a.sections,function(){b.find("div#template_body_renderResult").append(RenderLayout.createSecContent(this))});$("#template_body_html_builder_result").html(b.find("div#template_body_renderResult").html());d&&(b.find("div#template_body_renderResult").find("div.section_area").each(function(){var a=
$(this).html(),b=$(this).attr("section_title");"undefined"==typeof b&&(b="");var c;c='<div class="section_area_title">'+('<img class="section_arrow_img" src="'+SATERAITO_MY_SITE_URL+'/images/arrowDown.gif" />');c+=b+"</div>";c+='<div class="section_show_hide_area" >'+a+"</div>";$(this).html(c)}),b.find("div#template_body_renderResult").find("div.section_area").each(function(){var a=$(this),b=!0;"none"==$(a).attr("display")&&(b=!1);var c=$(a).find("img.section_arrow_img"),a=$(a).find("div.section_show_hide_area");
$(a).css("display");b?($(a).show(),$(c).attr("src",SATERAITO_MY_SITE_URL+"/images/arrowDown.gif")):($(a).hide(),$(c).attr("src",SATERAITO_MY_SITE_URL+"/images/arrowRight.gif"))}));b.append(MainLayout.sateraito_script.outerHTML);!0==d&&(DocDetailWindow.init("renderResult"),"undefined"!==typeof OidMiniMessage&&OidMiniMessage.clearMessage(),"undefined"!==typeof _OidMiniMessage&&_OidMiniMessage.clearMessage())},createHtmlControlInCellGrid:function(a){var b=this;a=a.getControls();var d="";$.each(a,function(){d+=
b.createHtmlFromControl(this)});return d},createHtmlFromControlGrid:function(a){var b=a.config.items,d="";a.config.attributes.new_attrs&&"undefined"!=typeof a.config.attributes.new_attrs&&(d=a.config.attributes.new_attrs);a=""+('<table style="'+a.config.attributes.style+'" '+d+' name="'+a.config.attributes.name+'" class="'+a.config.attributes.class+'">');for(d=0;d<b.maxRow;d++){a+="<tr>";for(var e=0;e<b.maxCol;e++){var f=b.getCell(d,e);f&&(a+="<td",f.style&&""!==f.style&&"undefined"!=f.style&&void 0!=
f.style&&-1!=f.style&&(a+=' style="'+f.style+'" '),-1<f.rowspan&&(a+=' rowspan="'+f.rowspan+'" '),-1<f.colspan&&(a+=' colspan="'+f.colspan+'" '),a+=" >",a+=this.createHtmlControlInCellGrid(f),a+="</td>")}a+="</tr>"}return a+"</table>"},createHtmlFromControl:function(a){var b="",d=!1;"canvas"==a.map_type_control&&(d=!0);d||(b+='<table class="detail" cellspacing="0" cellpadding="0"><tr>');var e=Controller.isMarkMandatory(a),f=Controller.create(a,!0,e),c=Controller.getLabelName(f);e&&(c+='&nbsp;<font color="red">*</font>');
e=Controller.getValueFromAttrName(f,"widthlbl");""==e.trim()&&(e="100px");var g=Controller.getShowLabelName(f),f=Controller.clean(f);"radiogroup"==a.map_type_control&&$(f.firstChild).removeAttr("name");"checkboxgroup"==a.map_type_control&&$(f.firstChild).removeAttr("name");d?b+=f.outerHTML:(g?(b+='<td width="'+e+'" class="detail_name">',b+=c,b+="</td>",b+='<td width="0%" class="detail_value">'):b+='<td width="100%" class="">',b="label"!=a.map_type_control?b+f.innerHTML:b+f.outerHTML,b+="</td>",b+=
"</tr>",b+="</table>");return b},createSecContent:function(a){var b="";"undefined"==typeof a.collapsible&&(a.collapsible=!1);var d=!1;if(!0==a.show_header||"true"==a.show_header||"True"==a.show_header)d=!0;a.collapsible&&d?(b+='<div class="section_area',b=a.sec_class?b+(" "+a.sec_class+'"'):b+'"',a.sec_attr_name&&(b+=' name="'+a.sec_attr_name+'"'),a.sec_attrs&&(b+=" "+unescapeAndDecodeHtml(a.sec_attrs)+" "),b+=' section_title="'+a.secname+'"',b+=">"):!0==a.show_header||"true"==a.show_header||"True"==
a.show_header?(b+='<div class="',b=a.sec_class?b+(" "+a.sec_class+'"'):b+'"',a.sec_attr_name&&(b+=' name="'+a.sec_attr_name+'"'),a.sec_attrs&&(b+=" "+unescapeAndDecodeHtml(a.sec_attrs)+" "),b=b+">"+('<div class="main_content_title2">'+a.secname+"</div>")):(b+='<div class="',b=a.sec_class?b+(" "+a.sec_class+'"'):b+'"',a.sec_attr_name&&(b+=' name="'+a.sec_attr_name+'"'),a.sec_attrs&&(b+=" "+unescapeAndDecodeHtml(a.sec_attrs)+" "),b+=">");b+='<table class="detail">';if("undefined"!=typeof a.controls){a.controls.keySort({pos_col:"asc",
pos_row:"asc"});for(var d=0,e=1;e<a.column_cof+1;e++){var f=TemplateList.getArrayControlFromColumn(a.controls,e);d<=f.length&&(d=f.length)}var c={};if("undefined"!=typeof a.show_inner_header&&a.show_inner_header&&a.setting_inner_header&&"undefined"!=typeof a.setting_inner_header.v_cfg&&a.setting_inner_header.v_cfg.inner_header_show_title1){var g="<tr>";a.setting_inner_header.v_cfg.inner_header_show_title2&&(e=a.setting_inner_header.v_cfg,g+='<td  style="vertical-align: middle;width:'+e.width+";text-align:"+
e.align+'">',g+="</td>");for(e=1;e<a.column_cof+1;e++){if("undefined"!=typeof a.show_inner_header&&a.show_inner_header)var h=a.setting_inner_header[e],g=g+('<td class="inner_header" style="vertical-align: middle;width: '+h.width+";text-align:"+h.align+'">'),g=g+("<span>"+h.title+"</span>"),g=g+"</td>";c[e]=void 0==a.setting_inner_header[e]?"0%":a.setting_inner_header[e].width;""==c[e]&&(c[e]="0%")}g+="</tr>";"<tr></tr>"!=g&&(b+=g)}0==d&&"undefined"!=typeof a.show_inner_header&&a.show_inner_header&&
a.setting_inner_header&&"undefined"!=typeof a.setting_inner_header.v_cfg&&a.setting_inner_header.v_cfg.inner_header_show_title2&&(e=a.setting_inner_header.v_cfg,b+="<tr>",b+='<td rowspan="'+d+'" class="detail_name" style="vertical-align: middle;width:'+e.width+";text-align:"+e.align+'">',b+="<span>"+e.title+"</span>",b+="</td>",b+="<tr>");for(g=0;g<d;g++){b+="<tr>";"undefined"!=typeof a.show_inner_header&&a.show_inner_header&&a.setting_inner_header&&"undefined"!=typeof a.setting_inner_header.v_cfg&&
a.setting_inner_header.v_cfg.inner_header_show_title2&&0==g&&(e=a.setting_inner_header.v_cfg,b+='<td rowspan="'+d+'" class="detail_name" style="vertical-align: middle;width:'+e.width+";text-align:"+e.align+'">',b+="<span>"+e.title+"</span>",b+="</td>");for(e=1;e<a.column_cof+1;e++){f=TemplateList.getArrayControlFromColumn(a.controls,e);h=100/a.column_cof+"%";"undefined"!=typeof c[e]&&(h=c[e]);a.show_inner_header&&"undefined"!=typeof a.show_inner_header&&(h=a.setting_inner_header[e],h=h.width);if("undefined"==
typeof f[g])b+='<td width="'+h+'">';else{var l=!1;"canvas"==f[g].map_type_control&&(l=!0);l||(b+='<td width="'+h+'">');b="grid"===f[g].map_type_control?b+RenderLayout.createHtmlFromControlGrid(f[g]):b+RenderLayout.createHtmlFromControl(f[g])}b+="</td>"}b+="</tr>"}}b+="</table>";return b+="</div>"}};ViewSource={elmViewSource:null,init:function(a){ViewSource.elmViewSource=$("#viewSource");var b=TemplateList.getTemplateDetail(MainLayout.elmTemplateList.val());if(b){var d=document.createElement("div");
RenderLayout.create(b,$(d),!1);ViewSource.viewSource()}"function"==typeof a&&a()},viewSource:function(){ViewSource.elmViewSource.html("");try{RefactorCode.init({parent:$("#template_body_html_builder_result")},!1),RenderLayout.fixRenderSpecialAttrs(),ViewSource.elmViewSource.text(RefactorCode.result),ViewSource.elmViewSource.attr("class","brush: html, js, jscript, javascript, css; toolbar: false;"),SyntaxHighlighter.highlight(void 0,ViewSource.elmViewSource[0])}catch(a){}},beforePostMessage:function(){var a=
MainLayout.elmTemplateList.val(),a=TemplateList.getTemplateDetail(a),b=document.createElement("div");a&&(RenderLayout.create(a,$(b),!1),ViewSource.postMessage())},postMessage:function(){Ext.Msg.show({icon:Ext.MessageBox.QUESTION,msg:MyLang.getMsg("MSG_SAVE_HTML_EDITOR"),buttons:Ext.Msg.OKCANCEL,fn:function(a){if("ok"==a){Loading.showMessage(MyLang.getMsg("UPDATING"));var b="";a="";b=MainLayout.elmTemplateList.val();RefactorCode.init({parent:$("#template_body_html_builder_result")},!1);RenderLayout.fixRenderSpecialAttrs();
a=RefactorCode.result;var d=TemplateList.getTemplateDetail(b),e="";d&&(e=JSON.stringify(d));b=TrashTemplate.getTemplateDetail(b);d="";b&&(d=JSON.stringify(b));var f={};f.template_body=escapeAndEncodeHtml(a);f.template_body_for_html_builder={template_list_json_string:e,trash_template_list_json_string:d,sateraito_script_content:MainLayout.sateraito_script.textContent};testJsonIsOk(f)?TemplateList.requestSaveBuilderJsonMemcache(JSON.stringify(f.template_body_for_html_builder),function(a){a?(top.postMessage(JSON.stringify(f),
"*"),window.close()):window.alert(MyLang.getMsg("MSG_SAVE_HTML_ERROR"));Loading.hide()}):(window.alert(MyLang.getMsg("MSG_SAVE_UNDEFINED_ERROR")),window.close(),Loading.hide())}}})}};PopupSecDetails={maxCol:20,elm:$("#secDetails"),callback:null,section:null,isEdit:!1,objectInnerHeaderTmp:{},show:function(a,b){PopupSecDetails.objectInnerHeaderTmp={};PopupSecDetails.section=a;PopupSecDetails.callback=b;a&&"edit"==a.mod&&(PopupSecDetails.isEdit=!0);var d="",e="";!0==PopupSecDetails.isEdit?(d=MyLang.getMsg("MSG_SECTION_EDIT"),
e=MyLang.getMsg("BTN_SAVE")):(d=MyLang.getMsg("BTN_SECTION_ADD_NEW"),e=MyLang.getMsg("BTN_ADD"));PopupSecDetails.id="section";var f=Ext.getCmp("dlg_"+PopupSecDetails.id);f||(f=[],f.push(new Ext.Button({id:"btnDlg_"+PopupSecDetails.id,text:e,handler:function(){PopupSecDetails.save()}})),f.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){PopupSecDetails.hide()}})),f=new Ext.Window({id:"dlg_"+PopupSecDetails.id,title:MyLang.getMsg("BTN_SECTION_ADD_NEW"),layout:"fit",width:600,
height:400,closeAction:"hide",plain:!0,modal:!0,items:new Ext.Panel({border:!1,autoScroll:!0,html:'<div id="'+PopupSecDetails.id+'"></div>'}),buttons:f,listeners:{afterRender:function(){PopupSecDetails.elm=$("#"+PopupSecDetails.id);PopupSecDetails.elm.html("");PopupSecDetails.elm.append(PopupSecDetails.create);PopupSecDetails.createSettingInnerHeader(PopupSecDetails.section.column_cof);PopupSecDetails.elm.find('input[name="categoryname"]').val(PopupSecDetails.section.secname);PopupSecDetails.elm.find('input[name="categoryname"]').focus();
PopupSecDetails.elm.find('select[name="column_cof"]').val(PopupSecDetails.section.column_cof);PopupSecDetails.elm.find('input[name="sec_class"]').val(PopupSecDetails.section.sec_class);PopupSecDetails.elm.find('input[name="sec_attr_name"]').val(PopupSecDetails.section.sec_attr_name);PopupSecDetails.elm.find(':input[name="sec_attrs"]').val(unescapeAndDecodeHtml(PopupSecDetails.section.sec_attrs));"undefined"==typeof PopupSecDetails.section.collapsible&&(PopupSecDetails.section.collapsible=!1);PopupSecDetails.elm.find('input[name="collapsible"]').prop("checked",
PopupSecDetails.section.collapsible);PopupSecDetails.elm.find('input[name="show_header"]').prop("checked",PopupSecDetails.section.show_header);PopupSecDetails.section.show_header&&PopupSecDetails.elm.find('input[name="collapsible"]').removeAttr("disabled");"undefined"==typeof PopupSecDetails.section.show_inner_header&&(PopupSecDetails.section.show_inner_header=!1);PopupSecDetails.elm.find('input[name="show_inner_header"]').prop("checked",PopupSecDetails.section.show_inner_header);if(PopupSecDetails.isEdit&&
"undefined"!=typeof PopupSecDetails.section.setting_inner_header&&PopupSecDetails.section.setting_inner_header){"undefined"==typeof PopupSecDetails.section.setting_inner_header.v_cfg&&(PopupSecDetails.section.setting_inner_header.v_cfg={},PopupSecDetails.section.setting_inner_header.v_cfg.inner_header_show_title1=!0,PopupSecDetails.section.setting_inner_header.v_cfg.inner_header_show_title2=!1,PopupSecDetails.section.setting_inner_header.v_cfg.title="",PopupSecDetails.section.setting_inner_header.v_cfg.width=
"",PopupSecDetails.section.setting_inner_header.v_cfg.align="");$("#setting_inner_header").html(PopupSecDetails.createHTMLSettingInnerHeader(PopupSecDetails.elm.find('select[name="column_cof"]').val()));PopupSecDetails.elm.find('input[name="inner_header_show_title1"]').prop("checked",PopupSecDetails.section.setting_inner_header.v_cfg.inner_header_show_title1);PopupSecDetails.elm.find('input[name="inner_header_show_title2"]').prop("checked",PopupSecDetails.section.setting_inner_header.v_cfg.inner_header_show_title2);
for(var a=1;a<PopupSecDetails.section.column_cof+1;a++)$("#setting_inner_header").find('input[name="inner_header_title_'+a+'"]').val(PopupSecDetails.section.setting_inner_header[a].title),$("#setting_inner_header").find('input[name="inner_header_width_'+a+'"]').val(PopupSecDetails.section.setting_inner_header[a].width),$("#setting_inner_header").find('select[name="inner_header_align_'+a+'"]').val(PopupSecDetails.section.setting_inner_header[a].align);a=PopupSecDetails.section.setting_inner_header.v_cfg;
$("#setting_inner_header").find('input[name="inner_header_title"]').val(a.title);$("#setting_inner_header").find('input[name="inner_header_width"]').val(a.width);$("#setting_inner_header").find('select[name="inner_header_align"]').val(a.align);for(var b=parseInt(PopupSecDetails.elm.find('select[name="column_cof"]').val()),a=1;a<b+1;a++)!0==PopupSecDetails.section.setting_inner_header.v_cfg.inner_header_show_title1?($("#setting_inner_header").find('input[name="inner_header_title_'+a+'"]').removeAttr("disabled"),
$("#setting_inner_header").find('select[name="inner_header_align_'+a+'"]').removeAttr("disabled")):($("#setting_inner_header").find('input[name="inner_header_title_'+a+'"]').attr("disabled","disabled"),$("#setting_inner_header").find('select[name="inner_header_align_'+a+'"]').attr("disabled","disabled"));!0==PopupSecDetails.section.setting_inner_header.v_cfg.inner_header_show_title2?($("#setting_inner_header").find('input[name="inner_header_title"]').removeAttr("disabled"),$("#setting_inner_header").find('select[name="inner_header_align"]').removeAttr("disabled")):
($("#setting_inner_header").find('input[name="inner_header_title"]').attr("disabled","disabled"),$("#setting_inner_header").find('select[name="inner_header_align"]').attr("disabled","disabled"));PopupSecDetails.elm.find('input[name="show_inner_header"]').is(":checked")?$("#setting_inner_header").fadeIn("slow"):$("#setting_inner_header").fadeOut("slow")}PopupSecDetails.setObjectInnerHeaderTmp();PopupSecDetails.elm.find('input[name="show_inner_header"]').change(function(){PopupSecDetails.setObjectInnerHeaderTmp();
PopupSecDetails.elm.find('input[name="show_inner_header"]').is(":checked")?($("#setting_inner_header").html(PopupSecDetails.createHTMLSettingInnerHeader(PopupSecDetails.elm.find('select[name="column_cof"]').val())),$("#setting_inner_header").fadeIn("slow")):($("#setting_inner_header").html(PopupSecDetails.createHTMLSettingInnerHeader(PopupSecDetails.elm.find('select[name="column_cof"]').val())),$("#setting_inner_header").fadeOut("slow"));PopupSecDetails.processLoadObjectInnerHeaderTmp()});PopupSecDetails.elm.find('select[name="column_cof"]').change(function(){PopupSecDetails.setObjectInnerHeaderTmp();
PopupSecDetails.createSettingInnerHeader(parseInt(PopupSecDetails.elm.find('select[name="column_cof"]').val()));PopupSecDetails.processLoadObjectInnerHeaderTmp()});PopupSecDetails.elm.find('input[name="show_header"]').change(function(){$(this).is(":checked")?PopupSecDetails.elm.find('input[name="collapsible"]').removeAttr("disabled"):PopupSecDetails.elm.find('input[name="collapsible"]').attr("disabled","disabled")});PopupToolsCtr.setEventHelpCtr()},hide:function(){PopupSecDetails.hide()}}}));f.setTitle(d);
Ext.getCmp("btnDlg_"+PopupSecDetails.id).setText(e);f.show()},processLoadObjectInnerHeaderTmp:function(){var a=parseInt(PopupSecDetails.elm.find('select[name="column_cof"]').val());PopupSecDetails.elm.find('input[name="inner_header_show_title1"]').prop("checked",PopupSecDetails.objectInnerHeaderTmp.v_cfg.inner_header_show_title1);PopupSecDetails.elm.find('input[name="inner_header_show_title2"]').prop("checked",PopupSecDetails.objectInnerHeaderTmp.v_cfg.inner_header_show_title2);$("#setting_inner_header").find('input[name="inner_header_title"]').val(PopupSecDetails.objectInnerHeaderTmp.v_cfg.title);
$("#setting_inner_header").find('input[name="inner_header_width"]').val(PopupSecDetails.objectInnerHeaderTmp.v_cfg.width);$("#setting_inner_header").find('select[name="inner_header_align"]').val(PopupSecDetails.objectInnerHeaderTmp.v_cfg.align);for(var b=1;b<a+1;b++){var d="inner_header_title_"+b,e="inner_header_width_"+b,f="inner_header_align_"+b;!0==PopupSecDetails.objectInnerHeaderTmp.v_cfg.inner_header_show_title1?($("#setting_inner_header").find('input[name="'+d+'"]').removeAttr("disabled"),
$("#setting_inner_header").find('select[name="'+f+'"]').removeAttr("disabled")):($("#setting_inner_header").find('input[name="'+d+'"]').attr("disabled","disabled"),$("#setting_inner_header").find('select[name="'+f+'"]').attr("disabled","disabled"));$("#setting_inner_header").find('input[name="'+d+'"]').val(PopupSecDetails.objectInnerHeaderTmp[d]);$("#setting_inner_header").find('input[name="'+e+'"]').val(PopupSecDetails.objectInnerHeaderTmp[e]);$("#setting_inner_header").find('select[name="'+f+'"]').val(PopupSecDetails.objectInnerHeaderTmp[f])}!0==
PopupSecDetails.objectInnerHeaderTmp.v_cfg.inner_header_show_title2?($("#setting_inner_header").find('input[name="inner_header_title"]').removeAttr("disabled"),$("#setting_inner_header").find('select[name="inner_header_align"]').removeAttr("disabled")):($("#setting_inner_header").find('input[name="inner_header_title"]').attr("disabled","disabled"),$("#setting_inner_header").find('select[name="inner_header_align"]').attr("disabled","disabled"))},setObjectInnerHeaderTmp:function(){PopupSecDetails.objectInnerHeaderTmp=
{};PopupSecDetails.objectInnerHeaderTmp.column_cof=parseInt(PopupSecDetails.elm.find('select[name="column_cof"]').val());PopupSecDetails.objectInnerHeaderTmp.v_cfg={};PopupSecDetails.objectInnerHeaderTmp.v_cfg.inner_header_show_title1=PopupSecDetails.elm.find('input[name="inner_header_show_title1"]').is(":checked");PopupSecDetails.objectInnerHeaderTmp.v_cfg.inner_header_show_title2=PopupSecDetails.elm.find('input[name="inner_header_show_title2"]').is(":checked");PopupSecDetails.objectInnerHeaderTmp.v_cfg.title=
$("#setting_inner_header").find('input[name="inner_header_title"]').val();PopupSecDetails.objectInnerHeaderTmp.v_cfg.width=$("#setting_inner_header").find('input[name="inner_header_width"]').val();PopupSecDetails.objectInnerHeaderTmp.v_cfg.align=$("#setting_inner_header").find('select[name="inner_header_align"]').val();for(var a=1;a<PopupSecDetails.objectInnerHeaderTmp.column_cof+1;a++){var b="inner_header_title_"+a,d="inner_header_width_"+a,e="inner_header_align_"+a;PopupSecDetails.objectInnerHeaderTmp[b]=
$("#setting_inner_header").find('input[name="'+b+'"]').val();PopupSecDetails.objectInnerHeaderTmp[d]=$("#setting_inner_header").find('input[name="'+d+'"]').val();PopupSecDetails.objectInnerHeaderTmp[e]=$("#setting_inner_header").find('select[name="'+e+'"]').val()}},clickedShowInnerHeaderTitle1:function(a){for(var b=parseInt(PopupSecDetails.elm.find('select[name="column_cof"]').val()),d=1;d<b+1;d++)!0==$(a).is(":checked")?($("#setting_inner_header").find('input[name="inner_header_title_'+d+'"]').removeAttr("disabled"),
$("#setting_inner_header").find('select[name="inner_header_align_'+d+'"]').removeAttr("disabled")):($("#setting_inner_header").find('input[name="inner_header_title_'+d+'"]').attr("disabled","disabled"),$("#setting_inner_header").find('select[name="inner_header_align_'+d+'"]').attr("disabled","disabled"))},clickedShowInnerHeaderTitle2:function(a){!0==$(a).is(":checked")?($("#setting_inner_header").find('input[name="inner_header_title"]').removeAttr("disabled"),$("#setting_inner_header").find('select[name="inner_header_align"]').removeAttr("disabled")):
($("#setting_inner_header").find('input[name="inner_header_title"]').attr("disabled","disabled"),$("#setting_inner_header").find('select[name="inner_header_align"]').attr("disabled","disabled"))},createSettingInnerHeader:function(a){$("#setting_inner_header").hide();$("#setting_inner_header").html(PopupSecDetails.createHTMLSettingInnerHeader(a));PopupSecDetails.elm.find('input[name="show_inner_header"]').is(":checked")?$("#setting_inner_header").fadeIn("slow"):$("#setting_inner_header").fadeOut("slow")},
createHTMLForShowInnerHeader:function(a){var b;b='<table class="detail"><tr>';b+='<td class="detail_name" style="background-image: none;width: 40px">';b+="No";b+="</td>";b+='<td class="detail_name" style="background-image: none;">';b+='<input onchange="PopupSecDetails.clickedShowInnerHeaderTitle1(this);" type="checkbox" name="inner_header_show_title1" class="inner_header_show_title" checked>';b+=MyLang.getMsg("LBL_HORIZONTAL_DISPLAY");b+="</td>";b+='<td class="detail_name" style="background-image: none;width: 120px">';
b+=MyLang.getMsg("LBL_HEADER_EXP");b+="</td>";b+='<td class="detail_name" style="background-image: none;width: 50px">';b+=MyLang.getMsg("LBL_HEADER_ARRANGE");b+="</td>";b+="</tr>";for(var d=1;d<a+1;d++)b+="<tr>",b+='<td class="detail_name">',b+=d,b+="</td>",b+="<td>",b+='<input class="inner_header_title textField w97pc" type="text" name="inner_header_title_'+d+'">',b+="</td>",b+="<td>",b+='<input class="inner_header_width textField" type="text" name="inner_header_width_'+d+'">',b+="</td>",b+="<td>",
b+='<select class="inner_header_align" type="text" name="inner_header_align_'+d+'">',b+='<option value="left">'+MyLang.getMsg("LBL_COL_ALIGN_LEFT")+"</option>",b+='<option value="center">'+MyLang.getMsg("LBL_COL_ALIGN_CENTER")+"</option>",b+='<option value="right">'+MyLang.getMsg("LBL_COL_ALIGN_RIGHT")+"</option>",b+="</select>",b+="</td>",b+="</tr>";return b+="</table>"},createHTMLForShowInnerHeader2:function(a){a='<table class="detail"><tr>';a+='<td class="detail_name" style="background-image: none;width: 40px">';
a+="No";a+="</td>";a+='<td class="detail_name" style="background-image: none;">';a+='<input onchange="PopupSecDetails.clickedShowInnerHeaderTitle2(this);" type="checkbox" name="inner_header_show_title2" class="inner_header_show_title">';a+=MyLang.getMsg("LBL_VERTICAL_DISPLAY");a+="</td>";a+='<td class="detail_name" style="background-image: none;width: 120px">';a+=MyLang.getMsg("LBL_HEADER_EXP");a+="</td>";a+='<td class="detail_name" style="background-image: none;width: 50px">';a+=MyLang.getMsg("LBL_HEADER_ARRANGE");
a+="</td>";a+="</tr>";a+="<tr>";a+='<td class="detail_name">';a+="1";a+="</td>";a+="<td>";a+='<input class="inner_header_title textField w97pc" type="text" name="inner_header_title" disabled>';a+="</td>";a+="<td>";a+='<input class="inner_header_width textField" type="text" name="inner_header_width">';a+="</td>";a+="<td>";a+='<select class="inner_header_align" type="text" name="inner_header_align" disabled>';a+='<option value="left">'+MyLang.getMsg("LBL_COL_ALIGN_LEFT")+"</option>";a+='<option value="center">'+
MyLang.getMsg("LBL_COL_ALIGN_CENTER")+"</option>";a+='<option value="right">'+MyLang.getMsg("LBL_COL_ALIGN_RIGHT")+"</option>";a+="</select>";a+="</td>";a+="</tr>";return a+="</table>"},createHTMLSettingInnerHeader:function(a){a=parseInt(a);var b;b=""+this.createHTMLForShowInnerHeader(a);return b+=this.createHTMLForShowInnerHeader2(a)},save:function(){var a=PopupSecDetails.elm.find('input[name="categoryname"]').val();if(""==a.trim())Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_SECTION_NAME_REQUIRED"),
buttons:Ext.Msg.OK});else{var b=parseInt(PopupSecDetails.elm.find('select[name="column_cof"]').val()),d=PopupSecDetails.elm.find('input[name="show_header"]').is(":checked"),e=PopupSecDetails.elm.find('input[name="sec_class"]').val(),f=PopupSecDetails.elm.find('input[name="sec_attr_name"]').val(),c=PopupSecDetails.elm.find(':input[name="sec_attrs"]').val().split(" "),g=[];$.each(c,function(){var a=this.split("=");"class"!=a[0]&&"name"!=a[0]&&g.push(this)});for(var g=g.join(" "),g=escapeAndEncodeHtml(g.trim()),
c=PopupSecDetails.elm.find('input[name="collapsible"]').is(":checked"),h=PopupSecDetails.elm.find('input[name="show_inner_header"]').is(":checked"),l={},k=1;k<b+1;k++)l[k]={},l[k].title=void 0!=$("#setting_inner_header").find('input[name="inner_header_title_'+k+'"]').val()?$("#setting_inner_header").find('input[name="inner_header_title_'+k+'"]').val():"",l[k].width=void 0!=$("#setting_inner_header").find('input[name="inner_header_width_'+k+'"]').val()?$("#setting_inner_header").find('input[name="inner_header_width_'+
k+'"]').val():"",l[k].align=void 0!=$("#setting_inner_header").find('select[name="inner_header_align_'+k+'"]').val()?$("#setting_inner_header").find('select[name="inner_header_align_'+k+'"]').val():"left";l.v_cfg={};l.v_cfg.inner_header_show_title1=$("#setting_inner_header").find('input[name="inner_header_show_title1"]').is(":checked");l.v_cfg.inner_header_show_title2=$("#setting_inner_header").find('input[name="inner_header_show_title2"]').is(":checked");l.v_cfg.title=$("#setting_inner_header").find('input[name="inner_header_title"]').val();
l.v_cfg.width=$("#setting_inner_header").find('input[name="inner_header_width"]').val();l.v_cfg.align=$("#setting_inner_header").find('select[name="inner_header_align"]').val();"function"==typeof PopupSecDetails.callback&&PopupSecDetails.callback({section_id:PopupSecDetails.section.section_id,secname:a.trim(),column_cof:parseInt(b),show_header:d,sec_class:e,sec_attr_name:f,sec_attrs:g,collapsible:c,show_inner_header:h,setting_inner_header:l});PopupSecDetails.hide()}},hide:function(){PopupSecDetails.callback=
null;PopupSecDetails.section=null;PopupSecDetails.isEdit=!1;var a=Ext.getCmp("dlg_"+PopupSecDetails.id);a&&a.close()},create:function(){var a;a='<table cellspacing="0" cellpadding="0" border="0" width="100%" class="mT20"><tbody>';a+="<tr>";a+='<td class="lbl pL10 f13">'+MyLang.getMsg("LBL_SECTION_NAME")+"</td>";a+="</tr>";a+="<tr>";a+='<td class="alignleft lbl pL10" colspan="2">';a+='<input type="text" class="textField f13 p5" style="width:200px" size="40" name="categoryname">';a+='<label><input type="checkbox" style="margin-left: 5px" class="f13" name="show_header"> '+
MyLang.getMsg("LBL_SECTION_DISPLAY_NAME")+"&nbsp;</label>";a+='<label><input type="checkbox" name="collapsible" disabled>&nbsp;'+MyLang.getMsg("LBL_SECTION_DISPLAY_TOGGLE")+"</label>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td class="lbl pL10">';a+='<ul class="inline-block">';a+='<li><div class="f13 mt5">'+MyLang.getMsg("LBL_SECTION_ATTR_NAME")+"</div>";a+='<input type="text" class="textField f13 p5" style="width:200px" size="40" name="sec_attr_name"></li>';a+="</ul>";a+="</td>";a+="</tr>";a+="<tr>";
a+="<tr>";a+="<td>";a+="<table><tr>";a+='<td class="lbl pL10">';a+='<ul class="inline-block">';a+='<li><div class="f13 mt5">'+MyLang.getMsg("LBL_SATERAITO_CLASS")+"</div>";a+='<input type="text" class="textField f13 p5" style="width:200px" size="40" name="sec_class"></li>';a+="<li>";a+='<div class="help_ctr"></div>';a+='<p style="display: none;" class="description2">'+MyLang.getMsg("LBL_SECTION_CLASS_EXP")+"</p>";a+="</li>";a+="</ul>";a+="</td>";a+='<td class="lbl pL10">';a+='<ul class="inline-block">';
a+='<li><div class="f13 mt5">'+MyLang.getMsg("LBL_SECTION_ATTR")+"</div>";a+='<input type="text" class="textField f13 p5" style="width:200px" size="40" name="sec_attrs"></li>';a+="</ul>";a+="</td>";a+="</tr></table>";a+="<td>";a+="</tr>";a+="<tr>";a+='<td class="lbl pL10">';a+='<ul class="inline-block">';a+='<li><div class="f13 mt5">'+MyLang.getMsg("LBL_SECTION_COLUMN")+"</div></li>";a+='<li><div class="newSelect p5"><select name="column_cof">';for(var b=1;b<PopupSecDetails.maxCol+1;b++)a=1==b?a+
('<option value="'+b+'" selected="true">'+b+MyLang.getMsg("LBL_COLUMN")+"</option>"):a+('<option value="'+b+'">'+b+MyLang.getMsg("LBL_COLUMN")+"</option>");a+="</select></div></li></ul>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td class="lbl pL10">';a+='<div class="f13 mt5"><label><input type="checkbox" name="show_inner_header">&nbsp;'+MyLang.getMsg("LBL_DISPLAY_COLUMN")+"</label>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td class="alignleft lbl" colspan="2">';a+='<div id="setting_inner_header"></div>';a+=
"</td>";a+="</tr>";a+="</tbody>";return a+="</table>"}};PopupToolsCtr={elm:null,isEdit:!1,controlDetail:null,callback:null,setting_fields:{},rbgitems:[],bgitems:[],boxHtml:"",clear:function(){this.setting_fields={};this.rbgitems=[];this.bgitems=[];this.boxHtml=""},setEventHelpCtr:function(){$(document).off("click",".help_ctr");$(document).on("click",".help_ctr",function(){var a=this,b;$(this).attr("mode_show")||$(this).attr("mode_show","false");$(this).attr("class","help_ctr help_ctr_active");$.each($(document).find(".help_ctr"),
function(){if($(a).attr("class")!=$(this).attr("class")){var b=$(this).next();"description2"==b.attr("class")&&b.hide();$(this).attr("class","help_ctr")}});b="false"==$(this).attr("mode_show")?!0:!1;"description2"==$(this).next().attr("class")&&(!0==b?$(this).next().fadeIn("slow"):$(this).next().hide());$(this).attr("mode_show",b.toString());$(this).attr("class","help_ctr")})},show:function(a,b){PopupToolsCtr.callback=b;PopupToolsCtr.rbgitems=[];PopupToolsCtr.boxHtml="";PopupToolsCtr.serial_number_setting=
{};PopupToolsCtr.number_control=1;PopupToolsCtr.id="add_tool_control";null!=a&&(PopupToolsCtr.id="edit_tool_control",PopupToolsCtr.controlDetail=a,PopupToolsCtr.isEdit=!0);var d="",e="";!0==PopupToolsCtr.isEdit?(d=MyLang.getMsg("LBL_ITEM_EDIT"),e=MyLang.getMsg("BTN_SAVE")):(d=MyLang.getMsg("LBL_ITEM_ADD_NEW"),e=MyLang.getMsg("BTN_ADD"));var f=Ext.getCmp("dlg_"+PopupToolsCtr.id);f||(f=[],f.push(new Ext.Button({id:"btnDlg_"+PopupToolsCtr.id,text:e,handler:function(){PopupToolsCtr.save()}})),!0==PopupToolsCtr.isEdit&&
(f.push(new Ext.Button({id:"btnDlgCopy_"+PopupToolsCtr.id,text:MyLang.getMsg("BTN_MULTI_COPY"),handler:function(){PopupToolsCtr.save(!0)}})),f.push(new Ext.Button({id:"btnDlgDelete_"+PopupToolsCtr.id,text:MyLang.getMsg("BTN_DELETE"),handler:function(){PopupToolsCtr.save(!1,!0)}}))),f.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){PopupToolsCtr.hide()}})),f=new Ext.Window({id:"dlg_"+PopupToolsCtr.id,title:d,layout:"fit",width:1050,height:500,closeAction:"hide",plain:!0,modal:!0,
items:new Ext.Panel({border:!1,autoScroll:!0,html:'<div id="'+PopupToolsCtr.id+'"></div>'}),buttons:f,listeners:{afterRender:function(){PopupToolsCtr.elm=$("#"+PopupToolsCtr.id);PopupToolsCtr.elm.html("");if(!0==PopupToolsCtr.isEdit){PopupToolsCtr.elm.append(PopupToolsCtr.createEditCtrHtml(Controller.MapType[PopupToolsCtr.controlDetail.map_type_control].label));$("#new_cf_field").html("");$("#new_cf_field").attr("map_type",PopupToolsCtr.controlDetail.map_type_control);var a;"radiogroup"==PopupToolsCtr.controlDetail.map_type_control&&
(PopupToolsCtr.rbgitems=clone(PopupToolsCtr.controlDetail.config.items),a="radiogroup");"checkboxgroup"==PopupToolsCtr.controlDetail.map_type_control&&(PopupToolsCtr.rbgitems=clone(PopupToolsCtr.controlDetail.config.items),a="checkboxgroup");"boxgroup"==PopupToolsCtr.controlDetail.map_type_control&&(PopupToolsCtr.bgitems=clone(PopupToolsCtr.controlDetail.config.items),a="boxgroup");"box"==PopupToolsCtr.controlDetail.map_type_control&&(PopupToolsCtr.boxHtml=PopupToolsCtr.controlDetail.config.html,
a="box");a=PopupToolsCtr.createHtmlCfgNewField(PopupToolsCtr.controlDetail,PopupToolsCtr.controlDetail.map_type_control,a);$("#new_cf_field").append(a)}else PopupToolsCtr.elm.append(PopupToolsCtr.createCustomFieldHtml()),$("td.fieldType").click(function(){$.each($("table.tblFieldType").find("td.fieldType"),function(){this.className="fieldType"});this.className="fieldType active";PopupToolsCtr.clear();PopupToolsCtr.controlDetail=clone(Controller.MapType[$(this).attr("map_type")]);$("#new_cf_field").html("");
$("#new_cf_field").attr("map_type",$(this).attr("map_type"));var a=PopupToolsCtr.createHtmlCfgNewField(PopupToolsCtr.controlDetail,$(this).attr("map_type"));$("#new_cf_field").append(a);PopupToolsCtr.setEventHelpCtr();a=PopupToolsCtr.elm.find('select[name="column_section"]');a.empty();for(var c=MainLayout.elmTemplateList.val(),b=TemplateList.getTemplateDetail(c),d=1;d<b.sections[0].column_cof+1;d++)a.append('<option value="'+d+'">'+d+"</option>");PopupToolsCtr.elm.find('select[name="sections"]').change(function(){var a=
$(this).val(),a=TemplateList.getSectionDetail(c,a),b=PopupToolsCtr.elm.find('select[name="column_section"]');b.empty();for(var d=1;d<a.column_cof+1;d++)b.append('<option value="'+d+'">'+d+"</option>")});var e=document.getElementById("serial_number_setting");e&&$(e).find('select[name="serialNumberDirection"]').change(function(){"horizontal"==$(this).val()?$(e).find('input[name="serialNumberLength"]').attr("disabled","disabled"):$(e).find('input[name="serialNumberLength"]').removeAttr("disabled")})});
PopupToolsCtr.setEventHelpCtr()},hide:function(){PopupToolsCtr.hide()}}}));f.setTitle(d);Ext.getCmp("btnDlg_"+PopupToolsCtr.id).setText(e);f.show()},getConfig:function(a,b,d,e){function f(a){if("undefined"==typeof e)return!1;for(var c=0;c<e.length;c++)if(a==e[c])return!0;return!1}var c={},g={},h;for(h in d)if(!0!=f(h)&&!0==d[h]){var l=null;switch(h){case "rbgdirection":l=b.find('select[name="rbGroupDirection"]').val();break;case "bgdirection":l=b.find('select[name="boxGroupDirection"]').val();break;
case "lblname":l=b.find('input[name="fldLabel"]').val();break;case "showlblname":l=b.find('input[name="fldShowLabel"]').is(":checked").toString();break;case "widthlbl":l=b.find('input[name="fldWidthLabel"]').val();break;case "beforecontent":l=b.find('input[name="fldBeforeContent"]').val();g.beforecontentcolor=b.find('input[name="fldBeforeContentColor"]').val();g.beforecontentbold=!0==b.find('input[name="fldBeforeContentBold"]').is(":checked")?"bold":"normal";break;case "aftercontent":l=b.find('input[name="fldAfterContent"]').val();
g.aftercontentcolor=b.find('input[name="fldAfterContentColor"]').val();g.aftercontentbold=!0==b.find('input[name="fldAfterContentBold"]').is(":checked")?"bold":"normal";break;case "name":l=b.find('input[name="fldName"]').val();if(""==l.trim()){Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_ITEM_NAME_REQUIRED"),buttons:Ext.Msg.OK});return}break;case "style":l=b.find('input[name="fldStyle"]').val();break;case "html":"box"==a&&(PopupToolsCtr.boxHtml=escapeAndEncodeHtml(removeAllScriptTags(b.find('textarea[name="fldHtml"]').val())));
break;case "items":if("radiogroup"==a)for(var c=[],k=0;k<PopupToolsCtr.rbgitems.length;k++)c.push(PopupToolsCtr.rbgitems[k]);else if("checkboxgroup"==a)for(c=[],k=0;k<PopupToolsCtr.rbgitems.length;k++)c.push(PopupToolsCtr.rbgitems[k]);else if("boxgroup"==a)for(c=[],k=0;k<PopupToolsCtr.bgitems.length;k++)c.push(PopupToolsCtr.bgitems[k]);else{var m=[];$.each(b.find('select[name="fldItems"]').find("option"),function(){m.push({text:this.text,value:this.value})});c=m}break;case "value":l="textarea"==a?
escapeAndEncodeHtml(b.find('textarea[name="fldValue"]').val()):b.find('input[name="fldValue"]').val();break;case "cols":l=b.find('input[name="fldCols"]').val();break;case "rows":l=b.find('input[name="fldRows"]').val();break;case "disabled":l=!0==b.find('input[name="fldDisabled"]').is(":checked")?"disabled":null;break;case "readOnly":l=!0==b.find('input[name="fldReadOnly"]').is(":checked")?"readOnly":null;break;case "checked":l=!0==b.find('input[name="fldChecked"]').is(":checked")?"checked":null;break;
case "multiple":l=!0==b.find('input[name="fldMultiple"]').is(":checked")?"multiple":null;break;case "maxlength":l=b.find('input[name="fldMaxLength"]').val();break;case "class":l=b.find('input[name="fldClassName"]').val();break;case "new_attrs":l=b.find('textarea[name="fldNewAttributes"]').val();break;case "max_row":l=parseInt(b.find('input[name="fldMaxRow"]').val());break;case "max_col":l=parseInt(b.find('input[name="fldMaxCol"]').val())}null!=l&&(g[h]=l)}a={};a.items=c;a.attributes=g;return a},save:function(a,
b){var d=$("#new_cf_field").attr("map_type");if(void 0==d)Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_ITEM_ADD_REQUIRED"),buttons:Ext.Msg.OK});else{var e=PopupToolsCtr.getConfig(d,PopupToolsCtr.elm,Controller.MapType[d].config.settingfields),f={};e.attributes&&(f=e.attributes);var c=e.items;"radiogroup"==d&&(c=clone(PopupToolsCtr.rbgitems));"checkboxgroup"==d&&(c=clone(PopupToolsCtr.rbgitems));"boxgroup"==d&&(c=clone(PopupToolsCtr.bgitems));var g="";"box"==d&&(g=PopupToolsCtr.boxHtml);
if(!0==PopupToolsCtr.isEdit){if("function"==typeof PopupToolsCtr.callback){var h=PopupToolsCtr.callback;"undefined"==typeof a&&(a=!1);"undefined"==typeof b&&(b=!1);!0==b?Ext.Msg.show({icon:Ext.MessageBox.QUESTION,msg:MyLang.getMsg("MSG_ITEM_DELETE"),buttons:Ext.Msg.OKCANCEL,fn:function(e){"ok"==e&&h({map_type:d,attributes:f,items:c,html:g,mode_save_and_copy:a,mode_delete:b})}}):h({map_type:d,attributes:f,items:c,html:g,mode_save_and_copy:a,mode_delete:b})}}else{e=PopupToolsCtr.elm.find('select[name="sections"]').val();
"serial_number"==d&&(PopupToolsCtr.serial_number_setting.custom_name=$("#serial_number_setting").find('input[name="serialNumberCustomName"]').val(),PopupToolsCtr.serial_number_setting.style=$("#serial_number_setting").find('input[name="serialNumberStyle"]').val(),PopupToolsCtr.serial_number_setting.class=$("#serial_number_setting").find('input[name="serialNumberClassName"]').val(),PopupToolsCtr.serial_number_setting.direction=$("#serial_number_setting").find('select[name="serialNumberDirection"]').val(),
PopupToolsCtr.serial_number_setting.length=""==$("#serial_number_setting").find('input[name="serialNumberLength"]').val().trim()?1:parseInt($("#serial_number_setting").find('input[name="serialNumberLength"]').val().trim()));var l=1;0<PopupToolsCtr.elm.find('input[name="fldNumberControl"]').length&&(l=PopupToolsCtr.elm.find('input[name="fldNumberControl"]').val().trim(),l=""==l?1:parseInt(l));var k=PopupToolsCtr.elm.find('select[name="column_section"]'),m=1;0<k.length&&(m=parseInt(k.val().trim()));
"function"==typeof PopupToolsCtr.callback&&PopupToolsCtr.callback({section_id:e,map_type:d,attributes:f,items:c,html:g,serial_number_setting:PopupToolsCtr.serial_number_setting,number_control:l,column_section:m})}PopupToolsCtr.hide()}},hide:function(){PopupToolsCtr.callback=null;PopupToolsCtr.controlDetail=null;PopupToolsCtr.isEdit=!1;PopupToolsCtr.rbgitems=[];PopupToolsCtr.bgitems=[];PopupToolsCtr.boxHtml="";var a=Ext.getCmp("dlg_"+PopupToolsCtr.id);a&&a.close()},addBoxItemsGroup:function(a){if(""==
PopupToolsCtr.elm.find('input[name="fldName"]').val().trim())Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_ITEM_NAME_REQUIRED"),buttons:Ext.Msg.OK}),PopupToolsCtr.elm.find('input[name="fldName"]').focus();else{var b=Ext.getCmp("dlg_add_box_item_group");if(!b){a=[];a.push(new Ext.Button({text:MyLang.getMsg("BTN_ADD"),handler:function(){var a=$("#dlg_add_box_item_group_new_cf_field").attr("map_type");if(void 0==a)Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_ITEM_ADD_REQUIRED"),
buttons:Ext.Msg.OK});else{var d=Controller.MapType[a],c=d.config.settingfields,g=PopupToolsCtr.getConfig(a,$("#dlg_add_box_item_group_content"),c),c={};g.attributes&&(c=g.attributes);g=g.items;d=clone(d);d.control_id=MainLayout.createNewControlId();d.config.items=g;d.config.attributes=c;d.map_type_control=a;PopupToolsCtr.bgitems.push(d);a=PopupToolsCtr.elm.find('select[name="fldBoxItemsGroup"]');(c=d.config.attributes.lblname)&&""==c.toString().trim()&&(c=d.config.attributes.name);a.append('<option value="'+
(PopupToolsCtr.bgitems.length-1)+'">'+c+"</option>");b.close()}}}));a.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){b.close()}}));var d;d='<div style="padding-top: 5px"><div id="dlg_add_box_item_group_content"></div>';d+="</div>";b=new Ext.Window({id:"dlg_add_box_item_group",title:MyLang.getMsg("TITLE_ITEM_ADD"),layout:"fit",width:900,height:500,closeAction:"hide",plain:!0,modal:!0,items:new Ext.Panel({border:!1,autoScroll:!0,html:d}),buttons:a,listeners:{afterRender:function(){$("#dlg_add_box_item_group_content").append(PopupToolsCtr.createCustomFieldHtml("dlg_add_box_item_group_new_cf_field",
"hidden label time date color email file button submit text textarea radio checkbox select".split(" ")));$("td.fieldType").click(function(){$.each($("table.tblFieldType").find("td.fieldType"),function(){this.className="fieldType"});this.className="fieldType active";$("#dlg_add_box_item_group_new_cf_field").html("");$("#dlg_add_box_item_group_new_cf_field").attr("map_type",$(this).attr("map_type"));var a=PopupToolsCtr.createHtmlCfgNewField(PopupToolsCtr.controlDetail,$(this).attr("map_type"),"boxgroup",
"dlg_add_box_item_group_new_cf_field");$("#dlg_add_box_item_group_new_cf_field").append(a)});PopupToolsCtr.setEventHelpCtr()},hide:function(a){(a=Ext.getCmp(a.id))&&a.close()}}})}b.show()}},editBoxItemsGroup:function(){var a=PopupToolsCtr.elm.find('select[name="fldBoxItemsGroup"]').val();if(a&&0<a.length){var b=PopupToolsCtr.bgitems[a[0]],d=b.map_type_control,e=clone(Controller.MapType[d]);e.config.attributes.lblname=b.config.attributes.lblname;e.config.attributes.name=b.config.attributes.name;for(var f in b.config)e.config[f]=
b.config[f];var c=Ext.getCmp("dlg_edit_box_item_group");c||(b=[],b.push(new Ext.Button({text:MyLang.getMsg("BTN_SAVE"),handler:function(){var b=Controller.MapType[d],e=PopupToolsCtr.getConfig(d,$("#dlg_edit_box_item_group"),b.config.settingfields),f={};e.attributes&&(f=e.attributes);e=e.items;b=clone(b);b.config.items=e;b.config.attributes=f;b.map_type_control=d;PopupToolsCtr.bgitems[a[0]]=b;f=PopupToolsCtr.elm.find('select[name="fldBoxItemsGroup"]');f.empty();for(b=0;b<PopupToolsCtr.bgitems.length;b++){var e=
PopupToolsCtr.bgitems[b],k=e.config.attributes.lblname;k&&""==k.toString().trim()&&(k=e.config.attributes.name);f.append('<option value="'+b+'">'+k+"</option>")}c.close()}})),b.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){c.close()}})),e='<div style="padding-top: 5px">'+PopupToolsCtr.createHtmlCfgNewField(e,d,"box_group","dlg_edit_box_item_group"),e+="</div>",c=new Ext.Window({id:"dlg_edit_box_item_group",title:MyLang.getMsg("TITLE_ITEM_EDIT"),layout:"fit",width:800,height:500,
closeAction:"hide",plain:!0,modal:!0,items:new Ext.Panel({border:!1,autoScroll:!0,html:e}),buttons:b,listeners:{afterRender:function(){PopupToolsCtr.setEventHelpCtr()},hide:function(a){(a=Ext.getCmp(a.id))&&a.close()}}}));c.show()}else Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_RAIDO_ITEM_SELECT"),buttons:Ext.Msg.OK})},deleteBoxItemGroup:function(){var a=PopupToolsCtr.elm.find('select[name="fldBoxItemsGroup"]'),b=a.val();if(b)for($.each(b,function(){a.find("option[value='"+this+
"']").remove();PopupToolsCtr.bgitems.splice(parseInt(this),1)}),a.empty(),b=0;b<PopupToolsCtr.bgitems.length;b++){var d=PopupToolsCtr.bgitems[b],e=d.config.attributes.lblname;e&&""==e.toString().trim()&&(e=d.config.attributes.name);a.append('<option value="'+b+'">'+e+"</option>")}},addItemsGroup:function(a){var b=PopupToolsCtr.elm.find('input[name="fldName"]').val();if(""==b.trim())Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_ITEM_NAME_REQUIRED"),buttons:Ext.Msg.OK}),PopupToolsCtr.elm.find('input[name="fldName"]').focus();
else{var d=Ext.getCmp("dlg_add_item_group");if(!d){a=[];a.push(new Ext.Button({text:MyLang.getMsg("BTN_ADD"),handler:function(){var a=Controller.MapType.radio,c=PopupToolsCtr.getConfig("radio",$("#dlg_add_item_group"),a.config.settingfields,["name"]),e={};c.attributes&&(e=c.attributes);c=c.items;a=clone(a);a.config.items=c;a.config.attributes=e;a.config.attributes.name=b;a.map_type_control="radio";PopupToolsCtr.rbgitems.push(a);e=PopupToolsCtr.elm.find('select[name="fldItemsGroup"]');(c=a.config.attributes.lblname)&&
""==c.toString().trim()&&(c=a.config.attributes.name);e.append('<option value="'+(PopupToolsCtr.rbgitems.length-1)+'">'+c+"</option>");d.close()}}));a.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){d.close()}}));var e;e='<div style="padding-top: 5px">'+PopupToolsCtr.createHtmlCfgNewField(PopupToolsCtr.controlDetail,"radio","radiogroup");e+="</div>";d=new Ext.Window({id:"dlg_add_item_group",title:MyLang.getMsg("TITLE_ITEM_ADD"),layout:"fit",width:850,height:350,closeAction:"hide",
plain:!0,modal:!0,items:new Ext.Panel({border:!1,autoScroll:!0,html:e}),buttons:a,listeners:{afterRender:function(){PopupToolsCtr.setEventHelpCtr()},hide:function(a){(a=Ext.getCmp(a.id))&&a.close()}}})}d.show()}},editItemsGroup:function(){var a=PopupToolsCtr.elm.find('select[name="fldItemsGroup"]').val();if(a&&0<a.length){var b=PopupToolsCtr.rbgitems[a[0]],d="radio",e=clone(Controller.MapType.radio);e.config.attributes.lblname=b.config.attributes.lblname;e.config.attributes.name=b.config.attributes.name;
for(var f in b.config)e.config[f]=b.config[f];var c=Ext.getCmp("dlg_edit_item_group");c||(f=[],f.push(new Ext.Button({text:MyLang.getMsg("BTN_SAVE"),handler:function(){var e=Controller.MapType[d],f=PopupToolsCtr.getConfig(d,$("#dlg_edit_item_group"),e.config.settingfields,["name"]),l={};f.attributes&&(l=f.attributes);f=f.items;e=clone(e);e.config.items=f;e.config.attributes=l;e.config.attributes.name=b.config.attributes.name;e.map_type_control="radio";PopupToolsCtr.rbgitems[a[0]]=e;l=PopupToolsCtr.elm.find('select[name="fldItemsGroup"]');
l.empty();for(e=0;e<PopupToolsCtr.rbgitems.length;e++){var f=PopupToolsCtr.rbgitems[e],k=f.config.attributes.lblname;k&&""==k.toString().trim()&&(k=f.config.attributes.name);l.append('<option value="'+e+'">'+k+"</option>")}c.close()}})),f.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){c.close()}})),d="radio",e='<div style="padding-top: 5px">'+PopupToolsCtr.createHtmlCfgNewField(e,d,"radiogroup"),e+="</div>",c=new Ext.Window({id:"dlg_edit_item_group",title:MyLang.getMsg("TITLE_ITEM_EDIT"),
layout:"fit",width:800,height:350,closeAction:"hide",plain:!0,modal:!0,items:new Ext.Panel({border:!1,autoScroll:!0,html:e}),buttons:f,listeners:{afterRender:function(){PopupToolsCtr.setEventHelpCtr()},hide:function(a){(a=Ext.getCmp(a.id))&&a.close()}}}));c.show()}else Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_RAIDO_ITEM_SELECT"),buttons:Ext.Msg.OK})},deleteItemGroup:function(){var a=PopupToolsCtr.elm.find('select[name="fldItemsGroup"]'),b=a.val();if(b)for($.each(b,function(){a.find("option[value='"+
this+"']").remove();PopupToolsCtr.rbgitems.splice(parseInt(this),1)}),a.empty(),b=0;b<PopupToolsCtr.rbgitems.length;b++){var d=PopupToolsCtr.rbgitems[b],e=d.config.attributes.lblname;e&&""==e.toString().trim()&&(e=d.config.attributes.name);a.append('<option value="'+b+'">'+e+"</option>")}},addItemsGroupCheckbox:function(a){var b=PopupToolsCtr.elm.find('input[name="fldName"]').val();if(""==b.trim())Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_ITEM_NAME_REQUIRED"),buttons:Ext.Msg.OK}),
PopupToolsCtr.elm.find('input[name="fldName"]').focus();else{var d=Ext.getCmp("dlg_add_item_group");if(!d){a=[];a.push(new Ext.Button({text:MyLang.getMsg("BTN_ADD"),handler:function(){var a=Controller.MapType.checkbox,c=PopupToolsCtr.getConfig("checkbox",$("#dlg_add_item_group"),a.config.settingfields,["name"]),e={};c.attributes&&(e=c.attributes);c=c.items;a=clone(a);a.config.items=c;a.config.attributes=e;a.config.attributes.name=b;a.map_type_control="checkbox";PopupToolsCtr.rbgitems.push(a);e=PopupToolsCtr.elm.find('select[name="fldItemsGroup"]');
(c=a.config.attributes.lblname)&&""==c.toString().trim()&&(c=a.config.attributes.name);e.append('<option value="'+(PopupToolsCtr.rbgitems.length-1)+'">'+c+"</option>");d.close()}}));a.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){d.close()}}));var e;e='<div style="padding-top: 5px">'+PopupToolsCtr.createHtmlCfgNewField(PopupToolsCtr.controlDetail,"checkbox","checkboxgroup");e+="</div>";d=new Ext.Window({id:"dlg_add_item_group",title:MyLang.getMsg("TITLE_ITEM_ADD"),layout:"fit",
width:850,height:350,closeAction:"hide",plain:!0,modal:!0,items:new Ext.Panel({border:!1,autoScroll:!0,html:e}),buttons:a,listeners:{afterRender:function(){PopupToolsCtr.setEventHelpCtr()},hide:function(a){(a=Ext.getCmp(a.id))&&a.close()}}})}d.show()}},editItemsGroupCheckbox:function(){var a=PopupToolsCtr.elm.find('select[name="fldItemsGroup"]').val();if(a&&0<a.length){var b=PopupToolsCtr.rbgitems[a[0]],d="checkbox",e=clone(Controller.MapType.checkbox);e.config.attributes.lblname=b.config.attributes.lblname;
e.config.attributes.name=b.config.attributes.name;for(var f in b.config)e.config[f]=b.config[f];var c=Ext.getCmp("dlg_edit_item_group");c||(f=[],f.push(new Ext.Button({text:MyLang.getMsg("BTN_SAVE"),handler:function(){var e=Controller.MapType[d],f=PopupToolsCtr.getConfig(d,$("#dlg_edit_item_group"),e.config.settingfields,["name"]),l={};f.attributes&&(l=f.attributes);f=f.items;e=clone(e);e.config.items=f;e.config.attributes=l;e.config.attributes.name=b.config.attributes.name;e.map_type_control="checkbox";
PopupToolsCtr.rbgitems[a[0]]=e;l=PopupToolsCtr.elm.find('select[name="fldItemsGroup"]');l.empty();for(e=0;e<PopupToolsCtr.rbgitems.length;e++){var f=PopupToolsCtr.rbgitems[e],k=f.config.attributes.lblname;k&&""==k.toString().trim()&&(k=f.config.attributes.name);l.append('<option value="'+e+'">'+k+"</option>")}c.close()}})),f.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){c.close()}})),d="radio",e='<div style="padding-top: 5px">'+PopupToolsCtr.createHtmlCfgNewField(e,d,"checkboxgroup"),
e+="</div>",c=new Ext.Window({id:"dlg_edit_item_group",title:MyLang.getMsg("TITLE_ITEM_EDIT"),layout:"fit",width:800,height:350,closeAction:"hide",plain:!0,modal:!0,items:new Ext.Panel({border:!1,autoScroll:!0,html:e}),buttons:f,listeners:{afterRender:function(){PopupToolsCtr.setEventHelpCtr()},hide:function(a){(a=Ext.getCmp(a.id))&&a.close()}}}));c.show()}else Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_RAIDO_ITEM_SELECT"),buttons:Ext.Msg.OK})},deleteItemGroupCheckbox:function(){var a=
PopupToolsCtr.elm.find('select[name="fldItemsGroup"]'),b=a.val();if(b)for($.each(b,function(){a.find("option[value='"+this+"']").remove();PopupToolsCtr.rbgitems.splice(parseInt(this),1)}),a.empty(),b=0;b<PopupToolsCtr.rbgitems.length;b++){var d=PopupToolsCtr.rbgitems[b],e=d.config.attributes.lblname;e&&""==e.toString().trim()&&(e=d.config.attributes.name);a.append('<option value="'+b+'">'+e+"</option>")}},addItem:function(a){var b=$(a).attr("parentid");"undefined"==b&&(b=PopupToolsCtr.elm[0].id);
var d=Ext.getCmp("dlg_add_item");if(!d){a=[];a.push(new Ext.Button({text:MyLang.getMsg("BTN_ADD"),handler:function(){var a=$("#dlg_add_item_item_name").val(),c=$("#dlg_add_item_item_value").val();$("#"+b).find('select[name="fldItems"]').append('<option value="'+c+'">'+a+"</option>");d.close()}}));a.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){d.close()}}));var e;e='<div style="display: block" class="p10"><div>';e+='<table border = "0" cellspacing = "1" cellpadding = "0" >';
e+="<tr>";e+='<td class="newLabel" nowrap="">'+MyLang.getMsg("LBL_LIST_ITEM_DISPLAY_VALUE")+"</td>";e+='<td width="200">';e+='<input type="text" id="dlg_add_item_item_name" name="itemname" class="textField p5">';e+="</td></tr>";e+="<tr>";e+='<td class="newLabel" nowrap="">'+MyLang.getMsg("LBL_LIST_ITEM_SUBMIT_VALUE")+"</td>";e+='<td width="200">';e+='<input type="text" id="dlg_add_item_item_value" name="itemvalue" class="textField p5">';e+="</td></tr>";e+="</table>";e+="</div>";e+="</div>";d=new Ext.Window({id:"dlg_add_item",
title:MyLang.getMsg("TITLE_LIST_ITEM"),layout:"fit",width:450,height:200,closeAction:"hide",plain:!0,modal:!0,items:new Ext.Panel({border:!1,autoScroll:!0,html:e}),buttons:a,listeners:{afterRender:function(){PopupToolsCtr.setEventHelpCtr()},hide:function(a){(a=Ext.getCmp(a.id))&&a.close()}}})}d.show()},editItem:function(a){a=$(a).attr("parentid");"undefined"==a&&(a=PopupToolsCtr.elm[0].id);$("#"+a).find('select[name="fldItems"]');a=$("#"+a).find('select[name="fldItems"] option');var b=a.index(a.filter(":selected"));
if(-1<b){var d=a[b],e=Ext.getCmp("dlg_edit_item");e||(a=[],a.push(new Ext.Button({text:MyLang.getMsg("BTN_SAVE"),handler:function(){var a=$("#dlg_add_item_item_name").val(),c=$("#dlg_add_item_item_value").val();""==a.trim()?$("#dlg_add_item_item_name").find('input[name="itemname"]').focus():(d.text=a,d.value=c,e.close())}})),a.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){e.close()}})),b='<div style="display: block" class="p10"><div>',b+='<table border = "0" cellspacing = "1" cellpadding = "0" >',
b+="<tr>",b+='<td class="newLabel" nowrap="">'+MyLang.getMsg("LBL_LIST_ITEM_DISPLAY_VALUE")+"</td>",b+='<td width="200">',b+='<input type="text" id="dlg_add_item_item_name" name="itemname" class="textField p5" value="'+d.text+'">',b+="</td></tr>",b+="<tr>",b+='<td class="newLabel" nowrap="">'+MyLang.getMsg("LBL_LIST_ITEM_SUBMIT_VALUE")+"</td>",b+='<td width="200">',b+='<input type="text" id="dlg_add_item_item_value" name="itemvalue" class="textField p5" value="'+d.value+'">',b+="</td></tr>",b+="</table>",
b+="</div>",b+="</div>",e=new Ext.Window({id:"dlg_edit_item",title:MyLang.getMsg("TITLE_LIST_ITEM"),layout:"fit",width:450,height:200,closeAction:"hide",plain:!0,modal:!0,items:new Ext.Panel({border:!1,autoScroll:!0,html:b}),buttons:a,listeners:{afterRender:function(){PopupToolsCtr.setEventHelpCtr()},hide:function(a){(a=Ext.getCmp(a.id))&&a.close()}}}));e.show()}else Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_RAIDO_ITEM_SELECT"),buttons:Ext.Msg.OK})},deleteItem:function(a){a=$(a).attr("parentid");
"undefined"==a&&(a=PopupToolsCtr.elm[0].id);var b=$("#"+a).find('select[name="fldItems"]');(a=b.val())&&$.each(a,function(){b.find("option[value='"+this+"']").remove()})},getFieldValue:function(a,b){var d="";null!=a&&a.config.attributes[b]&&(d=a.config.attributes[b]);return d},createHtmlSerialNumber:function(a){var b="";if("serial_number"==a.map_type_control||"serial_number"==a.tag)b+='<div id="serial_number_setting"><table border = "0" cellspacing = "1" cellpadding = "0" >',b+="<tr>",b+='<td class="newLabel w120" nowrap="">'+
MyLang.getMsg("LBL_TITLE")+"</td>",b+='<td width="150">',b+='<input type="text" name="serialNumberCustomName" class="textField p5" value="">',b+="</td>",b+='<td><p class="description">',b+=MyLang.getMsg("LBL_SERIAL_TITLE"),b+="</p></td>",b+="</tr>",b+="<tr>",b+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_DISPLAY_DIRECTION")+"</td>",b+='<td width="150">',b+='<div class="newSelect p5" style="margin-bottom: 5px;width: 125px;">',b+='<select name="serialNumberDirection" class="p5">',b+='<option value="horizontal" selected>'+
MyLang.getMsg("LBL_HORIZONTAL_DIRECTION")+"</option>",b+='<option value="vertical">'+MyLang.getMsg("LBL_VERTICAL_DIRECTION")+"</option>",b+="</select>",b+="</div>",b+="</td>",b+="</tr>",b+="<tr>",b+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_NUMBER_COPY")+"</td>",b+='<td width="150">',b+='<input type="number" name="serialNumberLength" class="textField p5" style="width: 50px;" disabled value="1">',b+="</td>",b+="<td>",b+='<p class="description">'+MyLang.getMsg("LBL_NUMBER_COPY_EXP")+
"</p>",b+="</td>",b+="</tr>",b+="<tr>",b+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_STYLE")+"</td>",b+='<td width="150">',b+='<input type="text" name="serialNumberStyle" class="textField p5" value="">',b+="</td>",b+="<td>",b+='<table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td>',b+='<div class="help_ctr"></div>',b+='<p style="display: none;" class="description2">'+MyLang.getMsg("LBL_STYLE_SAMPLE_EXP")+"</p>",b+="</td><td>",b+="</td></tr></tbody></table>",b+="</td>",
b+="</tr>",b+="<tr>",b+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_SATERAITO_CLASS")+"</td>",b+='<td width="150">',b+='<input type="text" name="serialNumberClassName" class="textField p5" value="detail_name arrowRight">',b+="</td>",b+="<td>",b+='<table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td>',b+='<div class="help_ctr"></div>',b+='<div style="display: none;" class="description2">'+MyLang.getMsg("LBL_SATERAITO_CLASS_EXP")+"</div>",b+="</td><td>",b+='<p class="description">'+
MyLang.getMsg("LBL_SATERAITO_CLASS_EXP_2")+"</p>",b+="</td></tr></tbody></table>",b+="</td>",b+="</tr>",b+="</table>",b+="</div>";return b},changeContentColor:function(a){$(a).next().next().css("color",$(a).val())},changeContentBold:function(a){$(a).next().css("fontWeight",!0==$(a).is(":checked")?"bold":"normal")},createHtmlCfgNewField:function(a,b,d,e){"undefined"==typeof d&&(d="");"undefined"==typeof e&&(e=PopupToolsCtr.elm.id);var f=Controller.MapType[b].config.settingfields,c="";if(f.lblname&&
!0==f.lblname){c+='<div><table border = "0" cellspacing = "1" cellpadding = "0" >';c+="<tr>";c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_TITLE")+"</td>";c+='<td width="150">';c+="<table><tr><td>";c+='<input type="text" name="fldLabel" style="margin-left: -2px" class="textField p5" value="';if("radio"==b&&"radiogroup"==d)c+=PopupToolsCtr.getFieldValue(a,"lblname");else if("checkbox"==b&&"checkboxgroup"==d)c+=PopupToolsCtr.getFieldValue(a,"lblname");else if("boxgroup"==b||"boxgroup"!=
d)c+=PopupToolsCtr.getFieldValue(a,"lblname");c+='">';c+="</td>";if(f.widthlbl&&!0==f.widthlbl){c+="<td>";c+="<span> "+MyLang.getMsg("LBL_ITEM_WIDTH")+"</span>";c+="</td><td>";c+='<input type="text" style="width:35px " name="fldWidthLabel" class="textField p5" value="';if("radio"==b&&"radiogroup"==d)c+=PopupToolsCtr.getFieldValue(a,"widthlbl");else if("checkbox"==b&&"checkboxgroup"==d)c+=PopupToolsCtr.getFieldValue(a,"widthlbl");else if("boxgroup"==b||"boxgroup"!=d)c+=PopupToolsCtr.getFieldValue(a,
"widthlbl");c+='"></td>'}c+="</tr></table>";c+="</td>";c+="<td>";f.showlblname&&!0==f.showlblname&&(c+='<label class="newlabel" style="margin-left: 5px;">',c=!a||void 0!=a.config.attributes.showlblname&&"undefined"!=typeof a.config.attributes.showlblname&&"true"!=a.config.attributes.showlblname&&!0!=a.config.attributes.showlblname?c+'<input type="checkbox" name="fldShowLabel" class="p5">':c+'<input type="checkbox" name="fldShowLabel" class="p5" checked>',c+='<span style="position: relative;top: -3px;">'+
MyLang.getMsg("LBL_ITEM_NAME_DISPLAY")+"</span></label>");c+="</td>";c+="</tr>";c+="</table>";c+="</div>"}"radio"==b&&"radiogroup"==d||"checkbox"==b&&"checkboxgroup"==d||!f.name||!0!=f.name||(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("MSG_ITEM_NAME")+"</td>",c+='<td width="150">',c="boxgroup"!=b&&"boxgroup"==d?c+'<input type="text" name="fldName" class="textField p5">':c+('<input type="text" name="fldName" class="textField p5" value="'+
PopupToolsCtr.getFieldValue(a,"name")+'">'),c+='</td><td><p class="description">'+MyLang.getMsg("NAME_DESC")+"</p>",c+="</td></tr>",c+="</table>",c+="</div>");if(!0!=PopupToolsCtr.isEdit){for(var c="radio"==b&&"radiogroup"==d||"boxgroup"==d?c+'<div style="display: none">':"checkbox"==b&&"checkboxgroup"==d||"boxgroup"==d?c+'<div style="display: none">':c+"<div>",c=c+'<table border = "0" cellspacing = "1" cellpadding = "0" >',c=c+"<tr>",c=c+('<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_SECTION")+
"</td>"),c=c+'<td width="100">',c=c+'<div class="newSelect p5" style="margin-bottom: 5px;width: 100px;">',c=c+'<select name="sections">',g=TemplateList.getTemplateDetail(MainLayout.elmTemplateList.val()),h=0;h<g.sections.length;h++)var l=g.sections[h],c=c+('<option value="'+l.section_id+'">'+l.secname+"</option>");c+="</select>";c+="</div>";c+="</td>";c+="<td>";c+=MyLang.getMsg("LBL_ITEM_SECTION_COLUMN");c+="</td>";c+="<td>";c+='<div class="newSelect p5" style="margin-bottom: 5px;width: 50px;">';
c+='<select name="column_section">';c+="</select>";c+="</div>";c+="</td>";c+="</tr>";c+="</table>";c+="</div>"}"radio"==b&&"radiogroup"==d||"checkbox"==b&&"checkboxgroup"==d||!f.style||!0!=f.style||(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_STYLE")+"</td>",c+='<td width="150">',c+='<input type="text" name="fldStyle" class="textField p5" value="',c+=PopupToolsCtr.getFieldValue(a,"style"),c+=
'">',c+="</td>",c+="<td>",c+='<table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td>',c+='<div class="help_ctr"></div>',c+='<p style="display: none;" class="description2">'+MyLang.getMsg("LBL_STYLE_SAMPLE_EXP")+"</p>",c+="</td><td>",c+="</td></tr></tbody></table>",c+="</td>",c+="</tr>",c+="</table>",c+="</div>");f.class&&!0==f.class&&(c+='<div id="classNameDetails">',c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_SATERAITO_CLASS")+
"</td>",c+='<td width="150">',c+='<input type="text" name="fldClassName" class="textField p5" value="'+PopupToolsCtr.getFieldValue(a,"class")+'"></td>',c+="<td>",c+='<table border = "0" cellspacing = "0" cellpadding = "0" ><tr><td>',c+='<div class="help_ctr"></div>',c+='<div style="display: none;" class="description2">'+MyLang.getMsg("LBL_SATERAITO_CLASS_EXP")+"</div>",c+="</td>",c+="<td>",c+='<p class="description">'+MyLang.getMsg("LBL_SATERAITO_CLASS_EXP_2")+"</p>",c+="</td></tr></table>",c+="</td></tr>",
c+="</table>",c+="</div>");f.new_attrs&&!0==f.new_attrs&&(c+='<div id="classNameDetails">',c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_SATERAITO_ATTRS")+"</td>",c+='<td width="150">',c+='<textarea class="textField" rows="2" cols="1"  style="width: 230px;resize:both;" name="fldNewAttributes">'+escapeHtml(unescapeAndDecodeHtml(PopupToolsCtr.getFieldValue(a,"new_attrs")))+"</textarea></td>",c+="<td>",c+='<table border = "0" cellspacing = "0" cellpadding = "0" ><tr><td>',
c+='<div class="help_ctr"></div>',c+='<div style="display: none;" class="description2"><p>'+MyLang.getMsg("LBL_SATERAITO_ATTRS_EXP")+"</p></div>",c+="</td>",c+="<td>",c+='<p class="description">'+MyLang.getMsg("LBL_SATERAITO_CLASS_EXP_2")+"</p>",c+="</td></tr></table>",c+="</td></tr>",c+="</table>",c+="</div>");"radio"==b&&"radiogroup"==d||"checkbox"==b&&"checkboxgroup"==d||!f.html||!0!=f.html||(c+='<div">',c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+
MyLang.getMsg("LBL_HTML_CODE")+"</td>",c+='<td width="150">',c+='<textarea rows="3" cols="1" name="fldHtml" class="textField p5" style="width: 230px;height: 100px;resize:both;" >',a&&(c+=void 0==a.config.html?"":escapeHtml(unescapeAndDecodeHtml(a.config.html))),c+="</textarea>",c+="</td>",c+="</tr>",c+="</table>",c+="</div>");f.rbgdirection&&!0==f.rbgdirection&&(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_DISPLAY_DIRECTION")+
"</td>",c+='<td width="150">',c+='<div class="newSelect p5" style="margin-bottom: 5px;width: 125px;">',null!=a?(c+='<select name="rbGroupDirection" class="p5">',"undefined"==typeof a.config.attributes.rbgdirection&&(a.config.attributes.rbgdirection="horizontal"),"horizontal"==a.config.attributes.rbgdirection?(c+='<option value="horizontal" selected>'+MyLang.getMsg("LBL_HORIZONTAL_DIRECTION")+"</option>",c+='<option value="vertical">'+MyLang.getMsg("LBL_VERTICAL_DIRECTION")+"</option>"):(c+='<option value="horizontal">'+
MyLang.getMsg("LBL_HORIZONTAL_DIRECTION")+"</option>",c+='<option value="vertical" selected>'+MyLang.getMsg("LBL_VERTICAL_DIRECTION")+"</option>"),c+="</select>"):c+='<select name="rbGroupDirection" class="p5"><option value="horizontal" selected>'+MyLang.getMsg("LBL_HORIZONTAL_DIRECTION")+'</option><option value="vertical">'+MyLang.getMsg("LBL_VERTICAL_DIRECTION")+"</option></select>",c+="</div>",c+="</td>",c+="</tr>",c+="</table>",c+="</div>");if(f.rbgitems&&!0==f.rbgitems&&"radiogroup"==b){c+="<div>";
c+='<table border = "0" cellspacing = "1" cellpadding = "0" >';c+="<tr>";c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_LIST_RADIO_BTN")+"</td>";c+='<td width="150">';if(null!=a){c+='<select name="fldItemsGroup" class="p5" style="margin-bottom: 5px;margin-right: 5px;height: 80px;width: 156px" multiple>';for(h=0;h<a.config.items.length;h++)g=a.config.items[h],(l=g.config.attributes.lblname)&&""==l.toString().trim()&&(l=g.config.attributes.name),c+='<option value="'+h+'">'+l+"</option>";
c+="</select>"}else c+='<select name="fldItemsGroup" class="p5" style="margin-left: 0px;margin-right: 5px;height: 50px;width: 156px" multiple></select>';c+="</td>";c+='<td style="vertical-align: middle">';c+='<input onclick="PopupToolsCtr.addItemsGroup(this);" type="button" name="fldItemsGroupAdd" class="newgraybtn w40" value="'+MyLang.getMsg("BTN_ADD")+'"/>';c+='<input onclick="PopupToolsCtr.editItemsGroup(this);" type="button" name="fldItemsGroupEdit" class="newgraybtn w40" value="'+MyLang.getMsg("BTN_EDIT")+
'"/>';c+='<input onclick="PopupToolsCtr.deleteItemGroup(this);" type="button" name="fldItemsGroupDel" class="newgraybtn w40" value="'+MyLang.getMsg("BTN_DELETE")+'"/>';c+="</td>";c+="</tr>";c+="</table>";c+="</div>"}if(f.rbgitems&&!0==f.rbgitems&&"checkboxgroup"==b){c+="<div>";c+='<table border = "0" cellspacing = "1" cellpadding = "0" >';c+="<tr>";c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_LIST_CHECKBOX_BTN")+"</td>";c+='<td width="150">';if(null!=a){c+='<select name="fldItemsGroup" class="p5" style="margin-bottom: 5px;margin-right: 5px;height: 80px;width: 156px" multiple>';
for(h=0;h<a.config.items.length;h++)g=a.config.items[h],(l=g.config.attributes.lblname)&&""==l.toString().trim()&&(l=g.config.attributes.name),c+='<option value="'+h+'">'+l+"</option>";c+="</select>"}else c+='<select name="fldItemsGroup" class="p5" style="margin-left: 0px;margin-right: 5px;height: 50px;width: 156px" multiple></select>';c+="</td>";c+='<td style="vertical-align: middle">';c+='<input onclick="PopupToolsCtr.addItemsGroupCheckbox(this);" type="button" name="fldItemsGroupAdd" class="newgraybtn w40" value="'+
MyLang.getMsg("BTN_ADD")+'"/>';c+='<input onclick="PopupToolsCtr.editItemsGroupCheckbox(this);" type="button" name="fldItemsGroupEdit" class="newgraybtn w40" value="'+MyLang.getMsg("BTN_EDIT")+'"/>';c+='<input onclick="PopupToolsCtr.deleteItemGroupCheckbox(this);" type="button" name="fldItemsGroupDel" class="newgraybtn w40" value="'+MyLang.getMsg("BTN_DELETE")+'"/>';c+="</td>";c+="</tr>";c+="</table>";c+="</div>"}f.bgdirection&&!0==f.bgdirection&&(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',
c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_DISPLAY_DIRECTION")+"</td>",c+='<td width="150">',c+='<div class="newSelect p5" style="margin-bottom: 5px;width: 125px;">',null!=a?(c+='<select name="boxGroupDirection" class="p5">',"undefined"==typeof a.config.attributes.bgdirection&&(a.config.attributes.bgdirection="horizontal"),"horizontal"==a.config.attributes.bgdirection?(c+='<option value="horizontal" selected>'+MyLang.getMsg("LBL_HORIZONTAL_DIRECTION")+"</option>",c+='<option value="vertical">'+
MyLang.getMsg("LBL_VERTICAL_DIRECTION")+"</option>"):(c+='<option value="horizontal">'+MyLang.getMsg("LBL_HORIZONTAL_DIRECTION")+"</option>",c+='<option value="vertical" selected>'+MyLang.getMsg("LBL_VERTICAL_DIRECTION")+"</option>"),c+="</select>"):c+='<select name="boxGroupDirection" class="p5"><option value="horizontal" selected>'+MyLang.getMsg("LBL_HORIZONTAL_DIRECTION")+'</option><option value="vertical">'+MyLang.getMsg("LBL_VERTICAL_DIRECTION")+"</option></select>",c+="</div>",c+="</td>",c+=
"</tr>",c+="</table>",c+="</div>");if(f.bgitems&&!0==f.bgitems){c+="<div>";c+='<table border = "0" cellspacing = "1" cellpadding = "0" >';c+="<tr>";c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_GROUP_HTML_ITEM")+"</td>";c+='<td width="150">';if(null!=a){c+='<select name="fldBoxItemsGroup" class="p5" style="margin-bottom: 5px;margin-right: 5px;height: 80px;width: 156px" multiple>';for(h=0;h<a.config.items.length;h++)g=a.config.items[h],(l=g.config.attributes.lblname)&&""==l.toString().trim()&&
(l=g.config.attributes.name),c+='<option value="'+h+'">'+l+"</option>";c+="</select>"}else c+='<select name="fldBoxItemsGroup" class="p5" style="margin-left: 0px;margin-right: 5px;height: 50px;width: 156px" multiple></select>';c+="</td>";c+='<td style="vertical-align: middle">';c+='<input onclick="PopupToolsCtr.addBoxItemsGroup(this);" type="button" name="fldItemsGroupAdd" class="newgraybtn w40" value="'+MyLang.getMsg("BTN_ADD")+'"/>';c+='<input onclick="PopupToolsCtr.editBoxItemsGroup(this);" type="button" name="fldItemsGroupEdit" class="newgraybtn w40" value="'+
MyLang.getMsg("BTN_EDIT")+'"/>';c+='<input onclick="PopupToolsCtr.deleteBoxItemGroup(this);" type="button" name="fldItemsGroupDel" class="newgraybtn w40" value="'+MyLang.getMsg("BTN_DELETE")+'"/>';c+="</td>";c+="</tr>";c+="</table>";c+="</div>"}if(f.items&&!0==f.items){c+="<div>";c+='<table border = "0" cellspacing = "1" cellpadding = "0" >';c+="<tr>";c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_GROUP_HTML_ITEM")+"</td>";c+='<td width="150">';if(null!=a){c+='<select name="fldItems" class="p5" style="margin-bottom: 5px;margin-right: 5px;height: 80px;width: 156px" multiple>';
if("select"!=b||"boxgroup"!=d)for(h=0;h<a.config.items.length;h++)g=a.config.items[h],c+='<option value="'+g.value+'">'+g.text+"</option>";c+="</select>"}else c+='<select name="fldItems" class="p5" style="margin-left: 0px;margin-right: 5px;height: 50px;width: 156px" multiple></select>';c+="</td>";c+='<td style="vertical-align: middle">';c+='<input onclick="PopupToolsCtr.addItem(this);" parentid="'+e+'" type="button" name="fldItems+" class="newgraybtn w40" value="'+MyLang.getMsg("BTN_ADD")+'"/>';c+=
'<input onclick="PopupToolsCtr.editItem(this);" parentid="'+e+'" type="button" name="fldItemsEdit" class="newgraybtn w40" value="'+MyLang.getMsg("BTN_EDIT")+'"/>';c+='<input onclick="PopupToolsCtr.deleteItem(this);" parentid="'+e+'" type="button" name="fldItems-" class="newgraybtn w40" value="'+MyLang.getMsg("BTN_DELETE")+'"/>';c+="</td>";c+="</tr>";c+="</table>";c+="</div>"}f.value&&!0==f.value&&(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+
MyLang.getMsg("LBL_ITEM_INIT_VALUE")+"</td>",c+='<td width="150">',c="textarea"==a.map_type_control||"textarea"==a.tag?c+('<textarea type="text" name="fldValue" class="p5" cols="1" rows="3" style="width: 230px;height: 100px;resize:both;" >'+escapeHtml(unescapeAndDecodeHtml(PopupToolsCtr.getFieldValue(a,"value")))+"</textarea></td>"):c+('<input type="text" name="fldValue" class="textField p5" value="'+PopupToolsCtr.getFieldValue(a,"value")+'"></td>'),c+="</tr>",c+="</table>",c+="</div>");f.maxlength&&
!0==f.maxlength&&(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_LENGTH")+"</td>",c+='<td width="150">',c+='<input type="number" name="fldMaxLength" class="textField p5" value="'+PopupToolsCtr.getFieldValue(a,"maxlength")+'"></td>',c+='<td><p class="description">'+MyLang.getMsg("LBL_ITEM_LENGTH_EXP")+"</p></td>",c+="</tr>",c+="</table>",c+="</div>");f.cols&&!0==f.cols&&(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',
c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_NUMBER_CHARS")+"</td>",c+='<td width="150">',c+='<input type="number" name="fldCols" class="textField p5" value="'+PopupToolsCtr.getFieldValue(a,"cols")+'"></td>',c+='<td><p class="description">'+MyLang.getMsg("LBL_ITEM_NUMBER_CHARS_EXP")+"</p></td>",c+="</tr>",c+="</table>",c+="</div>");f.rows&&!0==f.rows&&(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+
MyLang.getMsg("LBL_ITEM_NUMBER_LINES")+"</td>",c+='<td width="150">',c+='<input type="number" name="fldRows" class="textField p5" value="'+PopupToolsCtr.getFieldValue(a,"rows")+'"></td>',c+='<td><p class="description">'+MyLang.getMsg("LBL_ITEM_LENGTH_EXP")+"</p></td>",c+="</tr>",c+="</table>",c+="</div>");f.readOnly&&!0==f.readOnly&&(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_READONLY")+"</td>",
c+='<td width="150">',c=null!=a&&"readOnly"==a.config.attributes.readOnly?c+'<input type="checkbox" name="fldReadOnly" class="p5" checked>':c+'<input type="checkbox" name="fldReadOnly" class="p5">',c+='&nbsp;&nbsp;&nbsp;<span class="description">'+MyLang.getMsg("LBL_ITEM_READONLY_EXP")+"</span>",c+="</td></tr>",c+="</table>",c+="</div>");f.disabled&&!0==f.disabled&&(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_DISABLE")+
"</td>",c+='<td width="150">',c=null!=a&&"disabled"==a.config.attributes.disabled?c+'<input type="checkbox" name="fldDisabled" class="p5" checked>':c+'<input type="checkbox" name="fldDisabled" class="p5">',c+='&nbsp;&nbsp;&nbsp;<span class="description">'+MyLang.getMsg("LBL_ITEM_DISABLE_EXP")+"</span>",c+="</td></tr>",c+="</table>",c+="</div>");f.checked&&!0==f.checked&&(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_CHEKED_ON")+
"</td>",c+='<td width="150">',c=null!=a&&"checked"==a.config.attributes.checked?c+'<input type="checkbox" name="fldChecked" class="p5" checked></td>':c+'<input type="checkbox" name="fldChecked" class="p5"></td>',c+="</tr>",c+="</table>",c+="</div>");f.multiple&&!0==f.multiple&&(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_MULTI_SELECT")+"</td>",c+='<td width="150">',c=null!=a&&"multiple"==a.config.attributes.multiple?
c+'<input type="checkbox" name="fldMultiple" class="p5" checked></td>':c+'<input type="checkbox" name="fldMultiple" class="p5"></td>',c+="</tr>",c+="</table>",c+="</div>");"radio"==b&&"radiogroup"==d||"checkbox"==b&&"checkboxgroup"==d||!f.beforecontent||!0!=f.beforecontent||(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_BEFORE_EXP")+"</td>",c+='<td width="150">',c+='<input type="text" name="fldBeforeContent" class="textField p5" value="',
c+=PopupToolsCtr.getFieldValue(a,"beforecontent"),c+='">',c+="</td>",e=PopupToolsCtr.getFieldValue(a,"beforecontentcolor"),h=PopupToolsCtr.getFieldValue(a,"beforecontentbold"),c+="<td>",c+='<input onchange="PopupToolsCtr.changeContentColor(this);" type="color" name="fldBeforeContentColor" class="fldBeforeContentColor mgl5" value="'+e+'">',c+='<input onchange="PopupToolsCtr.changeContentBold(this);" type="checkbox" name="fldBeforeContentBold" class="fldBeforeContentBold mgl5" ',"bold"==h&&(c+="checked"),
c+=">",c+='<span class="fldBeforeContentSample mgl5" style="color:'+e+";font-weight:"+h+'">'+MyLang.getMsg("LBL_ITEM_BOLDER_ON")+"</span>",c+="</td>",c+="</tr>",c+="</table>",c+="</div>");"radio"==b&&"radiogroup"==d||"checkbox"==b&&"checkboxgroup"==d||!f.aftercontent||!0!=f.aftercontent||(c+="<div>",c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_AFFTER_EXP")+"</td>",c+='<td width="150">',c+='<input type="text" name="fldAfterContent" class="textField p5" value="',
c+=PopupToolsCtr.getFieldValue(a,"aftercontent"),c+='">',c+="</td>",e=PopupToolsCtr.getFieldValue(a,"aftercontentcolor"),h=PopupToolsCtr.getFieldValue(a,"aftercontentbold"),c+="<td>",c+='<input onchange="PopupToolsCtr.changeContentColor(this);" type="color" name="fldAfterContentColor" class="fldAfterContentColor mgl5" value="'+e+'">',c+='<input onchange="PopupToolsCtr.changeContentBold(this);" type="checkbox" name="fldAfterContentBold" class="fldAfterContentBold mgl5" ',"bold"==h&&(c+="checked"),
c+=">",c+='<span class="fldAfterContentSample mgl5" style="color:'+e+";font-weight:"+h+'">'+MyLang.getMsg("LBL_ITEM_BOLDER_ON")+"</span>",c+="</td>",c+="</tr>",c+="</table>",c+="</div>");!0==PopupToolsCtr.isEdit||"grid"===b||"radio"==b&&"radiogroup"==d||"checkbox"==b&&"checkboxgroup"==d||"boxgroup"!=b&&"boxgroup"==d||"serial_number"==a.map_type_control||"serial_number"==a.tag||(c+='<div">',c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+
MyLang.getMsg("LBL_ITEM_MULTI_COPY")+"</td>",c+='<td width="150">',c+='<input type="number" name="fldNumberControl" class="textField p5" style="width: 50px;" value="',c+=PopupToolsCtr.number_control,c+='"></td>',c+="</td>",c+="</tr>",c+="</table>",c+="</div>");!0!=PopupToolsCtr.isEdit&&"grid"===b&&(b=1,a&&a.config&&"undefined"!=typeof a.config.attributes.max_col&&(b=a.config.attributes.max_col),f.max_row&&(c+='<div">',c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+
MyLang.getMsg("LBL_ITEM_MAX_ROW")+"</td>",c+='<td width="150">',c+='<input type="number" name="fldMaxRow" class="textField p5" style="width: 50px;" value="',c+=b,c+='"></td>',c+="</td>",c+="</tr>",c+="</table>",c+="</div>"),f.max_col&&(c+='<div">',c+='<table border = "0" cellspacing = "1" cellpadding = "0" >',c+="<tr>",c+='<td class="newLabel w120" nowrap="">'+MyLang.getMsg("LBL_ITEM_MAX_COL")+"</td>",c+='<td width="150">',c+='<input type="number" name="fldMaxCol" class="textField p5" style="width: 50px;" value="',
c+=b,c+='"></td>',c+="</td>",c+="</tr>",c+="</table>",c+="</div>"));return c+=PopupToolsCtr.createHtmlSerialNumber(a)},createHtmlListDefaultFields:function(a){var b=!1;"undefined"!=typeof a&&(b=!0);var d;d='<table class="tblFieldType" width="100%" border="0" cellspacing="3" cellpadding="0">';for(var e in Controller.MapType)if(!0==Controller.MapType[e].show){var f;if(f=!0==b){a:{for(f=0;f<a.length;f++)if(e==a[f]){f=!0;break a}f=!1}f=!1==f}f||(d+="<tr>",d+='<td width="16">',d+='<img width="20" height="20" src="'+
Controller.MapType[e].iconUrl+'" />',d+="</td>",d+='<td class="fieldType" map_type="'+e+'">',d+=Controller.MapType[e].label,d+="</td>",d+="</tr>")}return d+"</table>"},createEditCtrHtml:function(a){var b;b='<div class="p5"><form name="CustomFieldForm" method="post">';b+='<table width="100%" border="0" cellspacing="10" cellpadding="0">';b+="<tbody>";b+="<tr>";b+='<td class="f17">'+a+MyLang.getMsg("MSG_ITEM_SET_ATTRS")+"</td>";b+="</tr>";b+="<tr>";b+='<td valign="top" width="65%">';b+='<div id="new_cf_field"></div>';
b+="</td>";b+="</tr>";b+="</tbody>";b+="</table>";b+="</form>";b+="</div>";a=document.createElement("div");a.innerHTML=b;return a},createCustomFieldHtml:function(a,b){"undefined"==typeof a&&(a="new_cf_field");var d;d='<div class="p5"><form name="CustomFieldForm" method="post">';d+='<table width="100%" border="0" cellspacing="10" cellpadding="0">';d+="<tbody>";d+="<tr>";d+='<td width="200" class="f11b">'+MyLang.getMsg("MSG_ITEM_TYPE_SELECT")+" </td>";d+='<td class="f11b">'+MyLang.getMsg("MSG_ITEM_SET_ATTRS")+
"</td>";d+="</tr>";d+="<tr>";d+='<td height="300" valign="top" width="21%">';d+=PopupToolsCtr.createHtmlListDefaultFields(b);d+="</td>";d+='<td valign="top" width="69%">';d+='<div id="'+a+'"></div>';d+="</td>";d+="</tr>";d+="</tbody>";d+="</table>";d+="</form>";d+="</div>";var e=document.createElement("div");e.innerHTML=d;return e}};TabOne={create:function(a){a='<div id="tabs-1"><div id="template_body_html_builder_result" style="display: none;"></div>';a+='<div id="result" class="p10 bgWhite">';a+=
'<div class="p0">';a+='<div class="content">'+MyLang.getMsg("MSG_EDITOR_TAB_EXP");a+="</div>";a+="<div><br>";a+='<table cellpadding="5" cellspacing="0">';a+="<tbody>";a+="<tr>";a+="<td>";a+='<div class="newSelect" style="display: none">';a+='<select id="templatelist">';a+="</select>";a+="</div>";a+="</td>";a+='<td class="alignright pL10">';a+='<input type="button" class="newgraybtn" value="'+MyLang.getMsg("BTN_SECTION_ADD_NEW")+' " onclick="MainLayout.getSecDetails()"></td>';a+='<td class="alignright">';
a+='<input type="button" class="newgraybtn" value="'+MyLang.getMsg("LBL_ITEM_ADD_NEW")+' " onclick="MainLayout.showCreateNewCF();">';a+="</td>";a+="</tr>";a+="</tbody>";a+="</table><br>";a+='<div id="layoutMain" class="pwie">';a+='<div class="pwie">';a+='<table width="100%" cellpadding="10" cellspacing="0">';a+="<tbody>";a+="<tr>";a+='<td valign="top" style="min-width: 70%;">';a+='<div id="mainMatrix" class="ui-sortable">';a+="</div>";a+='<div id="sateraito_form_script_render">';a+="</div>";a+='<div class="clearL"></div>';
a+="</td>";a+="\x3c!-- trash --\x3e";a+='<td valign="top" width="30%">';a+='<table id="main_sortable_trash" width="100%" cellspacing="0" style="margin-left: 5px;">';a+='<tr><td class="infoHdrBlk x-panel-header x-unselectable" style="cursor: default">';a+='<b class="floatL" style="padding-right:10px;">'+MyLang.getMsg("MSG_EDITOR_NOT_DISPLAY_LIST")+"</b>";a+='<img style="float:right;" class="infoHdrDelIc pointer" onclick="MainLayout.deleteForeverTrash(this)" src="'+BASE_URL+'/images/icons/spacer.gif" alt="'+
MyLang.getMsg("MSG_ITEM_DELETE_PERMANET")+'" title="'+MyLang.getMsg("MSG_ITEM_DELETE_PERMANET")+'">';a+="</td></tr>";a+='<tr><td style="border: 1px solid #8db2e3;border-top: none;-webkit-box-shadow: 1px 2px 3px #f5f5f5;-moz-box-shadow: 1px 2px 3px #f5f5f5;-o-box-shadow: 1px 2px 3px #f5f5f5;box-shadow: 1px 2px 3px #f5f5f5;">';a+='<div id="sortable_trash" class="unwantCntBlk droptrue"></div>';a+="</div>";a+="</td></tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</tbody>";a+="</table>";a+="</div>";a+=
'<div class="clearL"></div><br>';a+='<table cellspacing="10" width="100%" cellpadding="0" class="buttonLayer">';a+="<tbody>";a+="<tr>";a+='<td style="min-width:350px;">';a+='<input onclick="ViewSource.beforePostMessage()" type="button" class="newgraybtn" value="'+MyLang.getMsg("BTN_EDITOR_COMPLETE")+'"> &nbsp;';a+='<input onclick="MainLayout.saveTemplate()" type="button"  class="newgraybtn" value="'+MyLang.getMsg("BTN_EDITOR_PRIVEW")+'"> &nbsp;';a+='<input onclick="MainLayout.nextTab(\'2\');" type="button"  class="newgraybtn" value="'+
MyLang.getMsg("BTN_EDITOR_HTML_CONFIRM")+'"> &nbsp;';a+="</td>";a+='<td class="alignright pL10">';a+='<div class="newSelect" style="display: block">';a+='  <select id="op_default_template_list">';a+="  </select>";a+="</div>";a+="</td>";a+='<td class="alignleft pL10">';a+='<input id="update_c_t" onclick="MyPanel.runUpdateCurrentTemplate(this)" type="button" class="newgraybtn update_c_t" value="'+MyLang.getMsg("RUN_UPDATE_CURRENT_TEMPLATE")+'"> &nbsp;';a+="</td>";a+='<td class="alignleft pL10">';a+=
'<input id="load_s_t" onclick="MyPanel.runLoadSectionTemplate(this)" type="button" class="newgraybtn update_c_t" value="'+MyLang.getMsg("RUN_LOAD_SECTION_TEMPLATE")+'"> &nbsp;';a+="</td>";a+="</tr>";a+="</tr>";a+="<tr>";a+='<td><span style="color: red;">'+MyLang.getMsg("MSG_EDITOR_COMPLETE_EXP")+"</span>";a+="</td>";a+="</tr>";a+="</tbody>";a+="</table>";a+="<br></div>";a+="</div>";a+="</div>";a+="</div>";a+="</div>";a=new Ext.Panel({frame:!1,border:!1,margins:{top:0,right:5,bottom:0,left:5},html:a,
autoScroll:!0});return new Ext.Panel({layout:"fit",frame:!1,border:!1,items:[a],height:460,listeners:{afterrender:function(){(function(){MainLayout.init();$($("#tabs-1")[0].parentNode).scroll(function(){$("#main_sortable_trash").css({position:"relative",top:$(this).scrollTop()})})}).defer(10)}}})}};TabTwo={create:function(a){a='<div id="tabs-2"><div id="template_body" class="main_body" style="font-size:13px;padding:0px;">';a+='<div class="document_back">';a+='<div class="document_body">';a+='<table border="0" cellpadding="0" cellspacing="0" class="title_table" style="width:100%;">';
a+='<tr background="'+SATERAITO_MY_SITE_URL+'/images/header_bga02.gif" style="background-repeat: no-repeat;">';a+='<td width="49" height="40">';a+='<img src="'+SATERAITO_MY_SITE_URL+'/images/header_marka.gif" border="0" style="background-repeat: no-repeat;"></td>';a+='<td background="'+SATERAITO_MY_SITE_URL+'/images/header_bga01.gif" class="header_bga01" nowrap height="40"  style="background-repeat: repeat-x;">';a+='<font size="4" color="#ffffff" face="\u30e1\u30a4\u30ea\u30aa,Meiryo,Hiragino Kaku Gothic Pro,\u30d2\u30e9\u30ae\u30ce\u89d2\u30b4 Pro W3,\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af">';
a+='<b class="template_name">'+$("#template_name").val()+"</b></font>";a+="</td>";a+='<td background="'+SATERAITO_MY_SITE_URL+'/images/header_bga02.gif" width="6" height="40" style="background-repeat: no-repeat;"></td>';a+="</tr>";a+="</table>";a+='<div class="p10 bgWhite">';a+='<div class="content">';a+="</div>";a+="<div>";a+='<table cellpadding="5" cellspacing="0">';a+="<tbody>";a+="<tr>";a+="<td>";a+='<div class="newSelect" style="display: none">';a+="</div>";a+="</td>";a+='<td class="alignright pL10">';
a+="</td>";a+="</tr>";a+="</tbody>";a+="</table>";a+='<div id="form_panel_renderResult_render"></div>';a+="</div>";a+='<div id="resultHtml" style="display: none"></div>';a+="</div>";a+="</div>";a+="</div>";a+='<div class="clearL"></div><br>';a+='<table cellspacing="10" width="100%" cellpadding="0" class="buttonLayer">';a+="<tbody>";a+="<tr>";a+="<td>";a+='<input onclick="ViewSource.beforePostMessage()" type="button" class="newgraybtn" value="'+MyLang.getMsg("BTN_EDITOR_COMPLETE")+'"> &nbsp;';a+='<input onclick="MainLayout.nextTab(\'0\');"  type="button" class="newgraybtn" value="'+
MyLang.getMsg("BTN_EDITOR_BACK")+'"> &nbsp;';a+='<input onclick="MainLayout.nextTab(\'2\');" type="button" class="newgraybtn" value="'+MyLang.getMsg("BTN_EDITOR_HTML_CONFIRM")+'"> &nbsp;';a+="</td>";a+="</tr>";a+="</tr>";a+="<tr>";a+='<td><span style="color: red;">'+MyLang.getMsg("MSG_EDITOR_COMPLETE_EXP")+"</span>";a+="</td>";a+="</tr>";a+="</tbody>";a+="</table>";a+="<br>";a+="</div>";a=new Ext.Panel({frame:!1,border:!1,margins:{top:0,right:5,bottom:0,left:5},html:a,autoScroll:!0});return new Ext.Panel({layout:"fit",
frame:!1,border:!1,items:[a],height:460})}};TabThree={create:function(a){a='<div id="tabs-3"><div class="p10 bgWhite">';a+='<div class="content">';a+=MyLang.getMsg("MSG_HTML_SOURCE_TAB_EXP");a+="</div>";a+="<div>";a+='<table cellpadding="5" cellspacing="0">';a+="<tbody>";a+="<tr>";a+="<td>";a+='<div class="newSelect" style="display: none">';a+="</div>";a+="</td>";a+='<td class="alignright pL10">';a+="</td>";a+="</tr>";a+="</tbody>";a+="</table><br>";a+='<div style="width: 100%; display: inline-block">';
a+='<pre id="viewSource" style="width: 99%;" class="brush: html, js, jscript, javascript, css; toolbar: false;">';a+="</pre>";a+="</div>";a+="</div>";a+='<div class="clearL"></div><br>';a+='<table cellspacing="10" width="100%" cellpadding="0" class="buttonLayer">';a+="<tbody>";a+="<tr>";a+="<td>";a+='<input onclick="ViewSource.beforePostMessage()" type="button" class="newgraybtn" value="'+MyLang.getMsg("BTN_EDITOR_COMPLETE")+'"> &nbsp;';a+='<input onclick="MainLayout.nextTab(\'0\');" type="button"  class="newgraybtn" value="'+
MyLang.getMsg("BTN_EDITOR_BACK")+'"> &nbsp;';a+='<input onclick="MainLayout.nextTab(\'1\');" type="button"  class="newgraybtn" value="'+MyLang.getMsg("BTN_EDITOR_PRIVEW_BACK")+'"> &nbsp;';a+="</td>";a+="</tr>";a+="<tr>";a+='<td><span style="color: red;">'+MyLang.getMsg("MSG_EDITOR_COMPLETE_EXP")+"</span>";a+="</td>";a+="</tr>";a+="</tbody>";a+="</table>";a+="</div>";a+="</div>";a=new Ext.Panel({frame:!1,border:!1,margins:{top:0,right:5,bottom:0,left:5},html:a,autoScroll:!0});return new Ext.Panel({layout:"fit",
frame:!1,border:!1,items:[a],height:460})}};MyPanel={default_template_list:null,hideAd:!1,tabSet:null,basePanel:null,tabDefine:[{name:"tabs-one",displayName:MyLang.getMsg("MSG_HTML_EDITOR_TAB")},{name:"tabs-two",displayName:MyLang.getMsg("MSG_HTML_PREVIEW_TAB")},{name:"tabs-three",displayName:MyLang.getMsg("MSG_HTML_SOURCE_TAB")}],columnWrap:function(a){return'<div style="white-space:normal !important;">'+a+"</div>"},bindSectionClassHandler:function(){$(document).on("click","div.section_area_title",
function(){var a=$(this).parent("div.section_area"),b=$(a).find("img.section_arrow_img"),a=$(a).find("div.section_show_hide_area");"none"==$(a).css("display")?($(a).show("normal"),$(b).attr("src",SATERAITO_MY_SITE_URL+"/images/arrowDown.gif")):($(a).hide("normal"),$(b).attr("src",SATERAITO_MY_SITE_URL+"/images/arrowRight.gif"))})},createTab:function(a,b,d){d.region="center";return new Ext.Panel({id:a,tabName:a,autoWidth:!0,height:170,title:b,layout:"border",items:[d],listeners:{activate:MyPanel.handlerActivate}})},
getHeaderHtml:function(){var a;a=""+('<div class="builder_header"><img src="'+BASE_URL+'/images/form_builder.png"/><span>');a+=MyLang.getMsg("MSG_HTML_EDITOR_TITLE")+"["+$("#template_name").val()+"]";return a+"</span></div>"},buildPanel:function(){var a={deferredRender:!1,height:33,html:MyPanel.getHeaderHtml(),region:"north",border:!1};MyPanel.getFooterHtml();MyPanel.tabSet=new Ext.TabPanel({id:"tab_set",activeTab:0,enableTabScroll:!0,plain:!0,items:[]});MyPanel.tabSet.region="center";mainPanel=new Ext.Panel({bodyStyle:"background-color:white;",
layout:"border",items:[a,MyPanel.tabSet]});MyPanel.basePanel=new Ext.Viewport({renderTo:"html_editor_render",layout:"fit",autoWidth:!0,autoHeight:!0,style:"background-color: white;",items:[mainPanel]});Ext.util.CSS.createStyleSheet(".x-tab-strip span.x-tab-strip-text {font-size: "+(11+MyPanel.fontSize)+"px}");Ext.util.CSS.createStyleSheet(".x-grid3-hd-row td {font-size: "+(11+MyPanel.fontSize)+"px; line-height:"+(15+MyPanel.fontSize)+"px}");Ext.util.CSS.createStyleSheet(".x-grid3-row td, .x-grid3-summary-row td {font-size: "+
(11+MyPanel.fontSize)+"px; line-height:"+(15+MyPanel.fontSize)+"px; vertical-align: middle;}");Ext.util.CSS.createStyleSheet("a:visited {color: purple}");Ext.util.CSS.createStyleSheet(".sateraito {font-size: "+(12+MyPanel.fontSize)+"px}");$.each(MyPanel.tabDefine,function(){switch(this.name){case MyPanel.tabDefine[0].name:var a=MyPanel.createTab(this.name,this.displayName,TabOne.create(this.name));MyPanel.tabSet.add(a);break;case MyPanel.tabDefine[1].name:a=MyPanel.createTab(this.name,this.displayName,
TabTwo.create(this.name));MyPanel.tabSet.add(a);break;case MyPanel.tabDefine[2].name:a=MyPanel.createTab(this.name,this.displayName,TabThree.create(this.name)),MyPanel.tabSet.add(a)}});MyPanel.tabSet.setActiveTab(MyPanel.tabDefine[0].name);MyPanel.bindSectionClassHandler();if(MyPanel.default_template_list)$("#op_default_template_list").html(MyPanel.html_options),MyPanel.selected_template_id&&$("#op_default_template_list").val(MyPanel.selected_template_id),""==$("#op_default_template_list").val()?
$(".update_c_t").attr("disabled","disabled"):$(".update_c_t").removeAttr("disabled");else{var b=[],d="",d=d+('<option value="">'+MyLang.getMsg("NO_SELECT_TEMAPLTE")+"</option>");$.each(JSON.parse($("#default_template_list").val()),function(){""===this.template_name&&(this.template_name="("+MyLang.getMsg("NO_SUBJECT")+")");b.push(this);d+='<option value="'+this.template_id+'">'+escapeHtml(this.template_name)+"</option>"});MyPanel.default_template_list=b;MyPanel.html_options=d;$("#op_default_template_list").html(MyPanel.html_options);
$(".update_c_t").attr("disabled","disabled")}$("#op_default_template_list").change(function(){""==$(this).val()?$(".update_c_t").attr("disabled","disabled"):$(".update_c_t").removeAttr("disabled")});return!0},selected_template_id:null,runUpdateCurrentTemplate:function(a){Ext.Msg.show({icon:Ext.MessageBox.QUESTION,msg:MyLang.getMsg("RUN_UPDATE_CURRENT_TEMPLATE_CONFIRM"),buttons:Ext.Msg.OKCANCEL,fn:function(b){"ok"==b&&(b=$("#op_default_template_list").val(),MyPanel.selected_template_id=b,$(a).attr("disabled",
"disabled"),Loading.showMessage(),TemplateList.requestGetTemplateDetail(b,function(b){b&&"ok"==b.status&&(b=b.data,$("#template_body").val(b.template_body),$("#template_body_for_html_builder").val(Base64.encode(b.template_body_for_html_builder)),MainLayout.createNewTemplate($("#template_id").val(),$("#template_name").val(),unescapeHtml($("#template_body").val()),unescapeHtml($("#template_body_for_html_builder").val()),function(){MyPanel.basePanel.destroy();setTimeout(function(){MyPanel.buildPanel();
Loading.hide()},300)}));$(a).removeAttr("disabled")}))}})},runLoadSectionTemplate:function(a){var b=$("#op_default_template_list").val();MyPanel.selected_template_id=b;$(a).attr("disabled","disabled");Loading.showMessage();TemplateList.requestGetTemplateDetail(b,function(b){if(b&&"ok"==b.status){Loading.hide();b=b.data;if(""==b.template_body_for_html_builder){Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:b.template_name+" "+MyLang.getMsg("MSG_TEMPLATE_BUILDER_DATA_IS_EMPTY"),buttons:Ext.Msg.OK});return}MyPanel._runLoadSectionTemplate(JSON.parse(JSON.parse(b.template_body_for_html_builder).template_list_json_string))}$(a).removeAttr("disabled")})},
_runLoadSectionTemplate:function(a){var b=Ext.getCmp("dlg_load_section_template");b||(b=[],b.push(new Ext.Button({id:"btnDlg_dlg_load_section_template",text:MyLang.getMsg("BTN_ADD"),handler:function(){$("#dlg_load_section_template_content").find('input[type="checkbox"]:checked').each(function(){var b=a.sections[parseInt($(this).val())];MyPanel.processReNewId(b);MainLayout.createSection(b)});var b=Ext.getCmp("dlg_load_section_template");b&&b.close()}})),b.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),
handler:function(){var a=Ext.getCmp("dlg_load_section_template");a&&a.close()}})),b=new Ext.Window({id:"dlg_load_section_template",title:MyLang.getMsg("TITLE_SECTION_LIST"),layout:"fit",width:400,height:500,closeAction:"hide",plain:!0,modal:!0,items:[{xtype:"panel",html:'<div id="dlg_load_section_template_content" style="padding: 10px 10px;"></div>'}],buttons:b,listeners:{afterRender:function(b){$.each(a.sections,function(a,b){$("#dlg_load_section_template_content").append('<div><input type="checkbox" value="'+
a+'"> '+b.secname+"</div>")})},hide:function(){var a=Ext.getCmp("dlg_load_section_template");a&&a.close()}}}));b.show()},processReNewId:function(a){function b(a){if(a.config&&a.config.items)if("grid"==a.map_type_control)for(key in a.config.items.items)$.each(a.config.items.items[key].ctrs,function(){this.section_id=d;this.control_id=MainLayout.createNewControlId();b(this)});else $.each(a.config.items,function(){this.section_id=d;this.control_id=MainLayout.createNewControlId();b(this)})}var d=MainLayout.createNewSectionId();
a.section_id=d;$.each(a.controls,function(){this.section_id=d;this.control_id=MainLayout.createNewControlId();b(this)})},handlerActivate:function(a){switch(a.id){case MyPanel.tabDefine[1].name:RenderLayout.init();break;case MyPanel.tabDefine[2].name:ViewSource.init()}},getFooterHtml:function(){return"<span>link</span>"}};debugLog(" ++++ Init: SATERAITO HTML BUILDER !!! ++++ ");Ext.QuickTips.init();MyLang.setLocale(SATERAITO_LANG);MiniMessage.initMessageArea();var y,x,A=function(){try{debugLog("[alert]"),
debugLog(new Date),clearTimeout(y),MiniMessage.showLoadingMessage(MyLang.getMsg("ALERT_GADGET_TIMEOUT")),x=setTimeout(function(){z()},6E5)}catch(a){}},z=function(){try{debugLog("[alert]"),debugLog(new Date),clearTimeout(x),MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT"))}catch(a){}};(function(){if(!(0>GADGET_START_TIME)){var a=36E5-((new Date).getTime()-GADGET_START_TIME);debugLog("[start]");debugLog("period_of_time = "+a);0>a?MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):
6E5<a?y=setTimeout(function(){A()},a-6E5):x=setTimeout(function(){z()},a)}})();Loading={showMessage:function(a){"undefined"==typeof a&&(a=MyLang.getMsg("LOADING"));Loading.mask=new Ext.LoadMask(Ext.getBody(),{msg:a});Loading.mask.show()},hide:function(){Loading.mask.hide()}};MainLayout.createNewTemplate($("#template_id").val(),$("#template_name").val(),unescapeHtml($("#template_body").val()),unescapeHtml($("#template_body_for_html_builder").val()),function(){MyPanel.buildPanel()});GridUtil={color:{cell:"#9BB3DA"},
show_index:!0,createControlInCellGrid:function(a,b){for(var d="",e=a.getControls(),f=0;f<e.length;f++)d+=MainLayout.createHtmlDivControl(b,e[f]);return d},createObjToGridClass:function(a){for(var b in a.items){var d=a.items[b];a.items[b]=new t({rowspan:d.rowspan,colspan:d.colspan,style:void 0==d.style?"":d.style,ctrs:d.ctrs})}return new v({maxRow:a.maxRow,maxCol:a.maxCol,items:a.items})},get_status_grid:function(a){var b=!1,d=0,e=[];a=$(a).find(".cell-sortable");$.each(a,function(){$(this).hasClass("selected")&&
(b=!0,e.push(this),d++)});return{has_selected:b,count_selected:d,cells_selected:e,cells:a}},handlerOnClick:function(a){"droptrue ui-sortable"!=a.target.className&&a.target!=a.currentTarget||GridUtil.cell_init(this)},cell_init:function(a){$(a).hasClass("selected")?GridUtil.mark(!1,a):GridUtil.mark(!0,a)},mark:function(a,b,d,e){if("boolean"===typeof a){if("string"===typeof b)b=document.getElementById(b);else if("object"!==typeof b)return;a?$(b).addClass("selected"):$(b).removeClass("selected");"TABLE"===
b.nodeName&&(b=this.cell_list(b),b=b[d+"-"+e]);b&&"TD"===b.nodeName&&(b.redips=b.redips||{},"string"===typeof this.color.cell&&!0===a&&(b.redips.background_old=b.style.backgroundColor),b.redips.selected=a)}},cell_list:function(a){var b=[],d,e={},f,c,g,h,l,k,m,p;h=a.rows;for(l=0;l<h.length;l++)for(k=0;k<h[l].cells.length;k++){d=h[l].cells[k];a=d.parentNode.rowIndex;f=d.rowSpan||1;c=d.colSpan||1;b[a]=b[a]||[];for(m=0;m<b[a].length+1;m++)if("undefined"===typeof b[a][m]){g=m;break}e[a+"-"+g]=d;for(m=
a;m<a+f;m++)for(b[m]=b[m]||[],d=b[m],p=g;p<g+c;p++)d[p]="x"}return e},merge:function(a,b,d){debugLog("* MERGE: START");var e,f,c,g,h,l,k,m,p=-1,n=-1;l=this.cell_list(d);e=d.rows;c="v"===a?this.max_cols(d):e.length;e="v"===a?e.length:this.max_cols(d);d=$(d).parent();p=MainLayout.elmTemplateList.val();n=d.attr("section_id");d=d.attr("id");var q=TemplateList.getControlDetail(p,n,d).config.items;for(k=0;k<c;k++){p=n=-1;for(m=0;m<=e;m++){d="v"===a?m+"-"+k:k+"-"+m;l[d]?(f=l[d],f.redips=f.redips||{},g=f?
f.redips.selected:!1,h="v"===a?f.colSpan:f.rowSpan):g=!1;if(!0===g&&-1===p)p=m,n=h;else if(!0!==g&&-1<p||-1<n&&n!==h)this.merge_cells(l,k,p,m,a,b,q),p=n=-1,!0===g&&(!0!==b&&void 0!==b||this.mark(!1,f),g=!1);l[d]&&(m+="v"===a?f.rowSpan-1:f.colSpan-1)}!0===g&&this.merge_cells(l,k,p,m,a,b,q)}debugLog("* MERGE: END")},cell_index:function(a,b){if(void 0!==b||!0===this.show_index){void 0!==b&&(this.show_index=b);var d,e,f,c,g,h;d=a.rows;c=this.max_cols(a);f=this.cell_list(a);for(g=0;g<d.length;g++)for(h=
0;h<c;h++)f[g+"-"+h]&&(e=f[g+"-"+h],e.innerHTML=this.show_index?g+"-"+h:"")}},max_cols:function(a){a=a.rows;var b,d=0,e,f;for(e=0;e<a.length;e++){for(f=b=0;f<a[e].cells.length;f++)b+=a[e].cells[f].colSpan||1;b>d&&(d=b)}return d},relocate:function(a,b){var d,e,f;if(a!==b)for(d=a.childNodes[0].childNodes.length,f=e=0;e<d;e++)1===a.childNodes[0].childNodes[f].nodeType?b.childNodes[0].appendChild(a.childNodes[0].childNodes[f]):f++},merge_cells:function(a,b,d,e,f,c,g){var h=0,l,k,m,p,n,q,s=[];k="v"===
f?a[d+"-"+b]:a[b+"-"+d];for(m=d+1;m<e;m++)l="v"===f?m+"-"+b:b+"-"+m,a[l]&&(p="v"===f?m:b,n="v"===f?b:m,(q=g.deleteCell(p,n))&&q instanceof Array&&(s=s.concat(q)),debugLog("DELETE: cell_"+p+"-"+n),l=a[l],h+="v"===f?l.rowSpan:l.colSpan,this.relocate(l,k),l.parentNode.deleteCell(l.cellIndex));void 0!==k&&("v"===f?k.rowSpan+=h:k.colSpan+=h,p="v"===f?d:b,n="v"===f?b:d,debugLog("UPDATE: cell_"+p+"-"+n),debugLog(s),g.updateCell(p,n,{rowspan:k.rowSpan,colspan:k.colSpan,ctrs:s}),!0!==c&&void 0!==c||this.mark(!1,
k))},split:function(a,b){var d,e,f,c,g,h,l,k,m,p;p=function(a,c,b){var d;d=0;a=c+a.rowSpan-1;for(b-=1;0<=b;b--)void 0===f[a+"-"+b]&&d++;return d};var n=$(b).parent();d=MainLayout.elmTemplateList.val();var q=n.attr("section_id"),n=n.attr("id"),s=TemplateList.getControlDetail(d,q,n).config.items;f=this.cell_list(b);l=this.max_cols(b);d=b.rows;for(k=0;k<d.length;k++)for(h="v"===a?l:d[k].cells.length,m=0;m<h;m++){if("v"===a){if(e=f[k+"-"+m],void 0!==e&&(e.redips=e.redips||{}),void 0!==e&&!0===e.redips.selected&&
1<e.rowSpan){c=p(e,k,m);g=d[k+e.rowSpan-1].insertCell(m-c);g.colSpan=e.colSpan;g.className="cell-sortable";var r="cell_"+(k+e.rowSpan-1)+"-"+(m-c);g.setAttribute("cell_key",r);debugLog("UPDATE:"+r);$(g).append('<div class="droptrue ui-sortable" in_grid="true" control_id="'+n+'" section_id="'+q+'" cell_key="'+r+'"></div>');s.createCell(k+e.rowSpan-1,m-c,-1,e.colSpan,[]);e.rowSpan-=1;r=$(e).attr("cell_key");(c=s.getCellFromKey(r))&&c.setRowSpan(e.rowSpan);f=this.cell_list(b)}}else e=d[k].cells[m],e.redips=
e.redips||{},!0===e.redips.selected&&1<e.colSpan&&(h++,g=d[k].insertCell(m+1),g.rowSpan=e.rowSpan,g.className="cell-sortable",r="cell_"+k+"-"+(m+1),g.setAttribute("cell_key",r),debugLog("UPDATE:"+r),$(g).append('<div class="droptrue ui-sortable" in_grid="true" control_id="'+n+'" section_id="'+q+'" cell_key="'+r+'"></div>'),s.createCell(k,m+1,e.rowSpan,-1,[]),e.colSpan-=1,r=$(e).attr("cell_key"),(c=s.getCellFromKey(r))&&c.setColSpan(e.colSpan));void 0!==e&&this.mark(!1,e)}MainLayout.processInitEvents()},
split2:function(a,b){var d,e,f,c,g,h,l,k,m,p,n=!1,q=[];p=function(a,c,b){var d;d=0;a=c+a.rowSpan-1;for(b-=1;0<=b;b--)void 0===f[a+"-"+b]&&d++;return d};var s=$(b).parent();d=MainLayout.elmTemplateList.val();var r=s.attr("section_id"),s=s.attr("id"),t=TemplateList.getControlDetail(d,r,s).config.items;f=this.cell_list(b);l=this.max_cols(b);d=b.rows;for(k=0;k<d.length;k++)for(h="v"===a?l:d[k].cells.length,m=0;m<h;m++){if("v"===a){if(e=f[k+"-"+m],void 0!==e&&(e.redips=e.redips||{}),void 0!==e&&!0===e.redips.selected&&
1<e.rowSpan){c=p(e,k,m);g=d[k+e.rowSpan-1].insertCell(m-c);g.colSpan=e.colSpan;g.className="cell-sortable";var u="cell_"+(k+e.rowSpan-1)+"-"+(m-c);g.setAttribute("cell_key",u);debugLog("UPDATE:"+u);$(g).append('<div class="droptrue ui-sortable" in_grid="true" control_id="'+s+'" section_id="'+r+'" cell_key="'+u+'"></div>');t.createCell(k+e.rowSpan-1,m-c,-1,e.colSpan,[]);e.rowSpan-=1;u=$(e).attr("cell_key");(c=t.getCellFromKey(u))&&c.setRowSpan(e.rowSpan);f=this.cell_list(b);1<e.rowSpan&&(this.mark(!0,
e),n=!0);q.push(g)}}else e=d[k].cells[m],e.redips=e.redips||{},!0===e.redips.selected&&1<e.colSpan&&(h++,g=d[k].insertCell(m+1),g.rowSpan=e.rowSpan,g.className="cell-sortable",cell_key_split=$(e).attr("cell_key").split("-"),colspan=e.colSpan-1+parseInt(cell_key_split[1]),u="cell_"+k+"-"+colspan,g.setAttribute("cell_key",u),debugLog("UPDATE:"+u),$(g).append('<div class="droptrue ui-sortable" in_grid="true" control_id="'+s+'" section_id="'+r+'" cell_key="'+u+'"></div>'),t.createCell(k,colspan,e.rowSpan,
-1,[]),e.colSpan-=1,u=$(e).attr("cell_key"),(c=t.getCellFromKey(u))&&c.setColSpan(e.colSpan),1<e.colSpan&&(this.mark(!0,e),n=!0),q.push(g));void 0!==e&&this.mark(!1,e)}MainLayout.processInitEvents();return{loop:n,cols:q}},asyncItemsGridWithHtml:function(a){$.each(a.items,function(){$.each(this.ctrs,function(){$("#"+this.control_id).attr("pos_row",this.pos_row.toString())})})},go_merge:function(a){this.merge("h",!1,a[0]);this.merge("v",!0,a[0]);var b=a.parent();a=MainLayout.elmTemplateList.val();var d=
b.attr("section_id"),b=b.attr("id");a=TemplateList.getControlDetail(a,d,b).config.items;this.asyncItemsGridWithHtml(a)},go_split_horizontally:function(a){this.split("h",a[0])},go_split_vertically:function(a){this.split("v",a[0])},go_unmerge:function(a){var b=this,d=!0,e=[],f=[],f=[],c=b.cell_list(a[0]);$.each(c,function(){this.redips&&!0===this.redips.selected&&e.push(this)});if(0!==e.length){for(f=e.concat([]);!0==d;)c=b.split2("h",a[0]),d=c.loop,f=f.concat(c.cols),$.each(f,function(){b.mark(!0,
this)});$.each(f,function(){b.mark(!0,this)});d=!0;for(f=f.concat([]);!0==d;)c=b.split2("v",a[0]),d=c.loop,f=f.concat(c.cols),$.each(f,function(){b.mark(!0,this)});$.each(f,function(){b.mark(!1,this)})}},handlerProcessEditCtrCellGrid:function(a){a=a.parentElement;return a.hasAttributes("in_grid")&&"true"===a.getAttribute("in_grid")?{control_id:a.getAttribute("control_id"),section_id:a.getAttribute("section_id"),cell_key:a.getAttribute("cell_key")}:this.handlerProcessEditCtrCellGrid(a)},go_edit_ctr_cell_grid:function(a){var b=
$(a).attr("control_id");if(a=this.handlerProcessEditCtrCellGrid(a)){var d=MainLayout.elmTemplateList.val(),e=a.cell_key,f=a.section_id,c=TemplateList.getControlDetail(d,f,a.control_id).config.items.getCellFromKey(e),g=c.getControls(),h;$.each(g,function(){if(this.control_id===b)return h=this,!1});h&&PopupToolsCtr.show(h,function(a){var b=TemplateList.getSectionDetail(d,f);if(!0==a.mode_delete)c.deleteControl(h.control_id);else{var e=a.attributes;h.map_type_control=a.map_type;h.config.attributes=e;
"undefined"!=typeof a.items&&(h.config.items=clone(a.items),Controller.asyncItemsInControls(h,h.config.items,f));"undefined"!=typeof a.html&&(h.config.html=clone(a.html));if(!0==a.mode_save_and_copy){g.keySort(Controller.getObjectSortFromPosCol());a=TemplateList.getArrayControlFromColumn(g,h.pos_col);var e=a.indexOfObject(h),p=clone(h);p.control_id=MainLayout.createNewControlId();p.config.attributes.name+="_copy";p.config.attributes.lblname+=MyLang.getMsg("MSG_COMP_COPY");"undefined"!=typeof p.items&&
Controller.asyncItemsInControls(p,p.items,f);$.each(a,function(){g.splice(g.indexOfObject(this),1)});a.splice(e+1,0,p);for(e=0;e<a.length;e++)a[e].pos_row=e+1;c.addControls(a)}}MainLayout.updateControlInSection(b)})}},go_edit_grid:function(a){var b=document.createElement("span");b.setAttribute("control_id",$(a).parent().attr("id"));b.setAttribute("section_id",$(a).parent().attr("section_id"));MainLayout.showPopupEditCtr(b);b=$(a).parent().attr("id");$(a).parent().attr("section_id");var d=TemplateList.findControlIdInTemplate(MainLayout.elmTemplateList.val(),
b);d&&PopupToolsCtr.show(d,function(a){var b=MainLayout.elmTemplateList.val(),c=d.section_id;if(!0==a.mode_delete){b=MainLayout.elmTemplateList.val();TemplateList.getTemplateDetail(b);var b=TemplateList.getSectionDetail(b,c),g=b.controls;g.keySort(Controller.getObjectSortFromPosCol());a=TemplateList.getArrayControlFromColumn(g,d.pos_col);$.each(a,function(){g.splice(g.indexOfObject(this),1)});a.splice(d.pos_row-1,1);for(c=0;c<a.length;c++){var h=a[c];h.pos_row=c+1}b.controls=b.controls.concat(a)}else{var h=
a.map_type,l=a.attributes,b=TemplateList.getSectionDetail(b,c);d.map_type_control=h;d.config.attributes=l;if(!0==a.mode_save_and_copy){g=b.controls;g.keySort(Controller.getObjectSortFromPosCol());a=TemplateList.getArrayControlFromColumn(g,d.pos_col);h=a.indexOfObject(d);l=clone(d);l.control_id=MainLayout.createNewControlId();l.config.attributes.name+="_copy";l.config.attributes.lblname+=MyLang.getMsg("MSG_COMP_COPY");"undefined"!=typeof l.items&&Controller.asyncItemsInControls(l,l.items,c);$.each(a,
function(){g.splice(g.indexOfObject(this),1)});a.splice(h+1,0,l);for(c=0;c<a.length;c++)h=a[c],h.pos_row=c+1;b.controls=b.controls.concat(a)}}MainLayout.updateControlInSection(b)})},go_add_control:function(a){var b=this.get_status_grid(a);if(1===b.count_selected){var b=$(b.cells_selected[0]).attr("cell_key"),d=MainLayout.elmTemplateList.val(),e=$(a).parent().attr("section_id");a=$(a).parent().attr("id");var f=TemplateList.getControlDetail(d,e,a).config.items.getCellFromKey(b),c=f.getControls();PopupToolsCtr.show(null,
function(a){var b=MainLayout.elmTemplateList.val(),d=a.map_type,b=TemplateList.getSectionDetail(b,e);if("grid"===d)Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("MSG_CAN_NOT_CREATE_GRID_IN_GRID"),buttons:Ext.Msg.OK});else{if("serial_number"==d){a=a.serial_number_setting;for(var k=[],m=0;m<a.length;m++){var p=MainLayout.createNewControlId(),n=clone(Controller.MapType.label);n.map_type_control="label";n.control_id=p;n.pos_col=-1;n.pos_row=c.length+1;n.config.attributes.lblname=a.custom_name+
(m+1);n.config.attributes.style=a.style;n.config.attributes.class=a.class;k.push(n)}}else for(k=[],m=0;m<a.number_control;m++){var q=clone(a),s=q.attributes,p=MainLayout.createNewControlId(),n={};n.control_id=p;n.map_type_control=d;n.pos_col=-1;n.pos_row=c.length+1;n.config={};n.config.attributes=s;p=void 0!=s.name?s.name:"";0<m&&(p+=""+m);n.config.attributes.name=p;"undefined"!=typeof q.items&&(p=q.items,Controller.asyncItemsInControls(n,p,e),n.config.items=p);"undefined"!=typeof q.html&&(n.config.html=
q.html);k.push(n)}f.addControls(k);MainLayout.updateControlInSection(b)}})}},go_stylesheet:function(a){if(a){var b=this.get_status_grid(a);if(b.has_selected){var d=b.cells_selected,e=$(a).parent();a=MainLayout.elmTemplateList.val();var b=e.attr("id"),e=e.attr("section_id"),f=TemplateList.getControlDetail(a,e,b).config.items;a=Ext.getCmp("dlg_go_stylesheet_cell");a||(a=[],a.push(new Ext.Button({id:"btnDlg_dlg_go_stylesheet_cell",text:MyLang.getMsg("BTN_SAVE"),handler:function(){var a=Ext.getCmp("dlg_go_stylesheet_cell_textarea").getValue();
$.each(d,function(){f.updateCellFromKey($(this).attr("cell_key"),{style:a});GridUtil.mark(!1,this)});var b=Ext.getCmp("dlg_go_stylesheet_cell");b&&b.close()}})),a.push(new Ext.Button({text:MyLang.getMsg("BTN_CANCEL"),handler:function(){var a=Ext.getCmp("dlg_go_stylesheet_cell");a&&a.close()}})),a=new Ext.Window({id:"dlg_go_stylesheet_cell",title:MyLang.getMsg("TITLE_EDIT_STYLESHEET_CELL"),layout:"fit",width:300,height:200,closeAction:"hide",plain:!0,modal:!0,items:[{xtype:"textarea",id:"dlg_go_stylesheet_cell_textarea"}],
buttons:a,listeners:{afterRender:function(){var a=f.getCellFromKey($(d[0]).attr("cell_key"));Ext.getCmp("dlg_go_stylesheet_cell_textarea").setValue(a.getStyle())},hide:function(){var a=Ext.getCmp("dlg_go_stylesheet_cell");a&&a.close()}}}));a.show()}}},go_delete:function(a){if(a){var b=this.get_status_grid(a);b.has_selected&&Ext.Msg.show({icon:Ext.MessageBox.QUESTION,msg:MyLang.getMsg("MSG_DELETE_COMP"),buttons:Ext.Msg.OKCANCEL,fn:function(d){if("ok"==d){d=b.cells_selected;var e=$(a).parent(),f=MainLayout.elmTemplateList.val(),
c=e.attr("id"),e=e.attr("section_id"),g=TemplateList.getControlDetail(f,e,c).config.items;$.each(d,function(){g.deleteCellFromKey($(this).attr("cell_key"));$(this).remove()})}}})}}};$.contextMenu({selector:"table[gridEditor=true]",build:function(a,b){GridUtil.get_status_grid(a);var d={};d.go_edit_grid={name:MyLang.getMsg("GO_EDIT_GRID"),icon:"go_edit_grid",disabled:function(a,b){return GridUtil.get_status_grid(b.$trigger).has_selected}};d.go_add_control={name:MyLang.getMsg("GO_ADD_CTR_CELL"),icon:"add_control_cell",
disabled:function(a,b){return 1!=GridUtil.get_status_grid(b.$trigger).count_selected}};d.go_delete={name:MyLang.getMsg("GO_DELETE_CELL"),icon:"go_delete_cell",disabled:function(a,b){return!GridUtil.get_status_grid(b.$trigger).has_selected}};d.go_merge={name:MyLang.getMsg("GO_MERGE_CELL"),icon:"go_merge_cell",disabled:function(a,b){var c=GridUtil.get_status_grid(b.$trigger);return!(c.has_selected&&1<c.count_selected)}};d.go_unmerge={name:MyLang.getMsg("GO_UNMERGE"),icon:"go_split_horizontally_cell",
disabled:function(a,b){return!GridUtil.get_status_grid(b.$trigger).has_selected}};d.go_stylesheet={name:MyLang.getMsg("GO_STYLESHEET_CELL"),icon:"go_stylesheet_cell",disabled:function(a,b){return!GridUtil.get_status_grid(b.$trigger).has_selected}};return{callback:function(a,b){var c=b.$trigger;switch(a){case "go_edit_grid":GridUtil.go_edit_grid(c);break;case "go_add_control":GridUtil.go_add_control(c);break;case "go_merge":GridUtil.go_merge(c);break;case "go_unmerge":GridUtil.go_unmerge(c);break;
case "go_stylesheet":GridUtil.go_stylesheet(c);break;case "go_delete":GridUtil.go_delete(c)}},items:d}}})});
