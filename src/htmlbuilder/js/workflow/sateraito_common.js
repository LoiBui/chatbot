(function(){SateraitoWF={symbolArray:[["@","\uff20"],["|","\uff5c"],["!","\uff01"],["#","\uff03"],["$","\uff04"],["%","\uff05"],["&","\uff06"],["'","\u2019"],['"',"\u201d"],["(","\uff08"],[")","\uff09"],["=","\uff1d"],["-","\u30fc"],["~","\uff5e"],["^","\uff3e"],["\\","\uffe5"],["_","\uff3f"],["<","\uff1c"],[">","\uff1e"],["?","\uff1f"],["/","\uff0f"],["+","\uff0b"],["*","\uff0a"],[":","\uff1a"],[";","\uff1b"],["\uff65","\u30fb"],["{","\uff5b"],["}","\uff5d"],["[","\uff3b"],["]","\uff3d"],[".","\uff0e"],
[",","\uff0c"],[":","\uff1a"],[";","\uff1b"]],katakanaArray:[["\uff76\uff9e","\u30ac"],["\uff77\uff9e","\u30ae"],["\uff78\uff9e","\u30b0"],["\uff79\uff9e","\u30b2"],["\uff7a\uff9e","\u30b4"],["\uff7b\uff9e","\u30b6"],["\uff7c\uff9e","\u30b8"],["\uff7d\uff9e","\u30ba"],["\uff7e\uff9e","\u30bc"],["\uff7f\uff9e","\u30be"],["\uff80\uff9e","\u30c0"],["\uff81\uff9e","\u30c2"],["\uff82\uff9e","\u30c5"],["\uff83\uff9e","\u30c7"],["\uff84\uff9e","\u30c9"],["\uff8a\uff9e","\u30d0"],["\uff8a\uff9f","\u30d1"],
["\uff8b\uff9e","\u30d3"],["\uff8b\uff9f","\u30d4"],["\uff8c\uff9e","\u30d6"],["\uff8c\uff9f","\u30d7"],["\uff8d\uff9e","\u30d9"],["\uff8d\uff9f","\u30da"],["\uff8e\uff9e","\u30dc"],["\uff8e\uff9f","\u30dd"],["\uff73\uff9e","\u30f4"],["\uff67","\u30a1"],["\uff71","\u30a2"],["\uff68","\u30a3"],["\uff72","\u30a4"],["\uff69","\u30a5"],["\uff73","\u30a6"],["\uff6a","\u30a7"],["\uff74","\u30a8"],["\uff6b","\u30a9"],["\uff75","\u30aa"],["\uff76","\u30ab"],["\uff77","\u30ad"],["\uff78","\u30af"],["\uff79",
"\u30b1"],["\uff7a","\u30b3"],["\uff7b","\u30b5"],["\uff7c","\u30b7"],["\uff7d","\u30b9"],["\uff7e","\u30bb"],["\uff7f","\u30bd"],["\uff80","\u30bf"],["\uff81","\u30c1"],["\uff6f","\u30c3"],["\uff82","\u30c4"],["\uff83","\u30c6"],["\uff84","\u30c8"],["\uff85","\u30ca"],["\uff86","\u30cb"],["\uff87","\u30cc"],["\uff88","\u30cd"],["\uff89","\u30ce"],["\uff8a","\u30cf"],["\uff8b","\u30d2"],["\uff8c","\u30d5"],["\uff8d","\u30d8"],["\uff8e","\u30db"],["\uff8f","\u30de"],["\uff90","\u30df"],["\uff91","\u30e0"],
["\uff92","\u30e1"],["\uff93","\u30e2"],["\uff6c","\u30e3"],["\uff94","\u30e4"],["\uff6d","\u30e5"],["\uff95","\u30e6"],["\uff6e","\u30e7"],["\uff96","\u30e8"],["\uff97","\u30e9"],["\uff98","\u30ea"],["\uff99","\u30eb"],["\uff9a","\u30ec"],["\uff9b","\u30ed"],["\uff9c","\u30ef"],["\uff66","\u30f2"],["\uff9d","\u30f3"],["\uff61","\u3002"],["\uff62","\u300c"],["\uff63","\u300d"],["\uff64","\u3001"],["\uff65","\u30fb"],["\uff70","\u30fc"],["\uff9e","\u309b"],["\uff9f","\u309c"]],_toFullWidthKatakana:function(a){return SateraitoWF._toFullWidth(a,
SateraitoWF.katakanaArray)},_toFullWidthSymbol:function(a){return SateraitoWF._toFullWidth(a,SateraitoWF.symbolArray)},_toFullWidth:function(a,b){var c=a;Ext.each(b,function(){for(var a=String(this[0]),b=String(this[1]);-1!=c.indexOf(a);)c=c.replace(a,b)});return c},_toHalfWidthKatakana:function(a){return SateraitoWF._toHalfWidth(a,SateraitoWF.katakanaArray)},_toHalfWidthSymbol:function(a){return SateraitoWF._toHalfWidth(a,SateraitoWF.symbolArray)},_toHalfWidth:function(a,b){var c=a;Ext.each(b,function(){for(var a=
String(this[0]),b=String(this[1]);-1!=c.indexOf(b);)c=c.replace(b,a)});return c},toFullWidth:function(a){if("string"!=typeof a)return a;a=SateraitoWF._toFullWidthSymbol(a);a=SateraitoWF._toFullWidthKatakana(a);return a.replace(/[A-Za-z0-9]/g,function(a){return String.fromCharCode(a.charCodeAt(0)+65248)})},toHalfWidth:function(a){if("string"!=typeof a)return a;a=SateraitoWF._toHalfWidthSymbol(a);a=SateraitoWF._toHalfWidthKatakana(a);return a.replace(/[\uff21-\uff3a\uff41-\uff5a\uff10-\uff19]/g,function(a){return String.fromCharCode(a.charCodeAt(0)-
65248)})},addComma:function(a){return NumUtil.addComma(a)},removeComma:function(a){return NumUtil.removeComma(a)},getCalendarCmp:function(a,b){if("form_new_doc"==a.id)return Ext.getCmp("template_body_new_doc_"+b);var c=a.id.split("_")[1];return Ext.getCmp("template_body_"+c+"_"+b)},calcAll:function(a){"form_new_doc"==a.id?Calc.calcAll("template_body_new_doc"):(a=a.id.split("_")[1],Calc.calcAll("template_body_"+a))},round:function(a,b,c){return Calc.round(a,b,c)},sum:function(a,b){return Calc.sum(a,
b)},diff:function(a,b){return Calc.diff(a,b)},multi:function(a,b){return Calc.multi(a,b)},divide:function(a,b){return Calc.divide(a,b)},dateDiff:function(a,b){return""==a||""==b?null:Sateraito.DateUtil.getDateDiff(a,b)},dateAdd:function(a,b){return""==a||null==a||isNaN(b)?null:Sateraito.DateUtil.getFutureDateStr(a,b)},monthAdd:function(a,b){return""==a||null==a||isNaN(b)?null:Sateraito.DateUtil.addMonth(a,b)},yearAdd:function(a,b){return""==a||null==a||isNaN(b)?null:Sateraito.DateUtil.addYear(a,b)},
registerFunctionsToNewWindow:function(a,b){var c=Ext.getCmp("doc_detail_window_new_doc");"undefined"==typeof c.customFunctions&&(c.customFunctions={});c.customFunctions[a]=b},registerWFHandler:function(a,b,c){"form_new_doc"==a.id?a=Ext.getCmp("doc_detail_window_new_doc"):(a=a.id.split("_")[1],a=Ext.getCmp("doc_detail_window_"+a));"undefined"!=typeof a&&("undefined"==typeof a.wfEventHandler&&(a.wfEventHandler={}),a.wfEventHandler[b]=c)},getFunctionsFromNewWindow:function(a){var b=Ext.getCmp("doc_detail_window_new_doc");
"undefined"==typeof b.customFunctions&&(b.customFunctions={});return b.customFunctions[a]},getFormMainBody:function(a){return $(a).find("div.main_body")},disableFormElement:function(a,b){var c=SateraitoWF.getFormMainBody(a);SateraitoWF.disableFormElementByMainBody(c,b)},disableFormElementByMainBody:function(a,b){$(a).find(":input[name="+b+"]").attr("disabled","disabled");var c=$(a).find(":input[name="+b+"]").attr("id");"undefined"!=typeof c&&(c=Ext.ComponentMgr.get(c),"undefined"!=typeof c&&c.disable())},
enableFormElement:function(a,b){var c=SateraitoWF.getFormMainBody(a);SateraitoWF.enableFormElementByMainBody(c,b)},enableFormElementByMainBody:function(a,b){$(a).find(":input[name="+b+"]").removeAttr("disabled");var c=$(a).find(":input[name="+b+"]").attr("id");"undefined"!=typeof c&&(c=Ext.ComponentMgr.get(c),"undefined"!=typeof c&&c.enable())},setFormValue:function(a,b,c){a=SateraitoWF.getFormMainBody(a);SateraitoWF.setFormValueByMainBody(a,b,c)},setFormValueByMainBody:function(a,b,c){var d=[];"string"==
typeof c&&""!=c?d=c.split(","):d.push(""+c);$(a).find(":input[name="+b+"]").hasClass("number")&&(c=NumUtil.addComma(NumUtil.removeComma(c)));$(a).find(":input[name="+b+"]").each(function(){$(this).attr("name");var e=$(this).attr("type");"radio"==e?$(this).val()==c&&$(this).attr("checked","checked"):"checkbox"==e?0<=$.inArray($(this).val(),d)?$(this).attr("checked","checked"):$(this).removeAttr("checked"):($(this).is("textarea")?$(this).val(c).trigger("autosize.resize"):$(this).attr("value",c),e=Sateraito.Util.escapeHtml(c),
$(a).find("span.sateraito_doc_value[name="+b+"]").html(Sateraito.Util.enterToBr(e)))})},getFormValue:function(a,b){var c=SateraitoWF.getFormMainBody(a);return SateraitoWF.getFormValueByMainBody(c,b)},getFormValueByMainBody:function(a,b){var c="";$(a).find(":input[name="+b+"]").each(function(){$(this).attr("name");var a=$(this).attr("type");"radio"==a?$(this).is(":checked")&&(c+=(""!=c?",":"")+$(this).val()):"checkbox"==a?$(this).is(":checked")&&(c+=(""!=c?",":"")+$(this).val()):c+=(""!=c?",":"")+
$(this).val()});return c},getForm:function(a){return $(a).parents("form")[0]},showNewDocWindow:function(a,b){if(IS_OPENID_MODE)return alert(MyLang.getMsg("MSG_NOT_AVAILABLE_CREATE_DOC_IN_OPENIDMODE")),!1;var c=WorkflowTemplate.getTemplateIdByName(a);if(""==c)return Sateraito.Util.console("showNewDocWindow is pending. because of template id is empty."),!1;NewDocWindow.showWindow(c,b,"","","",null,"",!1,"","");return!0},showNewDocWindowWithRelationAndCheckDuplicate:function(a,b,c,d,e){if(IS_OPENID_MODE)return alert(MyLang.getMsg("MSG_NOT_AVAILABLE_CREATE_DOC_IN_OPENIDMODE")),
!1;b=WorkflowTemplate.getTemplateIdByName(b);if(""==b)return!1;"undefined"==typeof e&&(e=1);"undefined"==typeof d&&(d="");NewDocWindow.showWindow(b,c,"","","",null,"",!1,"",WorkflowDoc.docIds[a.id],!0,e,d);return!0},showNewDocWindowWithRelation:function(a,b,c){if(IS_OPENID_MODE)return alert(MyLang.getMsg("MSG_NOT_AVAILABLE_CREATE_DOC_IN_OPENIDMODE")),!1;b=WorkflowTemplate.getTemplateIdByName(b);if(""==b)return!1;NewDocWindow.showWindow(b,c,"","","",null,"",!1,"",WorkflowDoc.docIds[a.id]);return!0},
showRelativeDocWindow:function(a,b){if("undefined"==typeof b||isNaN(b)||0>=b)b=1;var c=WorkflowDoc.docIds[a.id],d="";if(1==b)d=WorkflowDoc.relativeDocIds[c];else if(c=WorkflowDoc.relativeDocIdChains[c],"undefined"!=typeof c&&c.length>=b){var e=c.length-b;0<=e&&(d=c[e])}if("undefined"!=typeof d&&""!=d)return DocDetailWindow.showWindow(d),!0},requestMasterDataRow:function(a,b,c){MasterData.requestMasterDataRow(a,b,c)},requestMasterData:function(a,b){MasterData.requestMasterData(a,"",!0,!1,!1,"",b)},
getMasterData:function(a){if(MasterData.hasMasterDataCache(a)){var b;MasterData.requestMasterData(a,"",!0,!1,!1,"",function(a,d){b=a});return b}return[]},appendUpdateMasterData:function(a,b,c,d,e,f,g){WorkflowDoc.appendMasterRowForUpdate(WorkflowDoc.docIds[a.id],b,c,d,e,f,g)},openSectionArea:function(a,b){SateraitoWF._openSectionArea(a,b,!0)},closeSectionArea:function(a,b){SateraitoWF._openSectionArea(a,b,!1)},_openSectionArea:function(a,b,c){var d=SateraitoWF.getFormMainBody(a);a=String(b).split(" ");
Ext.each(a,function(){var a=""+this;$(d).find("div.section_area").each(function(){var b=$(this);if($(b).hasClass(a)){var d=$(b).find("img.section_arrow_img"),b=$(b).find("div.section_show_hide_area");$(b).css("display");c?($(b).show(),$(d).attr("src",SATERAITO_MY_SITE_URL+"/images/arrowDown.gif")):($(b).hide(),$(d).attr("src",SATERAITO_MY_SITE_URL+"/images/arrowRight.gif"))}})})},hideRouteSelection:function(a){$("#route_selection").hide()},showRouteSelection:function(a){$("#route_selection").show()},
selectRoute:function(a,b){var c="";if("form_new_doc"==a.id){var c="template_body_new_doc",d={process:function(){ApproverCandidate.checkInitApprover(c)?(SateraitoWF.setFormValue(a,"route_selection",b-1),$("#route_selection").trigger("change")):setTimeout(d.process,1E3)}};d.process()}},getCurrentRoute:function(a){a=SateraitoWF.getFormValue(a,"route_selection");return"undefined"!=typeof a&&""!=a?parseInt(a,10)+1:0},getCurrentApproveProcessNumber:function(a){a=$(a).find("div.route_body").find("input[name=process][current_approving=1]").attr("number");
return isNaN(a)?0:parseInt(a,10)},getApprovers:function(a,b){var c=[],d=$(a).find("div.route_body").find(":input[name=process][number="+b+"]").val();"undefined"!=typeof d&&""!=d&&(c=d.split(","));return c},addApprover:function(a,b,c,d){c=WorkflowUser.getUserByKey(c,d);"undefined"!=typeof c&&null!=c&&(d="",d="form_new_doc"==a.id?"template_body_new_doc":"template_body_"+a.id.split("_")[1],a=$("#"+d).find("input[name=process][number="+b+"]"),ApproverCandidate.addApprover(a,[c.user_email],d))},removeApprover:function(a,
b,c,d){c=WorkflowUser.getUserByKey(c,d);"undefined"!=typeof c&&null!=c&&(d="",d="form_new_doc"==a.id?"template_body_new_doc":"template_body_"+a.id.split("_")[1],ApproverCandidate.removeApprover(b,c.user_email,d))},clearApprovers:function(a,b){var c="",c="form_new_doc"==a.id?"template_body_new_doc":"template_body_"+a.id.split("_")[1],d=SateraitoWF.getApprovers(a,b);null!=d&&Ext.each(d,function(a){ApproverCandidate.removeApprover(b,a,c)})},getUser:function(a,b,c){return WorkflowUser.getUserByKey(b,
c)},getViewerUserInfo:function(){return UserSetting.userSetting},getSubmitterUserInfo:function(a){return UserSetting.submitterSetting[a.id]},getToday:function(a,b){IS_OPENID_MODE?SateraitoWF._getTodayOid(a,b):SateraitoWF._getToday(a,b)},_getTodayOid:function(a,b){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof b&&(b=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/gettoday?hl="+SATERAITO_LANG,success:function(b,
d){var e=Ext.decode(b.responseText);a(e)},failure:function(){Sateraito.Util.console("retrying "+b);b<Sateraito.EventController.MAX_RETRY&&SateraitoWF._getTodayOid(a,b+1)}})},_getToday:function(a,b){"undefined"==typeof b&&(b=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/gettoday?hl="+SATERAITO_LANG,function(c){c.data?a(c.data):(Sateraito.Util.console("[gettoday]("+b+")"+c.errors[0]),401==c.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):
b<Sateraito.EventController.MAX_RETRY&&SateraitoWF._getToday(a,b+1))},Sateraito.Util.requestParam())}};SateraitoUI={changeEnabledComponents:function(a){for(var b="approve_button reject_button remand_button approve_button2 reject_button2 remand_button2 update_button update_button2 delete_button delete_button2 looked_button looked_button2 resubmit_button resubmit_button2 btn_submit_new_doc btn_save_as_draft_doc".split(" "),c=0;c<b.length;c++){var d=Ext.getCmp(b[c]);d&&(a?d.enable():d.disable())}},getWindowHeightWithUserPrefs:function(a){if(!IS_OPENID_MODE){var b=
Sateraito.GadgetHeight.getUserPrefs(a);a=b>=a?a:b}return a}};AppsGroup={groupList:[],groupListLoadingStatus:"0",getGroupName:function(a){var b=a;Ext.each(AppsGroup.groupList,function(){""+this.group_id==a&&(b=""+this.group_name)});return b},requestAllGroupOfMember:function(a,b){"undefined"==typeof b&&(b=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/group/loadallgroupofuser",function(c){c.data?"function"==typeof a&&a():(Sateraito.Util.console(c.errors[0]),
b<Sateraito.EventController.MAX_RETRY?AppsGroup.requestAllGroupOfMember(a,b+1):401==c.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10))},Sateraito.Util.requestParam())},requestGroupList:function(a,b){0<AppsGroup.groupList.length?"function"==typeof a&&a(AppsGroup.groupList):IS_OPENID_MODE?AppsGroup._requestGroupListOid(a,b):AppsGroup._requestGroupList(a,b)},_requestGroupList:function(a,b){"undefined"==
typeof b&&(b=1);AppsGroup.groupListLoadingStatus="1";gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/group/getgrouplist",function(c){c.data?(AppsGroup.groupListLoadingStatus="2",c=c.data,AppsGroup.groupList=c,"function"==typeof a&&a(c)):(Sateraito.Util.console(c.errors[0]),b<Sateraito.EventController.MAX_RETRY?function(){AppsGroup._requestGroupList(a,b+1)}.defer(1E3*b):AppsGroup.groupListLoadingStatus="0")},Sateraito.Util.requestParam())},_requestGroupListOid:function(a,
b){"undefined"==typeof b&&(b=1);AppsGroup.groupListLoadingStatus="1";Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/group/oid/getgrouplist",success:function(b,d){AppsGroup.groupListLoadingStatus="2";var e=Ext.decode(b.responseText);AppsGroup.groupList=e;"function"==typeof a&&a(e)},failure:function(){Sateraito.Util.console("retrying "+b);b<Sateraito.EventController.MAX_RETRY&&function(){AppsGroup._requestGroupListOid(a,b+1)}.defer(1E3*b)}})}};ApproverCandidate=
{checkInitApprover:function(a,b){"undefined"==typeof b&&(b=!1);var c=!0;$("#"+a).find("input[name=process]").each(function(){b&&"1"==$(this).attr("initializing")?c=!1:b||"1"!=$(this).attr("initializing")&&"2"!=$(this).attr("initializing")||(c=!1)});return c},isExistExclusionDuplicateApproversSetting:function(a){a=$("#"+a).find("input[name=workflow_approver_setting]");return"undefined"!=typeof $(a).attr("exclusion_duplicate_approvers")},exclusionDuplicateApprovers:function(a){var b=$("#"+a).find("input[name=workflow_approver_setting]"),
c=$(b).attr("exclusion_duplicate_approvers"),b=$(b).attr("exclusion_option");"undefined"==typeof b&&(b="");if("undefined"!=typeof c){var d=0,e={},f={};$("#"+a).find("input[name=process]").each(function(){var a=parseInt($(this).attr("number"),10);a>d&&(d=a);if("undefined"==typeof $(this).attr("is_not_exclusion_duplicate_approvers")){a=$(this).attr("exclusion_approvers_category");"undefined"==typeof a&&(a="");"undefined"==typeof f[a]&&(f[a]="");var b;"undefined"==typeof e[a]?(b={},e[a]=b):b=e[a];a=
$(this).val().split(",");Ext.each(a,function(){var a=""+this,c=a.toLowerCase();""!=a&&("undefined"==typeof b[c]&&(b[c]=0),b[c]+=1)})}});for(i=0;i<d;i++){c="maximum"==b.toLowerCase()?i+1:d-i;c=$("#"+a).find("input[name=process][number="+c+"]");if("undefined"==typeof $(c).attr("is_not_exclusion_duplicate_approvers")){var g=$(c).attr("exclusion_approvers_category");"undefined"==typeof g&&(g="");var h=e[g],g=""+$(c).val(),k=[];""!=g&&(k=g.split(","));var l=[];Ext.each(k,function(){var a=""+this,b=a.toLowerCase(),
c=!1;"undefined"!=typeof h[b]&&2<=h[b]&&(--h[b],c=!0);0==c&&l.push(a)});ApproverCandidate.setNewApprovers(c,l,a)}$(c).attr("initializing","0")}}},initApprover:function(a,b,c,d){var e=!1,f=ApproverCandidate.isExistExclusionDuplicateApproversSetting(a);$("#"+a).find("input[name=process]").each(function(){$(this).attr("initializing","1")});$("#"+a).find("input[name=process]").each(function(){var d=this,h=$(this).attr("approver");"undefined"==typeof h&&(h="");$(this).hide();if(""!=h.trim()){var k=[],
l=[],n="",m="";for(i=0;i<h.length;i++){var q=h.charAt(i);"|"==q||"%"==q?(k.push(m),l.push(n),m="",n=""+q):m+=""+q}""!=m&&(k.push(m),l.push(n));ApproverCandidate.requestMultiApproverCandidate(k,l,0,"",b,c,function(b){ApproverCandidate.addApprover(d,b,a);f?$(d).attr("initializing","2"):$(d).attr("initializing","0");!e&&ApproverCandidate.checkInitApprover(a,!0)&&(e=!0,ApproverCandidate.exclusionDuplicateApprovers(a),$("#"+a).find("input[type=hidden][name=new_workflow_doc_init_approver_handler]").each(function(){var b=
this.onclick;"function"==typeof b&&b($("#"+a).parents("form")[0])}))})}else f?$(d).attr("initializing","2"):$(d).attr("initializing","0"),!e&&ApproverCandidate.checkInitApprover(a,!0)&&(e=!0,ApproverCandidate.exclusionDuplicateApprovers(a),$("#"+a).find("input[type=hidden][name=new_workflow_doc_init_approver_handler]").each(function(){var b=this.onclick;"function"==typeof b&&b($("#"+a).parents("form")[0])}))});d&&(Department1SelectWindow.bindButtonClickEvent(a),FieldConvert.bindUserSelectButtonEvent(a),
FieldConvert.bindClearApproverButtonEvent(a))},addApprover:function(a,b,c){var d=""+$(a).val(),e=[];""!=d&&(e=d.split(","));Ext.each(b,function(){var a=""+this;""!=a&&-1==e.indexOf(a)&&e.push(a)});ApproverCandidate.setNewApprovers(a,e,c)},setNewApprovers:function(a,b,c){var d=$(a).attr("number"),e=$("#"+c).find("input[name=process][current_approving=1]").attr("number"),f=$(a).attr("ok_to_remove_process_number"),g=$(a).attr("ok_to_open_notification_process_number"),h=!1,k=!1,l="";"template_body_new_doc"!=
c?(l=c.substring(14,c.length),"1"==$("#"+c).find("#in_resubmit_process_"+l).val()&&(h=!0),"1"==$("#"+c).find("#in_admin_edit_process_"+l).val()&&(k=!0)):l=NewDocWindow.newDocId;var n=!1;if(k)"1"==$(a).attr("ok_to_admin_edit")&&(n=!0);else if("undefined"!=typeof f&&"undefined"!=typeof e&&(f=f.split(" "),Ext.each(f,function(){this==e&&(n=!0)})),"template_body_new_doc"==c||h)f=$(a).attr("ok_to_remove"),"undefined"!=typeof f&&null!=f&&(n=!0);var m=!1;!k&&("undefined"!=typeof g&&"undefined"!=typeof e&&
(g=g.split(" "),Ext.each(g,function(){this==e&&(m=!0)})),"template_body_new_doc"==c||h)&&(h=$(a).attr("ok_to_open_notification"),"undefined"!=typeof h&&null!=h&&(m=!0));var q=WorkflowDoc.openNotifications[l];$(a).attr("value",Sateraito.Util.myImplode(b));$(a).attr("updated","1");var r=WorkflowDoc.createOpenNotifications(c);$("#"+c).find("span.approver_name_list[number="+d+"]").remove();var t=[];Ext.each(b,function(){var a=""+this,b;b=""+('<span title="'+Sateraito.Util.escapeHtml(a)+'">');b+=Sateraito.Util.escapeHtml(WorkflowUser.getUserName(a));
b+="</span>";if(m){var e=!1;if(null!=r){var g=r[d];if("undefined"!=typeof g&&"undefined"!=typeof g.target_approvers)for(g=g.target_approvers,i=0;i<g.length;i++){var f=g[i];if(a.toLowerCase()==f.toLowerCase()){e=!0;break}}}g=WorkflowDoc.getOpenNotificationStatus(q,d,a);e=e||g[0];IS_PRINT_WINDOW||(b=e?b+('<img src="'+SATERAITO_MY_SITE_URL+'/images/open_notification_on.png" class="btn_open_notification" email="'+a+'" status="on" style="padding-left:2px;height:14px;cursor:pointer;" onclick="ApproverCandidate.toggleOpenNotificationButton('+
d+", '"+a+"', '"+c+'\');" title="'+MyLang.getMsg("OPEN_NOTIFICATION_ON")+'">'):b+('<img src="'+SATERAITO_MY_SITE_URL+'/images/open_notification_off.png" class="btn_open_notification" email="'+a+'" status="off" style="padding-left:2px;height:14px;cursor:pointer;" onclick="ApproverCandidate.toggleOpenNotificationButton('+d+", '"+a+"', '"+c+'\');" title="'+MyLang.getMsg("OPEN_NOTIFICATION_OFF")+'">'))}!IS_PRINT_WINDOW&&n&&(b+='<img src="'+SATERAITO_MY_SITE_URL+'/images/btn_delete.png" style="cursor:pointer;" onclick="ApproverCandidate.removeApprover('+
d+", '"+a+"', '"+c+"');\">");t.push(b)});$(a).after('<span class="approver_name_list" number="'+d+'">'+Sateraito.Util.myImplode(t,", ")+"</span>")},toggleOpenNotificationButton:function(a,b,c){$("#"+c).find("span.approver_name_list[number="+a+"]").find("img.btn_open_notification[email='"+b+"']").each(function(){var a=$(this);"on"==a.attr("status")?(a.attr("src",SATERAITO_MY_SITE_URL+"/images/open_notification_off.png"),a.attr("status","off"),a.attr("title",MyLang.getMsg("OPEN_NOTIFICATION_OFF"))):
(a.attr("src",SATERAITO_MY_SITE_URL+"/images/open_notification_on.png"),a.attr("status","on"),a.attr("title",MyLang.getMsg("OPEN_NOTIFICATION_ON")))})},removeApprover:function(a,b,c){a=$("#"+c).find("input[name=process][number="+a+"]");var d=""+$(a).val(),e=[];""!=d&&(e=d.split(","));var f=[];Ext.each(e,function(){""+this!=b&&f.push(""+this)});ApproverCandidate.setNewApprovers(a,f,c)},requestApproverCandidate:function(a,b,c,d,e,f){"undefined"==typeof f&&(f=1);"undefined"==typeof d&&(d="");gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+
"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getapprovercandidate?filter="+encodeURIComponent(a)+"&additional_filter="+encodeURIComponent(b)+"&ghost_writer_of="+encodeURIComponent(c)+"&relative_doc_id="+encodeURIComponent(d)+"&hl="+SATERAITO_LANG,function(g){g.data?(g=g.data,Sateraito.MiniMessage.clearMessage(),e(g)):(Sateraito.Util.console("[getapprovercandidate]("+f+")"+g.errors[0]),401==g.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+
" "+f),f<Sateraito.EventController.MAX_RETRY?ApproverCandidate.requestApproverCandidate(a,b,c,d,e,f+1):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)))},Sateraito.Util.requestParam())},requestMultiApproverCandidate:function(a,b,c,d,e,f,g,h,k){"undefined"==typeof h&&(h=1);"undefined"==typeof f&&(f="");"undefined"==typeof k&&(k=[]);var l=a[c];"%"==b[c]&&0<k.length?a.length-1<=c?(Sateraito.MiniMessage.clearMessage(),g(k)):ApproverCandidate.requestMultiApproverCandidate(a,
b,c+1,d,e,f,g,0,k):gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getapprovercandidate?filter="+encodeURIComponent(l)+"&additional_filter="+encodeURIComponent(d)+"&ghost_writer_of="+encodeURIComponent(e)+"&relative_doc_id="+encodeURIComponent(f)+"&hl="+SATERAITO_LANG,function(l){l.data?(k=k.concat(l.data),a.length-1<=c?(Sateraito.MiniMessage.clearMessage(),g(k)):ApproverCandidate.requestMultiApproverCandidate(a,b,c+1,d,e,f,g,0,k)):(Sateraito.Util.console("[getapprovercandidate]("+
h+")"+l.errors[0]),401==l.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+h),h<Sateraito.EventController.MAX_RETRY?ApproverCandidate.requestMultiApproverCandidate(a,b,c,d,e,f,g,h+1,k):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)))},Sateraito.Util.requestParam())}};Department1SelectWindow={bindButtonClickEvent:function(a){$("#"+a).find("input[type=button].department_1_select_button").unbind("click",
!1);$("#"+a).find("input[type=button].department_1_select_button").bind("click",function(){var b=$(this).attr("process_number"),c=$(this).attr("additional_filter");if("undefined"==typeof c||null==c)c="";Department1SelectWindow.showWindow(b,a,c)});var b=!1,c="";"template_body_new_doc"!=a&&(c=a.substring(14,a.length),"1"==$("#"+a).find("#in_resubmit_process_"+c).val()&&(b=!0));("template_body_new_doc"==a||b)&&$("#template_body_new_doc").find("input[type=button].department_1_select_button").each(function(){null!=
$(this).attr("ok_to_show_process_number")&&$(this).hide()})},onSelectClick:function(a,b,c){var d=Ext.ComponentMgr.get("department_1_grid").selModel.getSelected();if("undefined"!=typeof d){var d=d.data.department_1,e=$("#"+b).find("input[name=process][number="+a+"]");ApproverCandidate.requestApproverCandidate("department_1:"+d,c,"","",function(a){ApproverCandidate.addApprover(e,a,b)});Ext.ComponentMgr.get("department_1_window").close()}},createGrid:function(a,b,c){Department1.dataStore=Department1.createDataStore();
var d=[];d.push({id:"department_1",header:MyLang.getMsg("DEPARTMENT_NAME"),width:200,menuDisabled:!0,sortable:!0,renderer:Sateraito.Util.vhBasic,dataIndex:"department_1"});return new Ext.grid.GridPanel({id:"department_1_grid",bodyStyle:"background-color:white;",columns:d,store:Department1.dataStore,plain:!0,stripeRows:!0,listeners:{rowdblclick:function(d,f,g){Department1SelectWindow.onSelectClick(a,b,c)},afterrender:function(){Department1.requestDepartment1List(!0,function(a){var b=[];Ext.each(a,
function(){b.push([""+this])});Department1.dataStore.loadData(b)})}}})},showWindow:function(a,b,c){var d=Ext.ComponentMgr.get("department_1_window");"undefined"!=typeof d&&null!=d?d.toFront():Department1.requestDepartment1List(!0,function(d){d=Ext.ComponentMgr.get("department_1_window");if("undefined"!=typeof d&&null!=d)d.toFront();else{d=Department1SelectWindow.createGrid(a,b,c);var f=[];f.push({text:MyLang.getMsg("SELECT"),handler:function(){Department1SelectWindow.onSelectClick(a,b,c)}});f.push({text:MyLang.getMsg("CANCEL"),
handler:function(){Ext.ComponentMgr.get("department_1_window").close()}});d=new Ext.Window({id:"department_1_window",width:250,height:SateraitoUI.getWindowHeightWithUserPrefs(200),title:MyLang.getMsg("SELECT_DEPARTMENT1"),plain:!0,autoScroll:!1,layout:"fit",items:[d],modal:!0,buttons:f});d.show();d.dd.constrainTo(Ext.getBody())}})}};UserSelectWindow={createDataStore:function(){return new Ext.data.ArrayStore({id:"user_info_store",fields:[{name:"email"},{name:"user_name"},{name:"department_1"}]})},
onSelectClick:function(a,b){var c=Ext.ComponentMgr.get("user_select_grid").selModel.getSelections();if("undefined"!=typeof c&&0<c.length){var d=[];Ext.each(c,function(){d.push(this.data.email)});c=$("#"+b).find("input[name=process][number="+a+"]");ApproverCandidate.addApprover(c,d,b);Ext.ComponentMgr.get("user_select_window").close()}},createGrid:function(a,b){var c=UserSelectWindow.createDataStore(),d=[];d.push({id:"email",header:MyLang.getMsg("FLD_EMAIL"),width:110,menuDisabled:!0,sortable:!0,renderer:Sateraito.Util.vhBasic,
dataIndex:"email"});d.push({id:"user_name",header:MyLang.getMsg("FLG_USER_NAME"),width:110,menuDisabled:!0,sortable:!0,renderer:Sateraito.Util.vhBasic,dataIndex:"user_name"});d.push({id:"department_1",header:MyLang.getMsg("FLD_DEPARTMENT_1"),width:110,menuDisabled:!0,sortable:!0,renderer:Sateraito.Util.vhBasic,dataIndex:"department_1"});return new Ext.grid.GridPanel({id:"user_select_grid",bodyStyle:"background-color:white;",columns:d,store:c,plain:!0,stripeRows:!0,listeners:{rowdblclick:function(c,
d,g){UserSelectWindow.onSelectClick(a,b)}}})},onSearchClick:function(){var a=Ext.data.Record.create([{name:"email"},{name:"user_name"},{name:"department_1"}]),b=Ext.ComponentMgr.get("user_select_grid").getStore();b.removeAll();var c=Ext.ComponentMgr.get("user_select_search_keyword").getValue(),c=c.trim(),d=0,e=function(a){return null==a?"":a};""==c?Ext.each(WorkflowUser.userList,function(){d++;if(100<d)return alert(MyLang.getMsg("MSG_SEARCH_RESULT_MORETHAN_MAX_RESULT_THRESHOLD")),!1;var c=e(this.user_email),
g=e(this.family_name)+" "+e(this.given_name),h=e(this.department_1),c=new a({email:c,user_name:g,department_1:h});b.add(c)}):Ext.each(WorkflowUser.userList,function(){var f=e(this.user_email),g=e(this.family_name)+" "+e(this.given_name),h=e(this.department_1);if(-1!=f.indexOf(c)||-1!=g.indexOf(c)||-1!=h.indexOf(c)){d++;if(100<d)return alert(MyLang.getMsg("MSG_SEARCH_RESULT_MORETHAN_MAX_RESULT_THRESHOLD")),!1;f=new a({email:f,user_name:g,department_1:h});b.add(f)}})},showWindow:function(a,b){var c=
Ext.ComponentMgr.get("user_select_window");if("undefined"!=typeof c&&null!=c)c.toFront();else if(c=Ext.ComponentMgr.get("user_select_window"),"undefined"!=typeof c&&null!=c)c.toFront();else{var c=UserSelectWindow.createGrid(a,b),d=[];d.push({text:MyLang.getMsg("SELECT"),handler:function(){UserSelectWindow.onSelectClick(a,b)}});d.push({text:MyLang.getMsg("CANCEL"),handler:function(){Ext.ComponentMgr.get("user_select_window").close()}});var e=new Ext.form.TextField({id:"user_select_search_keyword",
listeners:{specialkey:function(a,b){if(b.getKey()==b.ENTER)UserSelectWindow.onSearchClick()}}}),f=new Ext.Button({text:MyLang.getMsg("SEARCH"),handler:UserSelectWindow.onSearchClick});e.region="center";f.region="east";e=new Ext.Panel({height:30,layout:"border",items:[e,f]});e.region="north";c.region="center";c=new Ext.Window({id:"user_select_window",width:400,height:SateraitoUI.getWindowHeightWithUserPrefs(300),title:MyLang.getMsg("USER_SEARCH"),plain:!0,autoScroll:!1,layout:"border",modal:!0,items:[e,
c],buttons:d});c.show();c.dd.constrainTo(Ext.getBody())}}};OidMiniMessage={clearMessage:function(){$("#mini_message").html("")},showLoadingMessage:function(){$("#mini_message").html("");$("#mini_message").css("width","250px");var a=$("#mini_message").parent().width(),b=$("#mini_message").width();$("#mini_message").css("left",""+(a/2-b/2)+"px");$("#mini_message").text(MyLang.getMsg("LOADING")).css("width","250px").css("font-size","1.4em").css("font-weight","bold").css("background-color","lemonchiffon").css("text-align",
"center")},showNormalMiniMessage:function(a,b){"undefined"==typeof b&&(b=3E3);$("#mini_message").html("");$("#mini_message").css("width","350px");var c=$("#mini_message").parent().width(),d=$("#mini_message").width();$("#mini_message").css("left",""+(c/2-d/2)+"px");$("#mini_message").text(a).css("font-size","1.4em").css("width","350px").css("font-weight","bold").css("background-color","lemonchiffon").css("text-align","center");(function(){$("#mini_message").html("").css("width","0px")}).defer(b)},
showErrMiniMessage:function(a){$("#mini_message").html("");$("#mini_message").css("width","400px");var b=$("#mini_message").parent().width(),c=$("#mini_message").width();$("#mini_message").css("left",""+(b/2-c/2)+"px");$("#mini_message").text(a).css("font-size","1.2em").css("width","400px").css("font-weight","bold").css("background-color","pink").css("text-align","center");(function(){$("#mini_message").html("").css("width","0px")}).defer(3E3)}};Hanko={renderWaku:function(a){"undefined"!=typeof a&&
"undefined"!=typeof a.getContext&&(a=a.getContext("2d"),a.lineWidth=2,a.strokeStyle="red",a.stroke())},renderHanko:function(a,b,c,d,e){if("undefined"!=typeof b&&"undefined"!=typeof b.getContext){$(b).addClass("vml");var f=b.getContext("2d"),g=b.width/2;b=b.height/2;f.arc(g,b,a,0,2*Math.PI,!1);f.lineWidth=2;f.strokeStyle="red";f.stroke();var h=a*Math.cos(Math.PI/180*16),k=a*Math.sin(Math.PI/180*16);f.beginPath();f.moveTo(g+h,b+k);f.lineTo(g+-1*h,b+k);f.moveTo(g+h,b+-1*k);f.lineTo(g+-1*h,b+-1*k);f.stroke();
f.font="normal "+.35*a+"px '\uff2d\uff33 \u660e\u671d'";f.textAlign="center";f.textBaseline="middle";f.fillStyle="red";f.fillText(d,g,b);f.fillText(c,g,b-.6*a);c=function(a,b){for(var c=0,d=0,e=0;e<a.length;e++){var g=a.charCodeAt(e),d=0<=g&&129>g||63728==g||65377<=g&&65440>g||63729<=g&&63732>g?d+1:d+2;if(d>b){c=e;break}}return c};d=function(a){for(var b=0,c=0;c<a.length;c++)var d=a.charCodeAt(c),b=0<=d&&129>d||63728==d||65377<=d&&65440>d||63729<=d&&63732>d?b+1:b+2;return b}(e);13==d?(f.font="normal "+
.15*a+"px '\uff2d\uff33 \u660e\u671d'",f.fillText(e,g,b+.55*a)):13<d?(c=c(e,13),f.font="normal "+.15*a+"px '\uff2d\uff33 \u660e\u671d'",f.fillText(e.substring(0,c),g,b+.45*a),f.fillText(e.substring(c),g,b+.8*a)):f.fillText(e,g,b+.55*a)}}};UserSetting={userSetting:{},submitterSetting:{},getUserName:function(){return UserSetting.userSetting.family_name+" "+UserSetting.userSetting.given_name},requestUserSetting:function(a,b,c){"undefined"==typeof b&&(b="");IS_OPENID_MODE?UserSetting._requestUserSettingOid(a,
b,c):UserSetting._requestUserSetting(a,b,c)},_requestUserSetting:function(a,b,c){"undefined"==typeof c&&(c=1);DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getusersetting?ghost_writer_of="+encodeURIComponent(b)+"&hl="+SATERAITO_LANG,function(d){d.data?(d=d.data,Sateraito.MiniMessage.clearMessage(),"ok"==d.status&&""==b&&(UserSetting.userSetting=d.user_setting),a(d.status,d.user_setting)):
(Sateraito.Util.console("[getusersetting]("+c+")"+d.errors[0]),401==d.rc?(DisplayMgr.hideLoadMask(),Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT"))):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+c),c<Sateraito.EventController.MAX_RETRY?UserSetting._requestUserSetting(a,b,c+1):(DisplayMgr.hideLoadMask(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10))))},Sateraito.Util.requestParam())},_requestUserSettingOid:function(a,
b,c){"undefined"==typeof c&&(c=1);DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getusersetting?ghost_writer_of="+encodeURIComponent(b)+"&hl="+SATERAITO_LANG,success:function(c,e){var f=Ext.decode(c.responseText);"ok"==f.status&&""==b&&(UserSetting.userSetting=f.user_setting);OidMiniMessage.clearMessage();a(f.status,f.user_setting)},failure:function(){Sateraito.Util.console("retrying "+
c);c<Sateraito.EventController.MAX_RETRY?UserSetting._requestUserSettingOid(a,b,c+1):(DisplayMgr.hideLoadMask(),OidMiniMessage.clearMessage())}})},requestUpdateUserSetting:function(a,b){Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("UPDATING"));var c={deputy_approvers:a.deputy_approvers,ghost_writers:a.ghost_writers,language:a.language,timezone:a.timezone,token:MyUtil.getToken(),hl:SATERAITO_LANG};gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+
"/updateusersetting",function(a){a.data?(a=a.data,Sateraito.MiniMessage.clearMessage(),b(a)):(Sateraito.Util.console("[updateusersetting]"+a.errors[0]),401==a.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):403==a.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("MSG_CSRF_CHECK"),10):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_UPDATING"),10))},Sateraito.Util.requestParam(!0,c))}};ApproverCommentDict={requestApproverCommentDict:function(a,
b,c){IS_OPENID_MODE?ApproverCommentDict._requestApproverCommentDictOid(a,b,c):ApproverCommentDict._requestApproverCommentDict(a,b,c)},_requestApproverCommentDictOid:function(a,b,c,d){"undefined"==typeof d&&(d=1);DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getapprovercommentdict?doc_id="+a+"&process_number="+encodeURIComponent(b)+"&hl="+SATERAITO_LANG,success:function(a,b){var d=
Ext.decode(a.responseText);OidMiniMessage.clearMessage();c(d)},failure:function(){Sateraito.Util.console("retrying "+d);d<Sateraito.EventController.MAX_RETRY?ApproverCommentDict._requestApproverCommentDictOid(a,b,c,d+1):OidMiniMessage.clearMessage()}})},_requestApproverCommentDict:function(a,b,c,d){"undefined"==typeof d&&(d=1);DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getapprovercommentdict?doc_id="+
a+"&process_number="+encodeURIComponent(b)+"&hl="+SATERAITO_LANG,function(e){e.data?(e=e.data,Sateraito.MiniMessage.clearMessage(),c(e)):(Sateraito.Util.console("[getapprovercommentdict]("+d+")"+e.errors[0]),401==e.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+d),d<Sateraito.EventController.MAX_RETRY?ApproverCommentDict._requestApproverCommentDict(a,b,c,d+1):(Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),
10))))},Sateraito.Util.requestParam())}};QandA={postAnswer:function(a,b,c,d,e,f,g,h){IS_OPENID_MODE?QandA._postAnswerOid(a,b,c,d,e,f,g,h):QandA._postAnswer(a,b,c,d,e,f,g,h)},_postAnswer:function(a,b,c,d,e,f,g,h,k){"undefined"==typeof k&&(k=1);Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("UPDATING"));var l={};l.doc_id=a;l.q_and_a_name=b;l.question_no=c;l.answer_detail=d;l.word_for_question=e;l.is_stop_auto_approve_without_answer=f;l.expand_rate_approve_expire_date=g;l.hl=SATERAITO_LANG;l.token=
MyUtil.getToken();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/postanswer",function(a){Sateraito.MiniMessage.clearMessage();a.data?h(!0):(Sateraito.Util.console("[postanswer]("+k+")"+a.errors[0]),h(!1))},Sateraito.Util.requestParam(!0,l))},_postAnswerOid:function(a,b,c,d,e,f,g,h,k){"undefined"==typeof k&&(k=1);OidMiniMessage.showNormalMiniMessage(MyLang.getMsg("UPDATING"));k={};k.doc_id=a;k.q_and_a_name=b;k.question_no=c;k.answer_detail=d;k.word_for_question=
e;k.is_stop_auto_approve_without_answer=f;k.expand_rate_approve_expire_date=g;k.hl=SATERAITO_LANG;Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/postanswer",method:"POST",params:k,success:function(a,b){Ext.decode(a.responseText);OidMiniMessage.clearMessage();h(!0)},failure:function(){OidMiniMessage.clearMessage();h(!1)}})},postQuestion:function(a,b,c,d,e,f,g){IS_OPENID_MODE?QandA._postQuestionOid(a,b,c,d,e,f,g):QandA._postQuestion(a,b,c,d,e,f,
g)},_postQuestion:function(a,b,c,d,e,f,g,h){"undefined"==typeof h&&(h=1);Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("UPDATING"));var k={};k.doc_id=a;k.q_and_a_name=b;k.question_detail=c;k.word_for_question=d;k.is_stop_auto_approve_without_answer=e;k.expand_rate_approve_expire_date=f;k.hl=SATERAITO_LANG;k.token=MyUtil.getToken();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/postquestion",function(a){Sateraito.MiniMessage.clearMessage();
a.data?g(!0):(Sateraito.Util.console("[postquestion]("+h+")"+a.errors[0]),g(!1))},Sateraito.Util.requestParam(!0,k))},_postQuestionOid:function(a,b,c,d,e,f,g,h){"undefined"==typeof h&&(h=1);OidMiniMessage.showNormalMiniMessage(MyLang.getMsg("UPDATING"));h={};h.doc_id=a;h.q_and_a_name=b;h.question_detail=c;h.word_for_question=d;h.is_stop_auto_approve_without_answer=e;h.expand_rate_approve_expire_date=f;h.hl=SATERAITO_LANG;Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+
"/"+LoginMgr.appId+"/oid/postquestion",method:"POST",params:h,success:function(a,b){Ext.decode(a.responseText);OidMiniMessage.clearMessage();g(!0)},failure:function(){OidMiniMessage.clearMessage();g(!1)}})},requestQandAList:function(a,b,c){IS_OPENID_MODE?QandA._requestQandAListOid(a,b,c):QandA._requestQandAList(a,b,c)},_requestQandAListOid:function(a,b,c,d){"undefined"==typeof d&&(d=1);DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+
SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getqandalist?doc_id="+a+"&q_and_a_name="+encodeURIComponent(b)+"&hl="+SATERAITO_LANG,success:function(a,b){var d=Ext.decode(a.responseText);OidMiniMessage.clearMessage();c(d)},failure:function(){Sateraito.Util.console("retrying "+d);d<Sateraito.EventController.MAX_RETRY?QandA._requestQandAList(a,b,c,d+1):OidMiniMessage.clearMessage()}})},_requestQandAList:function(a,b,c,d){"undefined"==typeof d&&(d=1);DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();
gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getqandalist?doc_id="+a+"&q_and_a_name="+encodeURIComponent(b)+"&hl="+SATERAITO_LANG,function(e){e.data?(e=e.data,Sateraito.MiniMessage.clearMessage(),c(e)):(Sateraito.Util.console("[getqandalist]("+d+")"+e.errors[0]),401==e.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+d),d<Sateraito.EventController.MAX_RETRY?
QandA._requestQandAList(a,b,c,d+1):(Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10))))},Sateraito.Util.requestParam())}};ApproverList={renderApproverList:function(a,b,c,d,e,f,g){b=ApproverList.createApproverListHtml(b,c,d,e,f,g);$(a).html(b)},createApproverListHtml:function(a,b,c,d,e,f){var g="";Ext.each(a,function(){""!=g&&(g+=", ");var a="0";c==WorkflowDoc.PROCESS_STATUS_IN_PROCESS&&(a="1");g+='<span class="approver_name" email="'+
this+'" title="'+this+'">';g="undefined"!=typeof f[this]?g+Sateraito.Util.escapeHtml(f[this]):g+Sateraito.Util.escapeHtml(WorkflowUser.getUserName(this));g+="</span>";g+='<span class="approver_status" email="'+this+'" process_number="'+e+'" rendered="0" in_process="'+a+'" approve_type="'+d+'" ></span>'});return g}};WorkflowDoc={APPROVE_TYPE_APPROVE:"approve",APPROVE_TYPE_LOOK:"look",PROCESS_STATUS_IN_PROCESS:"in_process",STATUS_PASSED:"passed",STATUS_FINAL_APPROVED:"final_approved",STATUS_REJECTED:"rejected",
STATUS_SUBMITTED:"submitted",STATUS_IN_PROCESS:"in_process",DOC_STATUS_DRAFT:"draft",DOC_STATUS_FINAL_APPROVED:"final_approved",DOC_STATUS_REJECTED:"rejected",DOC_STATUS_IN_PROCESS:"in_process",DOC_STATUS_REMANDED:"remanded",COMMENT_STATUS_UPDATED:"updated",COMMENT_STATUS_REMANDED:"remanded",COMMENT_STATUS_RESUBMITTED:"resubmitted",docIds:{},relativeDocIds:{},relativeDocIdChains:{},updateMasterRows:[],docStatuses:{},openNotifications:{},getOpenNotificationStatus:function(a,b,c){var d=null,e=!1;if("undefined"!=
typeof a&&"undefined"!=typeof a[b]&&"undefined"!=typeof a[b].target_approvers){var f=a[b].target_approvers;for(i=0;i<f.length;i++){var g=f[i];if(c.toLowerCase()==g.toLowerCase()){e=!0;"undefined"!=typeof a[b].open_status_info&&(d=a[b].open_status_info[g.toLowerCase()]);break}}}return[e,d]},createOpenNotifications:function(a){var b=null;$("#"+a).find("span.approver_name_list").each(function(){var a=$(this);a.find("img.btn_open_notification").each(function(){var d=$(this),e=a.attr("number"),f=d.attr("email").toLowerCase();
null==b&&(b={});var g;"undefined"!=typeof b[e]?g=b[e]:(g={},b[e]=g);"undefined"!=typeof g.target_approvers?e=g.target_approvers:(e=[],g.target_approvers=e);"on"==d.attr("status")&&e.push(f)})});return b},appendMasterRowForUpdate:function(a,b,c,d,e,f,g){if("undefined"!=typeof b&&""!=b&&"undefined"!=typeof c&&""!=c){"undefined"==typeof e&&(e={});"undefined"==typeof f&&(f={});"undefined"==typeof d&&(d="");"undefined"==typeof g&&(g=!1);var h;"undefined"==typeof WorkflowDoc.updateMasterRows[a]?(h=[],WorkflowDoc.updateMasterRows[a]=
h):h=WorkflowDoc.updateMasterRows[a];h.push({master_code:b,data_key:c,update_data:e,update_options:f,target_approve_type:d,is_overwrite:g})}},initMasterRowForUpdate:function(a){"undefined"!=typeof WorkflowDoc.updateMasterRows[a]&&(WorkflowDoc.updateMasterRows[a]=[])},getMasterRowForUpdate:function(a){return"undefined"==typeof WorkflowDoc.updateMasterRows[a]?[]:WorkflowDoc.updateMasterRows[a]},createSerialNoDef:function(a){var b="template_body_new_doc",b=""!=a?"template_body_"+a:"template_body_new_doc",
c=[];$("#"+b).find(":input.serial_no").each(function(){var a=$(this),e=$(a).attr("name"),f=$(a).attr("key_fields"),g=$(a).attr("prefix_fields"),h=$(a).attr("suffix_fields"),k=$(a).attr("num_digits"),l=$(a).attr("start_from"),a=$(a).attr("approve_type"),n="";if("undefined"!=typeof f){var m=f.split(" ");Ext.each(m,function(){var a=$("#"+b).find(":input[name="+this+"]").val();"undefined"!=typeof a&&(n+=a)})}var q="";"undefined"!=typeof g&&(m=g.split(" "),Ext.each(m,function(){var a=$("#"+b).find(":input[name="+
this+"]").val();"undefined"!=typeof a&&(q+=a)}));var r="";"undefined"!=typeof h&&(m=h.split(" "),Ext.each(m,function(){var a=$("#"+b).find(":input[name="+this+"]").val();"undefined"!=typeof a&&(r+=a)}));c.push({field_to_set:e,auto_no_key:n,prefix_key:q,suffix_key:r,num_digits:k,start_from:l,key_fields:"undefined"!=typeof f?f:"",prefix_fields:"undefined"!=typeof g?g:"",suffix_fields:"undefined"!=typeof h?h:"",approve_type:"undefined"!=typeof a?a:""})});return c},createFinalApproveNoDef:function(a){var b=
"template_body_new_doc",b=""!=a?"template_body_"+a:"template_body_new_doc";a=null;var c=$("#"+b).find(":input.final_approve_no");if(0<c.length){a=$(c).attr("name");var d=$(c).attr("key_fields"),e=$(c).attr("prefix_fields"),f=$(c).attr("suffix_fields"),g=$(c).attr("num_digits"),h=$(c).attr("start_from"),c="undefined"==typeof $(c).attr("issue_with_reject")?!1:!0,k="";if(d){var l=d.split(" ");Ext.each(l,function(){var a=$("#"+b).find(":input[name="+this+"]").val();"undefined"!=typeof a&&(k+=a)})}var l=
!1,n="";if("undefined"!=typeof e){var l=!0,m=e.split(" ");Ext.each(m,function(){var a=$("#"+b).find(":input[name="+this+"]").val();"undefined"!=typeof a&&(n+=a)})}var q="";"undefined"!=typeof f&&(m=f.split(" "),Ext.each(m,function(){var a=$("#"+b).find(":input[name="+this+"]").val();"undefined"!=typeof a&&(q+=a)}));a={field_to_set:a,auto_no_key:k,prefix_key:n,suffix_key:q,is_exist_prefix_key:l,num_digits:g,start_from:h,issue_with_reject:c,key_fields:"undefined"!=typeof d?d:"",prefix_fields:"undefined"!=
typeof e?e:"",suffix_fields:"undefined"!=typeof f?f:""}}return a},createFinalApproveDateDef:function(a){var b=null;a=$("#"+(""!=a?"template_body_"+a:"template_body_new_doc")).find(":input.final_approve_date");0<a.length&&(b=$(a).attr("name"),a="undefined"==typeof $(a).attr("issue_with_reject")?!1:!0,b={field_to_set:b,issue_with_reject:a});return b},checkDuplicateCoverDate:function(a,b,c,d,e){IS_OPENID_MODE?WorkflowDoc._checkDuplicateCoverDateOid(a,b,c,d,e):WorkflowDoc._checkDuplicateCoverDate(a,b,
c,d,e)},_checkDuplicateCoverDateOid:function(a,b,c,d,e){Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/checkduplicatecoverdateforsubmitteddoc?doc_cover_date_from="+encodeURIComponent(b)+"&doc_cover_date_to="+encodeURIComponent(c)+"&doc_id="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,method:"POST",params:{},success:function(a,b){var c=Ext.decode(a.responseText);OidMiniMessage.clearMessage();d(c.result)},failure:function(){e<Sateraito.EventController.MAX_RETRY?
WorkflowDoc._checkDuplicateCoverDateOid(a,b,c,d,e+1):OidMiniMessage.clearMessage()}})},_checkDuplicateCoverDate:function(a,b,c,d,e){"undefined"==typeof e&&(e=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/checkduplicatecoverdateforsubmitteddoc?doc_cover_date_from="+encodeURIComponent(b)+"&doc_cover_date_to="+encodeURIComponent(c)+"&doc_id="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,function(f){f.data?(f=f.data,Sateraito.MiniMessage.clearMessage(),
d(f.result)):(Sateraito.Util.console("[checkduplicatecoverdateforsubmitteddoc]("+e+")"+f.errors[0]),401==f.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+e),e<Sateraito.EventController.MAX_RETRY?WorkflowDoc.checkDuplicateCoverDate(a,b,c,d,e+1):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)))},Sateraito.Util.requestParam())},checkAttachFiles:function(a,b,c){IS_OPENID_MODE?
WorkflowDoc._checkAttachFilesOid(a,b,c):WorkflowDoc._checkAttachFiles(a,b,c)},_checkAttachFilesOid:function(a,b,c){Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/checkattachfiles?doc_id="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,method:"POST",params:{},success:function(a,c){var f=Ext.decode(a.responseText);OidMiniMessage.clearMessage();b(f)},failure:function(){c<Sateraito.EventController.MAX_RETRY?WorkflowDoc._checkAttachFilesOid(a,b,c+1):
OidMiniMessage.clearMessage()}})},_checkAttachFiles:function(a,b,c){"undefined"==typeof c&&(c=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/checkattachfiles?doc_id="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,function(d){d.data?(d=d.data,Sateraito.MiniMessage.clearMessage(),b(d)):(Sateraito.Util.console("[checkattachfiles]("+c+")"+d.errors[0]),401==d.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+
" "+c),c<Sateraito.EventController.MAX_RETRY?WorkflowDoc.checkAttachFiles(a,b,c+1):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)))},Sateraito.Util.requestParam())},requestUpdateDoc:function(a,b,c,d,e,f,g,h,k){IS_OPENID_MODE?WorkflowDoc._requestUpdateDocOid(a,b,c,d,e,f,g,h,k):WorkflowDoc._requestUpdateDoc(a,b,c,d,e,f,g,h,k)},_requestUpdateDocOid:function(a,b,c,d,e,f,g,h,k){g={};g.doc_id=a;g.doc_values=Ext.encode(b);null!=c&&(g.approver_comment_detail=Ext.encode(c));
null!=f&&(g.update_approve_process=Ext.encode(f));g.user_name="undefined"!=typeof UserSetting.userSetting.family_name&&""!=UserSetting.userSetting.family_name||"undefined"!=typeof UserSetting.userSetting.given_name&&""!=UserSetting.userSetting.given_name?UserSetting.userSetting.family_name+" "+UserSetting.userSetting.given_name:"";g.without_comment=e;g.doc_comment=d;g.hl=SATERAITO_LANG;Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/updatedoc",
method:"POST",params:g,success:function(a,b){Ext.decode(a.responseText);OidMiniMessage.clearMessage();h(!0)},failure:function(){h(!1)}})},_requestUpdateDoc:function(a,b,c,d,e,f,g,h,k){g={};g.doc_id=a;g.doc_values=Ext.encode(b);null!=c&&(g.approver_comment_detail=Ext.encode(c));null!=f&&(g.update_approve_process=Ext.encode(f));g.user_name="undefined"!=typeof UserSetting.userSetting.family_name&&""!=UserSetting.userSetting.family_name||"undefined"!=typeof UserSetting.userSetting.given_name&&""!=UserSetting.userSetting.given_name?
UserSetting.userSetting.family_name+" "+UserSetting.userSetting.given_name:"";g.without_comment=e;g.doc_comment=d;g.hl=SATERAITO_LANG;g.token=MyUtil.getToken();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/updatedoc",function(a){a.data?(Sateraito.MiniMessage.clearMessage(),h(!0)):(Sateraito.Util.console("[updatedoc]("+k+")"+a.errors[0]),h(!1))},Sateraito.Util.requestParam(!0,g))},changeDocStatus:function(a,b,c,d,e,f,g,h,k,l,n){"undefined"==typeof f&&
(f=null);IS_OPENID_MODE?WorkflowDoc._changeDocStatusOid(a,b,c,d,e,f,g,h,k,l,n):WorkflowDoc._changeDocStatus(a,b,c,d,e,f,g,h,k,l,n)},_changeDocStatusOid:function(a,b,c,d,e,f,g,h,k,l,n){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof n&&(n=1);var m={doc_id:a,doc_comment:d,user_name:WorkflowUser.getUserName(LoginMgr.viewerEmail),status:b,approve_type:c,update_approve_process:Ext.encode(e),final_approve_no_def:Ext.encode(f),serial_no_def:Ext.encode(g),update_master_data_def:Ext.encode(h),
hl:SATERAITO_LANG,open_notifications:null!=k?Ext.encode(k):""};Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/changedocstatus",method:"POST",params:m,success:function(a,b){var c=Ext.decode(a.responseText);OidMiniMessage.clearMessage();l(c)},failure:function(){Sateraito.Util.console("retrying "+n);1>n?WorkflowDoc._changeDocStatusOid(a,b,c,d,e,f,g,h,k,l,n+1):OidMiniMessage.clearMessage()}})},_changeDocStatus:function(a,b,c,d,e,f,g,h,k,l,n){"undefined"==
typeof n&&(n=1);Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("UPDATING"));var m={doc_id:a,doc_comment:d,user_name:WorkflowUser.getUserName(LoginMgr.viewerEmail),status:b,approve_type:c,update_approve_process:Ext.encode(e),final_approve_no_def:Ext.encode(f),serial_no_def:Ext.encode(g),update_master_data_def:Ext.encode(h),open_notifications:null!=k?Ext.encode(k):"",token:MyUtil.getToken(),hl:SATERAITO_LANG};gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+
LoginMgr.appId+"/changedocstatus",function(m){m.data?(m=m.data,Sateraito.MiniMessage.clearMessage(),l(m)):(Sateraito.Util.console("[changedocstatus]("+n+")"+m.errors[0]),401==m.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):403==m.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("MSG_CSRF_CHECK"),10):1>n?(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("UPDATING")+" "+n),WorkflowDoc._changeDocStatus(a,b,c,d,e,f,g,h,k,l,n+1)):(Sateraito.MiniMessage.clearMessage(),
Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_UPDATING"),10)))},Sateraito.Util.requestParam(!0,m))},reSubmitDoc:function(a,b,c,d,e,f,g,h,k,l){"undefined"==typeof f&&(f=null);IS_OPENID_MODE?WorkflowDoc._reSubmitDocOid(a,b,c,d,e,f,g,h,k,l):WorkflowDoc._reSubmitDoc(a,b,c,d,e,f,g,h,k,l)},_reSubmitDocOid:function(a,b,c,d,e,f,g,h,k,l){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof l&&(l=1);var n={doc_id:a,doc_comment:d,doc_values:Ext.encode(c),
update_approve_process:Ext.encode(e),final_approve_no_def:Ext.encode(f),serial_no_def:Ext.encode(g),update_master_data_def:Ext.encode(h),template_body:b,hl:SATERAITO_LANG};Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/resubmitdoc",method:"POST",params:n,success:function(a,b){var c=Ext.decode(a.responseText);OidMiniMessage.clearMessage();k(c)},failure:function(){Sateraito.Util.console("retrying "+l);1>l?WorkflowDoc._reSubmitDocOid(a,b,c,d,e,f,
g,h,k,l+1):OidMiniMessage.clearMessage()}})},_reSubmitDoc:function(a,b,c,d,e,f,g,h,k,l){"undefined"==typeof l&&(l=1);Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("UPDATING"));var n={doc_id:a,doc_comment:d,doc_values:Ext.encode(c),update_approve_process:Ext.encode(e),final_approve_no_def:Ext.encode(f),serial_no_def:Ext.encode(g),update_master_data_def:Ext.encode(h),template_body:b,token:MyUtil.getToken(),hl:SATERAITO_LANG};gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+
"/"+LoginMgr.appId+"/resubmitdoc",function(m){m.data?(m=m.data,Sateraito.MiniMessage.clearMessage(),k(m)):(Sateraito.Util.console("[resubmitdoc]("+l+")"+m.errors[0]),401==m.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):403==m.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("MSG_CSRF_CHECK"),10):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("UPDATING")+" "+l),1>l?WorkflowDoc._reSubmitDoc(a,b,c,d,e,f,g,h,k,l+1):(Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_UPDATING"),
10))))},Sateraito.Util.requestParam(!0,n))},remandDocStatus:function(a,b,c,d,e,f){"undefined"==typeof aFinalApproveNoDef&&(aFinalApproveNoDef=null);IS_OPENID_MODE?WorkflowDoc._remandDocStatusOid(a,b,c,d,e,f):WorkflowDoc._remandDocStatus(a,b,c,d,e,f)},_remandDocStatusOid:function(a,b,c,d,e,f){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof f&&(f=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/remanddocstatus",
method:"POST",params:{doc_id:a,remand_process_number:c,current_approve_no:b,doc_comment:d,hl:SATERAITO_LANG},success:function(a,b){var c=Ext.decode(a.responseText);OidMiniMessage.clearMessage();e(c)},failure:function(){Sateraito.Util.console("retrying "+f);1>f?WorkflowDoc._remandDocStatusOid(a,b,c,d,e,f+1):OidMiniMessage.clearMessage()}})},_remandDocStatus:function(a,b,c,d,e,f){"undefined"==typeof f&&(f=1);Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("UPDATING"));var g={doc_id:a,remand_process_number:c,
current_approve_no:b,doc_comment:d,token:MyUtil.getToken(),hl:SATERAITO_LANG};gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/remanddocstatus",function(g){g.data?(g=g.data,Sateraito.MiniMessage.clearMessage(),e(g)):(Sateraito.Util.console("[remanddocstatus]("+f+")"+g.errors[0]),401==g.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):403==g.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("MSG_CSRF_CHECK"),10):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("UPDATING")+
" "+f),1>f?WorkflowDoc._remandDocStatus(a,b,c,d,e,f+1):(Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_UPDATING"),10))))},Sateraito.Util.requestParam(!0,g))},deleteDoc:function(a,b,c){IS_OPENID_MODE?WorkflowDoc._deleteDocOid(a,b,c):WorkflowDoc._deleteDoc(a,b,c)},_deleteDocOid:function(a,b,c){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof c&&(c=1);var d={doc_id:a,user_name:WorkflowUser.getUserName(LoginMgr.viewerEmail),
hl:SATERAITO_LANG};Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/deletedoc",method:"POST",params:d,success:function(a,c){var d=Ext.decode(a.responseText);if("error"==d.status){var h="",h="ALREADY_DELETE_DOC"==d.error_code?MyLang.getMsg("ERR_FAILED_DELETE_DOCUMENT_BY_ALREADY_DELETED"):MyLang.getMsg("ERR_FAILED_DELETE_DOCUMENT");alert(h);OidMiniMessage.clearMessage();b(!1)}else OidMiniMessage.clearMessage(),Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("MSG_DELETE_DOCUNENT")),
b(!0)},failure:function(){Sateraito.Util.console("retrying "+c);c<Sateraito.EventController.MAX_RETRY?WorkflowDoc._deleteDoc(a,b,c+1):OidMiniMessage.clearMessage()}})},_deleteDoc:function(a,b,c){"undefined"==typeof c&&(c=1);Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("DELETING"));var d={doc_id:a,user_name:WorkflowUser.getUserName(LoginMgr.viewerEmail),token:MyUtil.getToken(),hl:SATERAITO_LANG};gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+
"/deletedoc",function(d){if(d.data)if(d=d.data,"error"==d.status){var f="",f="ALREADY_DELETE_DOC"==d.error_code?MyLang.getMsg("ERR_FAILED_DELETE_DOCUMENT_BY_ALREADY_DELETED"):MyLang.getMsg("ERR_FAILED_DELETE_DOCUMENT");alert(f);b(!1)}else Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("MSG_DELETE_DOCUNENT")),b(!0);else Sateraito.Util.console("[deletedoc]("+c+")"+d.errors[0]),401==d.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):
403==d.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("MSG_CSRF_CHECK"),10):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RETRYING")+" "+c),c<Sateraito.EventController.MAX_RETRY?WorkflowDoc._deleteDoc(a,b,c+1):(Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERR_FAILED_DELETE_DOCUMENT"),10)))},Sateraito.Util.requestParam(!0,d))},getStatusName:function(a,b,c,d){var e="";c&&(e=MyLang.getMsg("AUTO"));"undefined"==typeof d&&(d="");return a==
WorkflowDoc.STATUS_PASSED&&b==WorkflowDoc.APPROVE_TYPE_LOOK?e+MyLang.getMsg("STATUS_LOOK_PASSED"):a==WorkflowDoc.STATUS_SUBMITTED?e+MyLang.getMsg("STATUS_SUBMITTED"):a==WorkflowDoc.STATUS_FINAL_APPROVED?""!=d?e+MyLang.getMsg("STATUS_FINAL_APPROVED_DEPUTY"):e+MyLang.getMsg("STATUS_FINAL_APPROVED"):a==WorkflowDoc.STATUS_PASSED?""!=d?e+MyLang.getMsg("STATUS_APPROVE_PASSED_DEPUTY"):e+MyLang.getMsg("STATUS_APPROVE_PASSED"):a==WorkflowDoc.STATUS_REJECTED?""!=d?e+MyLang.getMsg("STATUS_REJECTED_DEPUTY"):
e+MyLang.getMsg("STATUS_REJECTED"):a==WorkflowDoc.COMMENT_STATUS_REMANDED?""!=d?MyLang.getMsg("STATUS_REMANDED_DEPUTY"):MyLang.getMsg("STATUS_REMANDED"):a==WorkflowDoc.DOC_STATUS_DRAFT?MyLang.getMsg("STATUS_DRAFT"):a==WorkflowDoc.PROCESS_STATUS_IN_PROCESS?b==WorkflowDoc.APPROVE_TYPE_LOOK?MyLang.getMsg("STATUS_IN_PROCESS_LOOK"):MyLang.getMsg("STATUS_IN_PROCESS"):""},getShortStatusName:function(a,b,c,d){var e="";c&&(e=MyLang.getMsg("AUTO"));"undefined"==typeof d&&(d="");return a==WorkflowDoc.STATUS_PASSED&&
b==WorkflowDoc.APPROVE_TYPE_LOOK?e+MyLang.getMsg("STATUS_SHORT_LOOK_PASSED"):a==WorkflowDoc.STATUS_SUBMITTED?e+MyLang.getMsg("STATUS_SHORT_SUBMITTED"):a==WorkflowDoc.COMMENT_STATUS_RESUBMITTED?e+MyLang.getMsg("STATUS_SHORT_RESUBMITTED"):a==WorkflowDoc.STATUS_FINAL_APPROVED?""!=d?e+MyLang.getMsg("STATUS_SHORT_FINAL_APPROVED_DEPUTY"):e+MyLang.getMsg("STATUS_SHORT_FINAL_APPROVED"):a==WorkflowDoc.DOC_STATUS_DRAFT?e+MyLang.getMsg("STATUS_SHORT_DRAFT"):a==WorkflowDoc.STATUS_PASSED?""!=d?e+MyLang.getMsg("STATUS_SHORT_APPROVE_PASSED_DEPUTY"):
e+MyLang.getMsg("STATUS_SHORT_APPROVE_PASSED"):a==WorkflowDoc.STATUS_REJECTED?""!=d?e+MyLang.getMsg("STATUS_SHORT_REJECTED_DEPUTY"):e+MyLang.getMsg("STATUS_SHORT_REJECTED"):a==WorkflowDoc.STATUS_IN_PROCESS?e+MyLang.getMsg("STATUS_SHORT_IN_PROCESS_LOOK"):a==WorkflowDoc.COMMENT_STATUS_UPDATED?e+MyLang.getMsg("STATUS_SHORT_IN_PROCESS"):a==WorkflowDoc.COMMENT_STATUS_REMANDED?""!=d?e+MyLang.getMsg("STATUS_SHORT_REMANDED_DEPUTY"):e+MyLang.getMsg("STATUS_SHORT_REMANDED"):""},requestNewDocId:function(a,b){"undefined"==
typeof b&&(b=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getnewdocid?hl="+SATERAITO_LANG,function(c){c.data?a(c.data):(Sateraito.Util.console("[getnewdocid]("+b+")"+c.errors[0]),401==c.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+b),b<Sateraito.EventController.MAX_RETRY?WorkflowDoc.requestNewDocId(a,b+1):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("FAILED_TO_LOAD_SETTINGS"),
10)))},Sateraito.Util.requestParam())},requestDocDetail:function(a,b,c){IS_OPENID_MODE?WorkflowDoc._requestDocDetailOid(a,b,c):WorkflowDoc._requestDocDetail(a,b,c)},_requestDocDetailOid:function(a,b,c){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof c&&(c=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getdocdetail?doc_id="+a+"&hl="+SATERAITO_LANG,success:function(a,c){var f=Ext.decode(a.responseText);OidMiniMessage.clearMessage();
b(f)},failure:function(){Sateraito.Util.console("retrying "+c);c<Sateraito.EventController.MAX_RETRY?WorkflowDoc._requestDocDetailOid(a,b,c+1):OidMiniMessage.clearMessage()}})},_requestDocDetail:function(a,b,c){DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();"undefined"==typeof c&&(c=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getdocdetail?doc_id="+a+"&hl="+SATERAITO_LANG,function(d){d.data?(d=d.data,Sateraito.MiniMessage.clearMessage(),
b(d)):(Sateraito.Util.console("[getdocdetail]("+c+")"+d.errors[0]),401==d.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+c),c<Sateraito.EventController.MAX_RETRY?WorkflowDoc._requestDocDetail(a,b,c+1):(Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10))))},Sateraito.Util.requestParam())},requestCommentList:function(a,b,c){IS_OPENID_MODE?
WorkflowDoc._requestCommentListOid(a,b,c):WorkflowDoc._requestCommentList(a,b,c)},_requestCommentListOid:function(a,b,c){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof c&&(c=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getcommentlist?doc_id="+a+"&hl="+SATERAITO_LANG,success:function(a,c){var f=Ext.decode(a.responseText);OidMiniMessage.clearMessage();b(f)},failure:function(){Sateraito.Util.console("retrying "+
c);c<Sateraito.EventController.MAX_RETRY?WorkflowDoc._requestCommentListOid(a,b,c+1):OidMiniMessage.clearMessage()}})},_requestCommentList:function(a,b,c){DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();"undefined"==typeof c&&(c=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getcommentlist?doc_id="+a+"&hl="+SATERAITO_LANG,function(d){d.data?(d=d.data,Sateraito.MiniMessage.clearMessage(),b(d)):(Sateraito.Util.console("[getcommentlist]("+
c+")"+d.errors[0]),401==d.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+c),c<Sateraito.EventController.MAX_RETRY?WorkflowDoc._requestCommentList(a,b,c+1):(Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10))))},Sateraito.Util.requestParam())},requestOpenNotificationList:function(a,b,c){IS_OPENID_MODE?WorkflowDoc._requestOpenNotificationListOid(a,
b,c):WorkflowDoc._requestOpenNotificationList(a,b,c)},_requestOpenNotificationListOid:function(a,b,c){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof c&&(c=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getopennotificationlist?doc_id="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,success:function(c,e){var f=Ext.decode(c.responseText);OidMiniMessage.clearMessage();WorkflowDoc.openNotifications[a]=f;b(f)},
failure:function(){Sateraito.Util.console("retrying "+c);c<Sateraito.EventController.MAX_RETRY?WorkflowDoc._requestOpenNotificationListOid(a,b,c+1):OidMiniMessage.clearMessage()}})},_requestOpenNotificationList:function(a,b,c){DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();"undefined"==typeof c&&(c=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getopennotificationlist?doc_id="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,
function(d){d.data?(d=d.data,Sateraito.MiniMessage.clearMessage(),WorkflowDoc.openNotifications[a]=d,b(d)):(Sateraito.Util.console(d.errors[0]),401==d.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+c),c<Sateraito.EventController.MAX_RETRY?WorkflowDoc._requestOpenNotificationList(a,b,c+1):(Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),
10))))},Sateraito.Util.requestParam())},requestSendOpenNotification:function(a,b,c,d){IS_OPENID_MODE?WorkflowDoc._requestSendOpenNotificationOid(a,b,c,d):WorkflowDoc._requestSendOpenNotification(a,b,c,d)},_requestSendOpenNotificationOid:function(a,b,c,d){"undefined"==typeof d&&(d=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/sendopennotification?doc_id="+encodeURIComponent(a)+"&approve_number="+encodeURIComponent(b)+"&hl="+SATERAITO_LANG,
success:function(b,d){var g=Ext.decode(b.responseText);WorkflowDoc.openNotifications[a]=g;"undefined"!=typeof c&&c(g)},failure:function(){Sateraito.Util.console("retrying "+d);d<Sateraito.EventController.MAX_RETRY&&WorkflowDoc._requestSendOpenNotificationOid(a,b,c,d+1)}})},_requestSendOpenNotification:function(a,b,c,d){"undefined"==typeof d&&(d=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/sendopennotification?doc_id="+encodeURIComponent(a)+
"&approve_number="+encodeURIComponent(b)+"&hl="+SATERAITO_LANG,function(e){e.data?(e=e.data,WorkflowDoc.openNotifications[a]=e,"undefined"!=typeof c&&c(e)):(Sateraito.Util.console(e.errors[0]),401==e.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+d),d<Sateraito.EventController.MAX_RETRY&&WorkflowDoc._requestSendOpenNotification(a,b,c,d+1)))},Sateraito.Util.requestParam())},openGoogleDocViewer:function(a){var b=
$(a).attr("file_id"),c;c="undefined"==typeof APP_ID?LoginMgr.appId:APP_ID;WorkflowUser.requestOneTimeToken(c,function(a){a=a.token;a="http://drive.google.com/viewer?hl="+SATERAITO_LANG+"&url="+encodeURIComponent(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+c+"/attach/previewattachedfile?file_id="+encodeURIComponent(b)+"&ot_token="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG);window.open(a)})}};WorkflowUser={userListLoadingStatus:0,userList:[],requestUserList:function(a,b){IS_OPENID_MODE?
WorkflowUser._requestUserListOid(a,b):WorkflowUser._requestUserList(a,b)},_requestUserList:function(a,b){"undefined"==typeof b&&(b=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getwfuserlist?hl="+SATERAITO_LANG,function(c){c.data?(WorkflowUser.userListLoadingStatus=2,c=c.data,WorkflowUser.userList=c,"undefined"!=typeof a&&a(c)):(Sateraito.Util.console("[getwfuserlist]("+b+")"+c.errors[0]),401==c.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):
(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+b),b<Sateraito.EventController.MAX_RETRY?WorkflowUser._requestUserList(a,b+1):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("FAILED_TO_LOAD_USER_INFOMATION"),10),WorkflowUser.userListLoadingStatus=0)))},Sateraito.Util.requestParam())},_requestUserListOid:function(a,b){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof b&&(b=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+
"/"+LoginMgr.appId+"/oid/getwfuserlist?hl="+SATERAITO_LANG,success:function(b,d){var e=Ext.decode(b.responseText);WorkflowUser.userList=e;OidMiniMessage.clearMessage();"undefined"!=typeof a&&a(e)},failure:function(){Sateraito.Util.console("retrying "+b);b<Sateraito.EventController.MAX_RETRY?WorkflowUser._requestUserListOid(a,b+1):OidMiniMessage.clearMessage()}})},requestToken:function(a){IS_OPENID_MODE?WorkflowUser._requestTokenOid(a):WorkflowUser._requestToken(a)},_requestToken:function(a,b){"undefined"==
typeof b&&(b=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/gettoken?hl="+SATERAITO_LANG,function(c){c.data?a(c.data):(Sateraito.Util.console(c.errors[0]),SateraitoUI.showTimerMessage(MyLang.getMsg("RELOADING")+" "+b),b<Sateraito.EventController.MAX_RETRY?WorkflowUser._requestToken(a,b+1):401==c.rc?SateraitoUI.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):SateraitoUI.showTimerMessage(MyLang.getMsg("FAILED_TO_LOAD_SETTINGS"),10))},Sateraito.Util.requestParam())},
_requestTokenOid:function(a,b){OidMiniMessage.showLoadingMessage();"undefined"==typeof b&&(b=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/gettoken?hl="+SATERAITO_LANG,success:function(b,d){var e=Ext.decode(b.responseText);OidMiniMessage.clearMessage();a(e)},failure:function(){Sateraito.Util.console("retrying "+b);b<Sateraito.EventController.MAX_RETRY?WorkflowUser._requestTokenOid(a,b+1):OidMiniMessage.clearMessage()}})},requestOneTimeToken:function(a,
b,c){"undefined"==typeof gadgets?WorkflowUser._requestOneTimeTokenOid(a,b):WorkflowUser._requestOneTimeToken(a,b)},_requestOneTimeToken:function(a,b,c){"undefined"==typeof c&&(c=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+a+"/getonetimetoken?hl="+SATERAITO_LANG,function(d){d.data?b(d.data):(Sateraito.Util.console(d.errors[0]),c<Sateraito.EventController.MAX_RETRY&&WorkflowUser._requestOneTimeToken(a,b,c+1))},Sateraito.Util.requestParam())},_requestOneTimeTokenOid:function(a,
b,c){OidMiniMessage.showLoadingMessage();"undefined"==typeof c&&(c=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+a+"/oid/getonetimetoken?&token="+USER_TOKEN+"&hl="+SATERAITO_LANG,success:function(a,c){var f=Ext.decode(a.responseText);OidMiniMessage.clearMessage();b(f)},failure:function(){Sateraito.Util.console("retrying "+c);c<Sateraito.EventController.MAX_RETRY?WorkflowUser._requestOneTimeTokenOid(a,b,c+1):OidMiniMessage.clearMessage()}})},getUser:function(a){var b=
null;$.each(WorkflowUser.userList,function(c,d){if(d.user_email==a)return b=d,!1});return b},getUserByKey:function(a,b){var c=null;$.each(WorkflowUser.userList,function(d,e){if("employee_id"==b){if(e.employee_id==a)return c=e,!1}else if(e.user_email==a)return c=e,!1});return c},getUserName:function(a){var b=WorkflowUser.getUser(a);return null==b?a:b.family_name+" "+b.given_name}};Department1={department1List:null,dataStore:null,createDataStore:function(){return new Ext.data.ArrayStore({id:"store_department_1",
fields:[{name:"department_1"}]})},requestDepartment1List:function(a,b,c){a&&null!=Department1.department1List?b(Department1.department1List):IS_OPENID_MODE?Department1._requestDepartment1ListOid(a,b,c):Department1._requestDepartment1List(a,b,c)},_requestDepartment1List:function(a,b,c){"undefined"==typeof c&&(c=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getdepartment1list?hl="+SATERAITO_LANG,function(d){d.data?(d=d.data,Department1.department1List=
d,b(d)):(Sateraito.Util.console("[getdepartment1list]("+c+")"+d.errors[0]),401==d.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+c),c<Sateraito.EventController.MAX_RETRY&&Department1._requestDepartment1List(a,b,c+1)))},Sateraito.Util.requestParam())},_requestDepartment1ListOid:function(a,b,c){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof c&&(c=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+
"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getdepartment1list?hl="+SATERAITO_LANG,success:function(a,c){var f=Ext.decode(a.responseText);Department1.department1List=f;OidMiniMessage.clearMessage();b(f)},failure:function(){Sateraito.Util.console("retrying "+c);c<Sateraito.EventController.MAX_RETRY?Department1._requestDepartment1ListOid(a,b,c+1):OidMiniMessage.clearMessage()}})}};MasterData={dataStore:{},masterData:{},masterDef:{},masterRows:{},putToDatastore:function(a,b,c,d){var e=
[],f="";Ext.each(b,function(){e.push([this.master_code,this.data_key,this.attribute_1,this.attribute_2,this.attribute_3,this.attribute_4,this.attribute_5,this.attribute_6,this.attribute_7,this.attribute_8,this.attribute_9,this.attribute_10,this.attribute_11,this.attribute_12,this.attribute_13,this.attribute_14,this.attribute_15,this.attribute_16,this.attribute_17,this.attribute_18,this.attribute_19,this.attribute_20,this.attribute_21,this.attribute_22,this.attribute_23,this.attribute_24,this.attribute_25,
this.attribute_26,this.attribute_27,this.attribute_28,this.attribute_29,this.attribute_30,this.attribute_31,this.attribute_32,this.attribute_33,this.attribute_34,this.attribute_35,this.attribute_36,this.attribute_37,this.attribute_38,this.attribute_39,this.attribute_40,this.attribute_41,this.attribute_42,this.attribute_43,this.attribute_44,this.attribute_45,this.attribute_46,this.attribute_47,this.attribute_48,this.attribute_49,this.attribute_50,this.comment]);f=this.data_key});d&&e.push(["__read_more",
'<span class="link_cmd2" onclick="MasterData.requestAppendMasterAndPutToDatastore(\''+f+"', '"+a+"');\">"+MyLang.getMsg("READ_MORE")+"</span>",""]);b=MasterData.dataStore[a].find("master_code","__read_more");-1!=b&&MasterData.dataStore[a].removeAt(b);MasterData.dataStore[a].loadData(e,c)},requestAppendMasterAndPutToDatastore:function(a,b){MasterData.requestMasterData(b,"",!1,!0,!0,a,function(a,d){MasterData.putToDatastore(b,a,!0,d)})},putToDatastoreForMasterSelectWindow:function(a,b,c,d,e,f,g){var h=
"master_code data_key attribute_1 attribute_2 attribute_3 attribute_4 attribute_5 attribute_6 attribute_7 attribute_8 attribute_9 attribute_10 attribute_11 attribute_12 attribute_13 attribute_14 attribute_15 attribute_16 attribute_17 attribute_18 attribute_19 attribute_20 attribute_21 attribute_22 attribute_23 attribute_24 attribute_25 attribute_26 attribute_27 attribute_28 attribute_29 attribute_30 attribute_31 attribute_32 attribute_33 attribute_34 attribute_35 attribute_36 attribute_37 attribute_38 attribute_39 attribute_40 attribute_41 attribute_42 attribute_43 attribute_44 attribute_45 attribute_46 attribute_47 attribute_48 attribute_49 attribute_50 comment".split(" "),
k=[],l="";Ext.each(e,function(){var a=!0;0<d.length&&(a=-1!=d.indexOf(this.data_key)?!0:!1);if(a){var b=[],c=this;Ext.each(h,function(){b.push(c[this])});k.push(b);l=this.data_key}});if(g){e=Ext.encode(d);g=Ext.encode(c);var n=[];n.push("__read_more");for(i=1;i<h.length;i++)if(0==MasterWindow.getColWidth(c,h[i]))n.push("");else{n.push('<span class="link_cmd2" onclick="MasterData.requestAppendMasterAndPutToDatastoreForMasterSelectWindow(\''+l+"', '"+a+"', '"+encodeURIComponent(b)+"', '"+encodeURIComponent(g)+
"', '"+encodeURIComponent(e)+"');\">"+MyLang.getMsg("READ_MORE")+"</span>");break}k.push(n)}b=MasterData.dataStore[a].find("master_code","__read_more");-1!=b&&MasterData.dataStore[a].removeAt(b);MasterData.dataStore[a].loadData(k,f)},requestAppendMasterAndPutToDatastoreForMasterSelectWindow:function(a,b,c,d,e){e=decodeURIComponent(e);d=decodeURIComponent(d);c=decodeURIComponent(c);var f=Ext.decode(e),g=Ext.decode(d);MasterData.requestMasterData(b,c,!1,!1,!0,a,function(a,d){MasterData.putToDatastoreForMasterSelectWindow(b,
c,g,f,a,!0,d)})},createDataStore:function(a){return new Ext.data.ArrayStore({id:"store_master_data_"+a,fields:[{name:"master_code"},{name:"data_key"},{name:"attribute_1"},{name:"attribute_2"},{name:"attribute_3"},{name:"attribute_4"},{name:"attribute_5"},{name:"attribute_6"},{name:"attribute_7"},{name:"attribute_8"},{name:"attribute_9"},{name:"attribute_10"},{name:"attribute_11"},{name:"attribute_12"},{name:"attribute_13"},{name:"attribute_14"},{name:"attribute_15"},{name:"attribute_16"},{name:"attribute_17"},
{name:"attribute_18"},{name:"attribute_19"},{name:"attribute_20"},{name:"attribute_21"},{name:"attribute_22"},{name:"attribute_23"},{name:"attribute_24"},{name:"attribute_25"},{name:"attribute_26"},{name:"attribute_27"},{name:"attribute_28"},{name:"attribute_29"},{name:"attribute_30"},{name:"attribute_31"},{name:"attribute_32"},{name:"attribute_33"},{name:"attribute_34"},{name:"attribute_35"},{name:"attribute_36"},{name:"attribute_37"},{name:"attribute_38"},{name:"attribute_39"},{name:"attribute_40"},
{name:"attribute_41"},{name:"attribute_42"},{name:"attribute_43"},{name:"attribute_44"},{name:"attribute_45"},{name:"attribute_46"},{name:"attribute_47"},{name:"attribute_48"},{name:"attribute_49"},{name:"attribute_50"},{name:"comment"},{name:"created_date"}]})},requestDeleteMasterData:function(a,b){Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("UPDATING"));var c={master_code:a,token:MyUtil.getToken(),hl:SATERAITO_LANG};gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+
"/"+LoginMgr.appId+"/deletemaster",function(a){a.data?(a=a.data,Sateraito.MiniMessage.clearMessage(),b(a)):(Sateraito.Util.console("[deletemaster]"+a.errors[0]),alert(MyLang.getMsg("ERROR_WHILE_UPDATING")))},Sateraito.Util.requestParam(!0,c))},hasMasterDataCache:function(a){return"undefined"!=typeof MasterData.masterData[a]?!0:!1},requestMasterData:function(a,b,c,d,e,f,g,h){c&&"undefined"!=typeof MasterData.masterData[a]?g(MasterData.masterData[a]):("undefined"==typeof h&&(h=1),IS_OPENID_MODE?MasterData._requestMasterDataOid(a,
b,c,d,e,f,g,h):MasterData._requestMasterData(a,b,c,d,e,f,g,h))},_requestMasterData:function(a,b,c,d,e,f,g,h){DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();var k="getmasterdata";d&&(k="getmasterdataadmin");"undefined"==typeof c&&(c=!1);"undefined"==typeof e&&(e=!1);"undefined"==typeof f&&(f="");"undefined"==typeof b&&(b="");gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/"+k+"?master_code="+a+"&onlytoprecords="+encodeURIComponent(e)+
"&older_than_data_key="+encodeURIComponent(f)+"&search_keyword="+encodeURIComponent(b)+"&v=3&hl="+SATERAITO_LANG,function(l){if(l.data){Sateraito.MiniMessage.clearMessage();l=l.data;var n=l.master_datas,m=l.have_more_rows;"error"==l.status?"need_cached_data"==l.error_code?Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_GET_MASTER_DATA_BY_NEED_CACHED_DATA"),10):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10):(0!=e&&0!=m||""!=f||""!=b||(MasterData.masterData[a]=
n),g(n,m))}else Sateraito.Util.console("["+k+"]("+h+")"+l.errors[0]),401==l.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+h),h<Sateraito.EventController.MAX_RETRY?MasterData._requestMasterData(a,b,c,d,e,f,g,h+1):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10))},Sateraito.Util.requestParam())},_requestMasterDataOid:function(a,b,c,d,e,f,g,h){DisplayMgr.isLoadMaskShown()||
OidMiniMessage.showLoadingMessage();var k="getmasterdata";d&&(k="getmasterdataadmin");"undefined"==typeof c&&(c=!1);"undefined"==typeof e&&(e=!1);"undefined"==typeof f&&(f="");"undefined"==typeof b&&(b="");Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/"+k+"?master_code="+a+"&onlytoprecords="+encodeURIComponent(e)+"&older_than_data_key="+encodeURIComponent(f)+"&search_keyword="+encodeURIComponent(b)+"&v=3&hl="+SATERAITO_LANG,success:function(c,
d){var h=Ext.decode(c.responseText),k=h.master_datas,h=h.have_more_rows;OidMiniMessage.clearMessage();0!=e&&0!=h||""!=f||""!=b||(MasterData.masterData[a]=k);g(k,h)},failure:function(){OidMiniMessage.showErrMiniMessage(MyLang.getMsg("RELOADING")+" "+h);h<Sateraito.EventController.MAX_RETRY?MasterData._requestMasterDataOid(a,b,c,d,e,f,g,h+1):OidMiniMessage.showErrMiniMessage(MyLang.getMsg("ERROR_WHILE_LOADING"))}})},requestMasterDataRow:function(a,b,c,d){"undefined"==typeof d&&(d=1);IS_OPENID_MODE?
MasterData._requestMasterDataRowOid(a,b,c,d):MasterData._requestMasterDataRow(a,b,c,d)},_requestMasterDataRow:function(a,b,c,d){DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();var e={data_key:b};gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getmasterdatarow?master_code="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,function(e){e.data?(e=e.data,Sateraito.MiniMessage.clearMessage(),c(e)):(Sateraito.Util.console("[getmasterdatarow]("+
d+")"+e.errors[0]),401==e.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+d),d<Sateraito.EventController.MAX_RETRY?MasterData.requestMasterDataRow(a,b,c,d+1):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)))},Sateraito.Util.requestParam(!0,e))},_requestMasterDataRowOid:function(a,b,c,d){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();var e={data_key:b};
Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getmasterdatarow?master_code="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,params:e,success:function(a,b){var d=Ext.decode(a.responseText);OidMiniMessage.clearMessage();c(d)},failure:function(){OidMiniMessage.showErrMiniMessage(MyLang.getMsg("RELOADING")+" "+d);d<Sateraito.EventController.MAX_RETRY?MasterData._requestMasterDataRowOid(a,b,c,d+1):OidMiniMessage.showErrMiniMessage(MyLang.getMsg("ERROR_WHILE_LOADING"))}})},
requestMasterReferenceChain:function(a,b,c,d){"undefined"==typeof d&&(d=0);if(a.length<=d)b();else{"undefined"==typeof c&&(c={});var e=a[d],f=e.master_code,g=e.data_key,h;"undefined"==typeof MasterData.masterRows[f]?(h={},MasterData.masterRows[f]=h):h=MasterData.masterRows[f];if("undefined"==typeof h[g])if("undefined"!=typeof MasterData.masterData[f]){var k;"undefined"==typeof c[f]?(k={},Ext.each(MasterData.masterData[f],function(){k[this.data_key]=this}),c[f]=k):k=c[f];"undefined"!=typeof k[g]?(h[g]=
k[g],a.length-1==d?b():MasterData.requestMasterReferenceChain(a,b,c,d+1)):MasterData.requestMasterDataRow(f,g,function(e){h[g]=e;a.length-1==d?b():MasterData.requestMasterReferenceChain(a,b,c,d+1)})}else MasterData.requestMasterDataRow(f,g,function(e){h[g]=e;a.length-1==d?b():MasterData.requestMasterReferenceChain(a,b,c,d+1)});else a.length-1==d?b():MasterData.requestMasterReferenceChain(a,b,c,d+1)}},requestMasterDef:function(a,b,c,d){b&&"undefined"!=typeof MasterData.masterDef[a]?c(MasterData.masterDef[a]):
("undefined"==typeof d&&(d=1),IS_OPENID_MODE?MasterData._requestMasterDefOid(a,b,c,d):MasterData._requestMasterDef(a,b,c,d))},_requestMasterDefOid:function(a,b,c,d){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getmasterdef?master_code="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,success:function(b,d){var g=Ext.decode(b.responseText);OidMiniMessage.clearMessage();MasterData.masterDef[a]=
g;c(g)},failure:function(){OidMiniMessage.showErrMiniMessage(MyLang.getMsg("RELOADING")+" "+d);d<Sateraito.EventController.MAX_RETRY?DocDetailWindow._requestMasterDefOid(a,b,c,d+1):OidMiniMessage.showErrMiniMessage(MyLang.getMsg("ERROR_WHILE_LOADING"))}})},_requestMasterDef:function(a,b,c,d){DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getmasterdef?master_code="+encodeURIComponent(a)+
"&hl="+SATERAITO_LANG,function(e){e.data?(e=e.data,Sateraito.MiniMessage.clearMessage(),MasterData.masterDef[a]=e,c(e)):(Sateraito.Util.console("[getmasterdef]("+d+")"+e.errors[0]),401==e.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+d),d<Sateraito.EventController.MAX_RETRY?MasterData.requestMasterDef(a,b,c,d+1):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)))},Sateraito.Util.requestParam())},
requestMasterDefList:function(a,b){"undefined"==typeof b&&(b=1);DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getmasterlist?hl="+SATERAITO_LANG,function(c){c.data?(c=c.data,Sateraito.MiniMessage.clearMessage(),a(c)):(Sateraito.Util.console("[getmasterlist]("+b+")"+c.errors[0]),401==c.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+
" "+b),b<Sateraito.EventController.MAX_RETRY?MasterData.requestMasterDefList(a,b+1):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)))},Sateraito.Util.requestParam())}};MasterWindow={masterSelectFormButtonClick:function(a,b){var c=$(a).attr("window_width");"undefined"!=typeof c&&null!=c&&""!=c&&isNaN(c)&&(c="");var d=$(a).attr("window_height");"undefined"!=typeof d&&null!=d&&""!=d&&isNaN(d)&&(d="");var e=$(a).attr("assign").split(";"),f=[];Ext.each(e,function(){var a=
(""+this).split(":");f.push({colName:a[0],inputNameToApplyValue:a[1]})});var g=[],e=$(a).attr("col_width");"undefined"!=typeof e&&(e=e.split(";"),Ext.each(e,function(){var a=(""+this).split(":");g.push({colName:a[0],colWidth:a[1]})}));var e=$(a).attr("limit_selection"),h=[];"undefined"!=typeof e&&null!=e&&""!=e&&(e=e.split(" "),Ext.each(e,function(){h.push(""+this)}));e=$(a).attr("master_code");MasterWindow.showWindow(e,f,g,h,b,c,d,function(c){var d=Ext.getCmp("doc_detail_window_"+b);if("undefined"!=
typeof d.wfEventHandler&&"function"==typeof d.wfEventHandler.onMasterSelected)(0,d.wfEventHandler.onMasterSelected)(a,c)})},onSelectClick:function(a,b,c,d){var e=Ext.ComponentMgr.get("master_data_grid_"+a).selModel.getSelected();"undefined"!=typeof e&&(Ext.each(b,function(){var a=this.inputNameToApplyValue,b=e.data[this.colName];$("#template_body_"+c).find(":input[name="+a+"]").each(function(){$(this).hasClass("number")?(b=NumUtil.addComma(NumUtil.removeComma(b)),$(this).val(b)):$(this).is("textarea")?
$(this).val(b).trigger("autosize.resize"):$(this).is(":checkbox")?0<=(","+b+",").indexOf(","+$(this).val()+",")?$(this).attr("checked","checked"):$(this).removeAttr("checked"):$(this).val(b)})}),Calc.calcAll("template_body_"+c),FieldConvert.masterReferenceAll("template_body_"+c),Ext.ComponentMgr.get("master_window_"+a).close(),d(e.data))},onSearchClick:function(a,b,c){var d=Ext.ComponentMgr.get("search_keyword").getValue(),e=Ext.ComponentMgr.get("master_data_grid_"+a);if(e){var f=e.getStore();f.removeAll();
if("undefined"==typeof MasterData.masterData[a])MasterData.requestMasterData(a,d,!1,!1,!0,"",function(e,g){MasterData.putToDatastoreForMasterSelectWindow(a,d,b,c,e,!1,g)});else{var g=Ext.data.Record.create([{name:"master_code"},{name:"data_key"},{name:"attribute_1"},{name:"attribute_2"},{name:"attribute_3"},{name:"attribute_4"},{name:"attribute_5"},{name:"attribute_6"},{name:"attribute_7"},{name:"attribute_8"},{name:"attribute_9"},{name:"attribute_10"},{name:"attribute_11"},{name:"attribute_12"},
{name:"attribute_13"},{name:"attribute_14"},{name:"attribute_15"},{name:"attribute_16"},{name:"attribute_17"},{name:"attribute_18"},{name:"attribute_19"},{name:"attribute_20"},{name:"attribute_21"},{name:"attribute_22"},{name:"attribute_23"},{name:"attribute_24"},{name:"attribute_25"},{name:"attribute_26"},{name:"attribute_27"},{name:"attribute_28"},{name:"attribute_29"},{name:"attribute_30"},{name:"attribute_31"},{name:"attribute_32"},{name:"attribute_33"},{name:"attribute_34"},{name:"attribute_35"},
{name:"attribute_36"},{name:"attribute_37"},{name:"attribute_38"},{name:"attribute_39"},{name:"attribute_40"},{name:"attribute_41"},{name:"attribute_42"},{name:"attribute_43"},{name:"attribute_44"},{name:"attribute_45"},{name:"attribute_46"},{name:"attribute_47"},{name:"attribute_48"},{name:"attribute_49"},{name:"attribute_50"},{name:"created_date"}]),e=MasterData.masterData[a];""==d?Ext.each(e,function(){var a=!0;c&&0<c.length&&(a=-1!=c.indexOf(this.data_key)?!0:!1);a&&(a=new g({master_code:this.master_code,
data_key:this.data_key,attribute_1:this.attribute_1,attribute_2:this.attribute_2,attribute_3:this.attribute_3,attribute_4:this.attribute_4,attribute_5:this.attribute_5,attribute_6:this.attribute_6,attribute_7:this.attribute_7,attribute_8:this.attribute_8,attribute_9:this.attribute_9,attribute_10:this.attribute_10,attribute_11:this.attribute_11,attribute_12:this.attribute_12,attribute_13:this.attribute_13,attribute_14:this.attribute_14,attribute_15:this.attribute_15,attribute_16:this.attribute_16,
attribute_17:this.attribute_17,attribute_18:this.attribute_18,attribute_19:this.attribute_19,attribute_20:this.attribute_20,attribute_21:this.attribute_21,attribute_22:this.attribute_22,attribute_23:this.attribute_23,attribute_24:this.attribute_24,attribute_25:this.attribute_25,attribute_26:this.attribute_26,attribute_27:this.attribute_27,attribute_28:this.attribute_28,attribute_29:this.attribute_29,attribute_30:this.attribute_30,attribute_31:this.attribute_31,attribute_32:this.attribute_32,attribute_33:this.attribute_33,
attribute_34:this.attribute_34,attribute_35:this.attribute_35,attribute_36:this.attribute_36,attribute_37:this.attribute_37,attribute_38:this.attribute_38,attribute_39:this.attribute_39,attribute_40:this.attribute_40,attribute_41:this.attribute_41,attribute_42:this.attribute_42,attribute_43:this.attribute_43,attribute_44:this.attribute_44,attribute_45:this.attribute_45,attribute_46:this.attribute_46,attribute_47:this.attribute_47,attribute_48:this.attribute_48,attribute_49:this.attribute_49,attribute_50:this.attribute_50}),
f.add(a))}):Ext.each(e,function(){var a=!0;c&&0<c.length&&(a=-1!=c.indexOf(this.data_key)?!0:!1);!a||-1==this.data_key.indexOf(d)&&-1==this.attribute_1.indexOf(d)&&-1==this.attribute_2.indexOf(d)&&-1==this.attribute_3.indexOf(d)&&-1==this.attribute_4.indexOf(d)&&-1==this.attribute_5.indexOf(d)&&-1==this.attribute_6.indexOf(d)&&-1==this.attribute_7.indexOf(d)&&-1==this.attribute_8.indexOf(d)&&-1==this.attribute_9.indexOf(d)&&-1==this.attribute_10.indexOf(d)&&-1==this.attribute_11.indexOf(d)&&-1==this.attribute_12.indexOf(d)&&
-1==this.attribute_13.indexOf(d)&&-1==this.attribute_14.indexOf(d)&&-1==this.attribute_15.indexOf(d)&&-1==this.attribute_16.indexOf(d)&&-1==this.attribute_17.indexOf(d)&&-1==this.attribute_18.indexOf(d)&&-1==this.attribute_19.indexOf(d)&&-1==this.attribute_20.indexOf(d)&&-1==this.attribute_21.indexOf(d)&&-1==this.attribute_22.indexOf(d)&&-1==this.attribute_23.indexOf(d)&&-1==this.attribute_24.indexOf(d)&&-1==this.attribute_25.indexOf(d)&&-1==this.attribute_26.indexOf(d)&&-1==this.attribute_27.indexOf(d)&&
-1==this.attribute_28.indexOf(d)&&-1==this.attribute_29.indexOf(d)&&-1==this.attribute_30.indexOf(d)&&-1==this.attribute_31.indexOf(d)&&-1==this.attribute_32.indexOf(d)&&-1==this.attribute_33.indexOf(d)&&-1==this.attribute_34.indexOf(d)&&-1==this.attribute_35.indexOf(d)&&-1==this.attribute_36.indexOf(d)&&-1==this.attribute_37.indexOf(d)&&-1==this.attribute_38.indexOf(d)&&-1==this.attribute_39.indexOf(d)&&-1==this.attribute_40.indexOf(d)&&-1==this.attribute_41.indexOf(d)&&-1==this.attribute_42.indexOf(d)&&
-1==this.attribute_43.indexOf(d)&&-1==this.attribute_44.indexOf(d)&&-1==this.attribute_45.indexOf(d)&&-1==this.attribute_46.indexOf(d)&&-1==this.attribute_47.indexOf(d)&&-1==this.attribute_48.indexOf(d)&&-1==this.attribute_49.indexOf(d)&&-1==this.attribute_50.indexOf(d)||(a=new g({master_code:this.master_code,data_key:this.data_key,attribute_1:this.attribute_1,attribute_2:this.attribute_2,attribute_3:this.attribute_3,attribute_4:this.attribute_4,attribute_5:this.attribute_5,attribute_6:this.attribute_6,
attribute_7:this.attribute_7,attribute_8:this.attribute_8,attribute_9:this.attribute_9,attribute_10:this.attribute_10,attribute_11:this.attribute_11,attribute_12:this.attribute_12,attribute_13:this.attribute_13,attribute_14:this.attribute_14,attribute_15:this.attribute_15,attribute_16:this.attribute_16,attribute_17:this.attribute_17,attribute_18:this.attribute_18,attribute_19:this.attribute_19,attribute_20:this.attribute_20,attribute_21:this.attribute_21,attribute_22:this.attribute_22,attribute_23:this.attribute_23,
attribute_24:this.attribute_24,attribute_25:this.attribute_25,attribute_26:this.attribute_26,attribute_27:this.attribute_27,attribute_28:this.attribute_28,attribute_29:this.attribute_29,attribute_30:this.attribute_30,attribute_31:this.attribute_31,attribute_32:this.attribute_32,attribute_33:this.attribute_33,attribute_34:this.attribute_34,attribute_35:this.attribute_35,attribute_36:this.attribute_36,attribute_37:this.attribute_37,attribute_38:this.attribute_38,attribute_39:this.attribute_39,attribute_40:this.attribute_40,
attribute_41:this.attribute_41,attribute_42:this.attribute_42,attribute_43:this.attribute_43,attribute_44:this.attribute_44,attribute_45:this.attribute_45,attribute_46:this.attribute_46,attribute_47:this.attribute_47,attribute_48:this.attribute_48,attribute_49:this.attribute_49,attribute_50:this.attribute_50}),f.add(a))})}}else alert(MyLang.getMsg("MSG_NOT_REGIST_THE_MASTER")+"master_code=["+a+"]")},getColWidth:function(a,b){var c=100;Ext.each(a,function(){if(""+this.colName==b)return c=parseInt(this.colWidth,
10),isNaN(c)&&(c=100),!1});return c},createMasterDataGrid:function(a,b,c,d,e,f){"undefined"==typeof MasterData.dataStore[a.master_code]&&(MasterData.dataStore[a.master_code]=MasterData.createDataStore(a.master_code));var g=[],h=!1;0==MasterWindow.getColWidth(c,"data_key")&&(h=!0);g.push({id:"data_key",header:a.data_key_name,width:MasterWindow.getColWidth(c,"data_key"),menuDisabled:!0,sortable:!0,hidden:h,renderer:MyPanel.vhForMasterGrid,dataIndex:"data_key"});for(var k=1;20>=k;k++){var l=a["attribute_"+
k+"_name"];if(l&&""!=l){var n=MasterWindow.getColWidth(c,"attribute_"+k),h=!1;0==n&&(h=!0);g.push({id:"attribute"+k,header:l,width:n,hidden:h,menuDisabled:!0,sortable:!0,renderer:MyPanel.vhForMasterGrid,dataIndex:"attribute_"+k})}}return new Ext.grid.GridPanel({id:"master_data_grid_"+a.master_code,bodyStyle:"background-color:white;",columns:g,store:MasterData.dataStore[a.master_code],plain:!0,stripeRows:!0,listeners:{rowdblclick:function(c,d,g){MasterWindow.onSelectClick(a.master_code,b,e,f)},afterrender:function(){"undefined"!=
typeof MasterData.masterData[a.master_code]?MasterData.requestMasterData(a.master_code,"",!0,!1,!1,"",function(b,e){MasterData.putToDatastoreForMasterSelectWindow(a.master_code,"",c,d,b,!1,e)}):("undefined"==typeof MasterData.dataStore[a.master_code]||0>=MasterData.dataStore[a.master_code].data.length)&&MasterData.requestMasterData(a.master_code,"",!1,!1,!0,"",function(b,e){MasterData.putToDatastoreForMasterSelectWindow(a.master_code,"",c,d,b,!1,e)})}}})},showWindow:function(a,b,c,d,e,f,g,h){var k=
Ext.ComponentMgr.get("master_window_"+a);"undefined"!=typeof k&&null!=k?k.toFront():MasterData.requestMasterDef(a,!0,function(k){var n=Ext.ComponentMgr.get("master_window_"+a);if("undefined"!=typeof n&&null!=n)n.toFront();else{var n=MasterWindow.createMasterDataGrid(k,b,c,d,e,h),m=[];m.push({text:MyLang.getMsg("SELECT"),handler:function(){MasterWindow.onSelectClick(a,b,e,h)}});m.push({text:MyLang.getMsg("CANCEL"),handler:function(){Ext.ComponentMgr.get("master_window_"+a).close()}});var q=new Ext.form.TextField({id:"search_keyword",
listeners:{specialkey:function(b,e){if(e.getKey()==e.ENTER)MasterWindow.onSearchClick(a,c,d)}}}),r=new Ext.Button({text:MyLang.getMsg("SEARCH"),handler:function(){MasterWindow.onSearchClick(a,c,d)}});q.region="center";r.region="east";q=new Ext.Panel({height:30,layout:"border",items:[q,r]});q.region="north";n.region="center";r=600;isNaN(f)||(r=parseInt(f,10));var t=SateraitoUI.getWindowHeightWithUserPrefs(300);isNaN(g)||(t=parseInt(g,10));k=new Ext.Window({id:"master_window_"+a,width:r,height:t,title:k.master_name,
plain:!0,autoScroll:!1,modal:!0,layout:"border",items:[q,n],buttons:m});k.show();k.dd.constrainTo(Ext.getBody())}})}};AttachFileToCommentWindow={showWindow:function(a,b,c){var d=function(d){var f="",f=IS_OPENID_MODE?f+('<iframe src="'+SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/attach/oid/attachfiletocomment"):f+('<iframe src="'+SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/attach/attachfiletocomment"),f=f+("?token="+d)+("&doc_id="+a),
f=f+("&hl="+SATERAITO_LANG),f=f+("&is_print_window="+(IS_PRINT_WINDOW?"1":"0")),f=f+("&comment_id="+b+'"'),f=f+' style="width:99%;height:98%;border: 1px solid #b5b8c8;">',f=f+"</iframe>";d=new Ext.Panel({autoWidth:!0,autoScroll:!1,html:f});f=[];f.push({text:MyLang.getMsg("MSG_CLOSE"),handler:function(){Ext.getCmp("file_attach_to_comment_window").close()}});d=new Ext.Window({id:"file_attach_to_comment_window",width:600,height:130,modal:!0,bodyStyle:"background-color:white;",title:MyLang.getMsg("DOC_COMMENT_ATTACHMENT_TITLE"),
plain:!0,autoScroll:!1,layout:"fit",items:[d],buttons:f});d.show();d.dd.constrainTo(Ext.getBody());d=function(a){if(a.origin==SATERAITO_MY_SITE_URL){var b=Ext.getCmp("file_attach_to_comment_window");b&&b.close();"new_file_attached"==""+a.data&&c(!0)}};window.addEventListener?window.addEventListener("message",d,!1):window.attachEvent&&window.attachEvent("onmessage",d)};IS_OPENID_MODE?d(""):WorkflowUser.requestToken(function(a){d(a.token)})}};Calc={checkAllFieldsCalced:function(a){var b=!0,c;c=$("#"+
a).find("input.multi[calced=0]");0<c.length&&(b=!1);c=$("#"+a).find("input.divide[calced=0]");0<c.length&&(b=!1);c=$("#"+a).find("input.sum[calced=0]");0<c.length&&(b=!1);c=$("#"+a).find("input.diff[calced=0]");0<c.length&&(b=!1);return b},calcAll:function(a){$("#"+a).find("input.multi").attr("calced","0");$("#"+a).find("input.divide").attr("calced","0");$("#"+a).find("input.sum").attr("calced","0");$("#"+a).find("input.diff").attr("calced","0");Calc.calcSum(a);Calc.calcDiff(a);Calc.calcMulti(a);
Calc.calcDivide(a)},calcSumField:function(a,b){if("1"!=$(a).attr("calced")){var c=$(a).attr("fields").split(" "),d=$(a).attr("decimal_place"),d="undefined"==typeof d||isNaN(d)?0:parseInt(d,10),e=$(a).attr("round_type"),f=null;Ext.each(c,function(){var a=$("#"+b).find("[name="+this+"]")[0];$(a).is("input.sum")&&"1"!=$(a).attr("calced")&&Calc.calcSumField(a,b);$(a).is("input.diff")&&"1"!=$(a).attr("calced")&&Calc.calcDiffField(a,b);$(a).is("input.multi")&&"1"!=$(a).attr("calced")&&Calc.calcMultiField(a,
b);$(a).is("input.divide")&&"1"!=$(a).attr("calced")&&Calc.calcDivideField(a,b);a=$("#"+b).find("[name="+this+"]").val();if("undefined"==typeof a||""==a.trim()||isNaN(parseFloat(NumUtil.removeComma(a),10)))return!0;null==f&&(f=0);f=Calc.sum(f,parseFloat(NumUtil.removeComma(a),10))});null==f?$(a).val(""):$(a).val(NumUtil.addComma(""+Calc.round(f,d,e)));$(a).attr("calced","1")}},calcSum:function(a){$("#"+a).find("input.sum").each(function(){Calc.calcSumField(this,a)})},calcDiffField:function(a,b){if("1"!=
$(a).attr("calced")){var c=$(a).attr("fields").split(" "),d=$(a).attr("decimal_place"),d="undefined"==typeof d||isNaN(d)?0:parseInt(d,10),e=$(a).attr("round_type"),f=null;Ext.each(c,function(a,c){var d=$("#"+b).find("[name="+this+"]")[0];$(d).is("input.sum")&&"1"!=$(d).attr("calced")&&Calc.calcSumField(d,b);$(d).is("input.diff")&&"1"!=$(d).attr("calced")&&Calc.calcDiffField(d,b);$(d).is("input.multi")&&"1"!=$(d).attr("calced")&&Calc.calcMultiField(d,b);$(d).is("input.divide")&&"1"!=$(d).attr("calced")&&
Calc.calcDivideField(d,b);d=$("#"+b).find("[name="+this+"]").val();if("undefined"==typeof d||""==d.trim()||isNaN(parseFloat(NumUtil.removeComma(d),10)))return!0;f=0==c?parseFloat(NumUtil.removeComma(d),10):Calc.diff(null==f?0:f,parseFloat(NumUtil.removeComma(d),10))});null==f?$(a).val(""):$(a).val(NumUtil.addComma(""+Calc.round(f,d,e)));$(a).attr("calced","1")}},calcDiff:function(a){$("#"+a).find("input.diff").each(function(){Calc.calcDiffField(this,a)})},calcMultiField:function(a,b){if("1"!=$(a).attr("calced")){var c=
$(a).attr("fields").split(" "),d=$(a).attr("decimal_place"),d="undefined"==typeof d||isNaN(d)?0:parseInt(d,10),e=$(a).attr("round_type"),f=null;Ext.each(c,function(){var a=$("#"+b).find("[name="+this+"]")[0];$(a).is("input.sum")&&"1"!=$(a).attr("calced")&&Calc.calcSumField(a,b);$(a).is("input.diff")&&"1"!=$(a).attr("calced")&&Calc.calcDiffField(a,b);$(a).is("input.multi")&&"1"!=$(a).attr("calced")&&Calc.calcMultiField(a,b);$(a).is("input.divide")&&"1"!=$(a).attr("calced")&&Calc.calcDivideField(a,
b);a=$(a).val();if("undefined"==typeof a||""==a.trim()||isNaN(parseFloat(NumUtil.removeComma(a),10)))return f=null,!1;null==f&&(f=1);f=Calc.multi(f,parseFloat(NumUtil.removeComma(a),10))});null==f?$(a).val(""):(c=$(a).attr("number"),"undefined"!=typeof c&&null!=c&&""!=c.trim()&&(isNaN(parseFloat(c))||(f=Calc.multi(f,parseFloat(c)))),$(a).val(NumUtil.addComma(""+Calc.round(f,d,e))));$(a).attr("calced","1")}},calcMulti:function(a){$("#"+a).find("input.multi").each(function(){Calc.calcMultiField(this,
a)})},calcDivideField:function(a,b){if("1"!=$(a).attr("calced")){var c=$(a).attr("fields").split(" "),d=$(a).attr("decimal_place"),d="undefined"==typeof d||isNaN(d)?0:parseInt(d,10),e=$(a).attr("round_type"),f=null;Ext.each(c,function(){var a=$("#"+b).find("[name="+this+"]")[0];$(a).is("input.sum")&&"1"!=$(a).attr("calced")&&Calc.calcSumField(a,b);$(a).is("input.diff")&&"1"!=$(a).attr("calced")&&Calc.calcDiffField(a,b);$(a).is("input.multi")&&"1"!=$(a).attr("calced")&&Calc.calcMultiField(a,b);$(a).is("input.divide")&&
"1"!=$(a).attr("calced")&&Calc.calcDivideField(a,b);a=$(a).val();if("undefined"==typeof a||""==a.trim())return f=null,!1;a=parseFloat(NumUtil.removeComma(a),10);if(isNaN(a)||0==a)return f=null,!1;f=null==f?a:Calc.divide(f,a)});null==f?$(a).val(""):(c=$(a).attr("number"),"undefined"!=typeof c&&null!=c&&""!=c.trim()&&(isNaN(parseFloat(c))||(f=Calc.divide(f,parseFloat(c)))),$(a).val(NumUtil.addComma(""+Calc.round(f,d,e))));$(a).attr("calced","1")}},calcDivide:function(a){$("#"+a).find("input.divide").each(function(){Calc.calcDivideField(this,
a)})},sum:function(a,b){var c=""+NumUtil.removeComma(a),d=""+NumUtil.removeComma(b),e=0<=c.indexOf(".")?c.length-c.indexOf(".")-1:0,f=0<=d.indexOf(".")?d.length-d.indexOf(".")-1:0,e=e>f?e:f;a=Calc.shiftDecimalPlace(c,e);b=Calc.shiftDecimalPlace(d,e);return(a+b)/Math.pow(10,e)},diff:function(a,b){var c=""+NumUtil.removeComma(a),d=""+NumUtil.removeComma(b),e=0<=c.indexOf(".")?c.length-c.indexOf(".")-1:0,f=0<=d.indexOf(".")?d.length-d.indexOf(".")-1:0,e=e>f?e:f;a=Calc.shiftDecimalPlace(c,e);b=Calc.shiftDecimalPlace(d,
e);return(a-b)/Math.pow(10,e)},multi:function(a,b){var c=""+NumUtil.removeComma(a),d=""+NumUtil.removeComma(b),e=0<=c.indexOf(".")?c.length-c.indexOf(".")-1:0,f=0<=d.indexOf(".")?d.length-d.indexOf(".")-1:0;a=Calc.shiftDecimalPlace(c,e);b=Calc.shiftDecimalPlace(d,f);return a*b/Math.pow(10,e+f)},divide:function(a,b){var c=""+NumUtil.removeComma(a),d=""+NumUtil.removeComma(b),e=0<=c.indexOf(".")?c.length-c.indexOf(".")-1:0,f=0<=d.indexOf(".")?d.length-d.indexOf(".")-1:0;a=Calc.shiftDecimalPlace(c,e);
b=Calc.shiftDecimalPlace(d,f);return e>f?a/b/Math.pow(10,e-f):e<f?a/b*Math.pow(10,f-e):a/b},shiftDecimalPlace:function(a,b){var c=""+parseFloat(a,10);for(i=0;i<b;i++){var d=c.indexOf(".");0>d?c+="0":d==c.length-1?c=c.replace(".","0"):d==c.length-2?c=c.replace(".",""):(c=c.replace(".",""),c=c.substring(0,d+1)+"."+c.substring(d+1))}return parseFloat(c,10)},round:function(a,b,c){a=parseFloat(a);b=parseInt(b,10);0<b&&(a=Calc.shiftDecimalPlace(a,b));switch(c){case "round":a=Math.round(a);break;case "round_up":a=
Math.ceil(a);break;default:a=Math.floor(a)}0<b&&(a/=Math.pow(10,b));return a}};FieldConvert={bindMasterReferenceChangeEvent:function(a){$("#"+a).find(":input.master_reference").each(function(){$(this).attr("master_code");var b=$(this).attr("data_key_field");$("#"+a).find(":input[name="+b+"]").change(function(){FieldConvert.masterReferenceAll(a)})})},masterReferenceAll:function(a){$("#"+a).find(":input.master_reference").each(function(){var b=this;$(b).attr("name");var c=$(b).attr("master_code"),d=
$(b).attr("data_key_field"),d=$("#"+a).find(":input[name="+d+"]").val(),e=$(b).attr("master_attribute");MasterData.requestMasterDataRow(c,d,function(a){"undefined"==typeof a[e]?$(b).val(""):$(b).val(a[e]);$(b).is("textarea")&&$(b).trigger("autosize.resize")})})},masterReferenceAllByPreLoadData:function(a){$("#"+a).find(":input.master_reference").each(function(){$(this).attr("name");var b=$(this).attr("master_code"),c=$(this).attr("data_key_field"),c=$("#"+a).find(":input[name="+c+"]").val(),d=$(this).attr("master_attribute");
"undefined"!=typeof MasterData.masterRows[b]&&"undefined"!=typeof MasterData.masterRows[b][c]&&"undefined"!=typeof MasterData.masterRows[b][c][d]?$(this).val(MasterData.masterRows[b][c][d]):$(this).val("");$(this).is("textarea")&&$(this).trigger("autosize.resize")})},bindUserSelectButtonEvent:function(a){$("#"+a).find("input[type=button].user_select_button").unbind("click",!1);$("#"+a).find("input[type=button].user_select_button").bind("click",function(){var b=$(this).attr("process_number");UserSelectWindow.showWindow(b,
a)});var b=!1,c="";"template_body_new_doc"!=a&&(c=a.substring(14,a.length),"1"==$("#"+a).find("#in_resubmit_process_"+c).val()&&(b=!0));("template_body_new_doc"==a||b)&&$("#"+a).find("input[type=button].user_select_button").each(function(){null!=$(this).attr("ok_to_show_process_number")&&$(this).hide()})},bindClearApproverButtonEvent:function(a){$("#"+a).find("input[type=button].clear_approver_button").unbind("click",!1);$("#"+a).find("input[type=button].clear_approver_button").bind("click",function(){var b=
$(this).attr("process_number"),b=$("#"+a).find("input[name=process][number="+b+"]");ApproverCandidate.setNewApprovers(b,[],a)});var b=!1,c="";"template_body_new_doc"!=a&&(c=a.substring(14,a.length),"1"==$("#"+a).find("#in_resubmit_process_"+c).val()&&(b=!0));("template_body_new_doc"==a||b)&&$("#"+a).find("input[type=button].clear_approver_button").each(function(){null!=$(this).attr("ok_to_show_process_number")&&$(this).hide()})},bindMasterSelectButtonEvent:function(a,b){$("#"+a).find("input[type=button].sateraito_master_select").unbind("click",
!1);$("#"+a).find("input[type=button].sateraito_master_select").bind("click",function(){MasterWindow.masterSelectFormButtonClick(this,b)})},bindEventToGoogleCalendarButtonEvent:function(a,b){var c=function(b,c){var f=$(c).attr("data_fields").split(";"),g={};Ext.each(f,function(){var a=(""+this).split(":");g[a[0]]=a[1]});var f="",h=null,k=null,l=!1,n=!1;"undefined"!=typeof g.from&&""!=g.from&&$("#"+a).find(":input[name="+g.from+"]").each(function(){var a=$(this).val(),b=new DateFormat("yyyy-MM-dd");
h=b.parse(a);null==h&&(b=new DateFormat("yyyy-MM-dd HH:mm:ss"),h=b.parse(a),l=!0)});"undefined"!=typeof g.to&&""!=g.to&&$("#"+a).find(":input[name="+g.to+"]").each(function(){var a=$(this).val(),b=new DateFormat("yyyy-MM-dd");k=b.parse(a);null==k&&(b=new DateFormat("yyyy-MM-dd HH:mm:ss"),k=b.parse(a),n=!0)});null!=h&&l&&(h=new Date(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds()));null!=k&&(n?k=new Date(k.getUTCFullYear(),k.getUTCMonth(),k.getUTCDate(),
k.getUTCHours(),k.getUTCMinutes(),k.getUTCSeconds()):k.setTime(k.getTime()+864E5));null==h&&null!=k?n?(h=new Date,h.setTime(k.getTime()-36E5)):h=k:null!=h&&null==k&&(l?(k=new Date,k.setTime(h.getTime()+36E5)):k=h);if(null!=h&&null!=k){var m;l&&n?(f=""+h.getFullYear()+("0"+(h.getMonth()+1)).slice(-2)+("0"+h.getDate()).slice(-2)+"T"+("0"+h.getHours()).slice(-2)+("0"+h.getMinutes()).slice(-2)+("0"+h.getSeconds()).slice(-2)+"Z",m=""+k.getFullYear()+("0"+(k.getMonth()+1)).slice(-2)+("0"+k.getDate()).slice(-2)+
"T"+("0"+k.getHours()).slice(-2)+("0"+k.getMinutes()).slice(-2)+("0"+k.getSeconds()).slice(-2)+"Z"):(f=""+h.getFullYear()+("0"+(h.getMonth()+1)).slice(-2)+("0"+h.getDate()).slice(-2),m=""+k.getFullYear()+("0"+(k.getMonth()+1)).slice(-2)+("0"+k.getDate()).slice(-2));f=f+"/"+m}else f="";var q="";"undefined"!=typeof g.title&&""!=g.title&&$("#"+a).find(":input[name="+g.title+"]").each(function(){q=$(this).val()});var r="";"undefined"!=typeof g.details&&""!=g.details&&$("#"+a).find(":input[name="+g.details+
"]").each(function(){r=$(this).val()});var t="";"undefined"!=typeof g.location&&""!=g.location&&$("#"+a).find(":input[name="+g.location+"]").each(function(){t=$(this).val()});m="https://www.google.com/calendar/event?action=TEMPLATE&trp=false";""!=q&&(m=m+"&text="+encodeURIComponent(q));""!=f&&(m=m+"&dates="+encodeURIComponent(f));""!=r&&(m=m+"&details="+encodeURIComponent(r));""!=t&&(m=m+"&location="+encodeURIComponent(t));window.open(m)};$("#"+a).find("input[type=button].add_to_google_calendar").each(function(){var a=
this;$(a).attr("src",SATERAITO_MY_SITE_URL+"/images/calendar_plus_ja.gif");$(a).unbind("click",!1);$(a).bind("click",function(){c("button",a)})});$("#"+a).find("img.add_to_google_calendar").each(function(){var a=this;$(a).attr("src",SATERAITO_MY_SITE_URL+"/images/calendar_plus_ja.gif");$(a).attr("style","cursor:pointer;");$(a).unbind("click",!1);$(a).bind("click",function(){c("img",a)})})},bindClearButtonEvent:function(a){$("#"+a).find("input[type=button].clear_button").unbind("click",!1);$("#"+a).find("input[type=button].clear_button").bind("click",
function(){var b=$(this).attr("fields").split(" ");Ext.each(b,function(){var b=""+this;$("#"+a).find(":input[name="+b+"]").val("")})})},fillDataToMasterList:function(a,b,c){var d=$("#"+a),e=d.find(":input"),f=[];d.find("select.master_list").each(function(){var a=$(this).attr("master_code");-1==f.indexOf(a)&&f.push(a)});Ext.each(f,function(){var f=""+this;MasterData.requestMasterData(f,"",!0,!1,!1,"",function(h,k){d.find("select.master_list[master_code="+f+"]").each(function(){var a=this;Ext.each(h,
function(){var b=this.data_key,c=this.attribute_1;$(a).append('<option value="'+b+'">'+Sateraito.Util.escapeHtml(c))});var d=$(a).attr("name"),f=b[d];"undefined"!=typeof f&&c(e,d,f)});d.find("select.master_list[master_code="+f+"]").removeClass("master_list");"template_body_new_doc"==a&&($("#template_body_to_submit").find("select.master_list[master_code="+f+"]").each(function(){var a=this;Ext.each(h,function(){var b=this.data_key,c=this.attribute_1;$(a).append('<option value="'+b+'">'+Sateraito.Util.escapeHtml(c))})}),
$("#template_body_to_submit").find("select.master_list[master_code="+f+"]").removeClass("master_list"))})})},dateFieldConvert:function(a,b){$("#"+a).find("input.date").each(function(){var c=$(this).parents("div:hidden");$(c).show();FieldConvert._dateFieldConvert(a,b,this);$(c).hide()})},_dateFieldConvert:function(a,b,c){var d=$(c).attr("class"),e=$(c).attr("type");"undefined"==typeof e&&(e="text");if("text"==e||""==e){var e=$(c).attr("name"),f=$(c).val();if("undefined"==typeof f||null==f)f="";var g=
!1;$(c).attr("disabled")&&(g=!0);var h=!1;$(c).attr("readonly")&&(h=!0);var k=$(c).attr("mandatory_msg");if("undefined"==typeof k||null==k)k="";var l=$(c).attr("list_key");if("undefined"==typeof l||null==l)l="";var n=$(c).attr("disp");if("undefined"==typeof n||null==n)n="";$(c).after('<div style="display:inline-block;" id="date_field_render_area_'+a+"_"+e+'" ></div>');var m=new Ext.form.DateField({id:a+"_"+e,name:e,invalidText:MyLang.getMsg("VC_INVALID_DATE_FORMAT"),renderTo:"date_field_render_area_"+
a+"_"+e,readOnly:h,disabled:g,value:f,format:"Y-m-d"});b.add(m);$(c).is(".today_date")&&SateraitoWF.getToday(function(a){m.setValue(a.today)});$("#date_field_render_area_"+a+"_"+e).find("input[name="+e+"]").addClass(d).attr("mandatory_msg",k).attr("list_key",l).attr("disp",n);$(c).remove()}},numberFieldConvert:function(a,b){$("#"+a).find("input.number").each(function(){var c=$(this).parents("div:hidden");$(c).show();FieldConvert._numberFieldConvert(a,b,this);$(c).hide()})},_numberFieldConvert:function(a,
b,c){var d=$(c).attr("class"),e=$(c).attr("type");"undefined"==typeof e&&(e="text");if("text"==e||""==e){var e=$(c).attr("name"),f=$(c).val();if("undefined"==typeof f||null==f)f="";var g=!1;$(c).attr("readonly")&&(g=!0);var h=!1;$(c).attr("disabled")&&(h=!0);var k=$(c).attr("fields");if("undefined"==typeof k||null==k)k="";var l=$(c).attr("number");if("undefined"==typeof l||null==l)l="";var n=$(c).attr("number_type");if("undefined"==typeof n||null==n)n="";var m=$(c).attr("decimal_place");if("undefined"==
typeof m||null==m)m="";var q=$(c).attr("round_type");if("undefined"==typeof q||null==q)q="";var r=$(c).attr("mandatory_msg");if("undefined"==typeof r||null==r)r="";var t=$(c).attr("list_key");if("undefined"==typeof t||null==t)t="";var s=$(c).attr("disp");if("undefined"==typeof s||null==s)s="";var p;switch(n){case "FLOAT":p="[0-9,-.]";break;default:p="[0-9,-]"}var z=$(c).width();$(c).after('<div style="display:inline-block;" id="number_field_render_area_'+a+"_"+e+'"></div>');f=new Ext.form.TextField({id:a+
"_"+e,maskRe:new RegExp(p),name:e,invalidText:MyLang.getMsg("VC_INVALID_NUMERIC_FORMAT"),renderTo:"number_field_render_area_"+a+"_"+e,width:z,value:f,readOnly:g,disabled:h,validator:function(a){a=NumUtil.removeComma(a);return isNaN(a)?MyLang.getMsg("VC_INVALID_NUMERIC_FORMAT2"):!0},listeners:{focus:function(a){var b=NumUtil.removeComma(a.getRawValue());a.setRawValue(b)},change:function(a){var b=NumUtil.removeComma(a.getRawValue());isNaN(b)||(b=NumUtil.addComma(b),a.setRawValue(b))}}});b.add(f);$("#number_field_render_area_"+
a+"_"+e).find("input[name="+e+"]").addClass(d).attr("fields",k).attr("number",l).attr("number_type",n).attr("decimal_place",m).attr("round_type",q).attr("list_key",t).attr("disp",s).attr("mandatory_msg",r);$(c).remove()}}};DocDetailWindow={wfEventHandler:{},bindSectionClassHandler:function(){$(document).on("click","div.section_area_title",function(){var a=$(this).parent("div.section_area"),b=$(a).find("img.section_arrow_img"),a=$(a).find("div.section_show_hide_area");"none"==$(a).css("display")?($(a).show("normal"),
$(b).attr("src",SATERAITO_MY_SITE_URL+"/images/arrowDown.gif")):($(a).hide("normal"),$(b).attr("src",SATERAITO_MY_SITE_URL+"/images/arrowRight.gif"))})},bindDownloadAttachedFileLink:function(){WorkflowUser.requestToken(function(a){DocDetailWindow._bindDownloadAttachedFileLink(a.token)})},_bindDownloadAttachedFileLink:function(a){$(".download_attached_file").unbind("click",!1);$(".download_attached_file").bind("click",function(){var b=$(this).attr("file_id");$(this).attr("is_comment_attach");var c=
!1;"1"==$(this).attr("is_pdf")&&(c=!0);var d="0";"1"==$(this).attr("is_comment_attach")&&(d="1");var e=SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/attach/downloadattachedfile",f=SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/attach/oid/downloadattachedfile",b="?file_id="+encodeURIComponent(b),b=b+("&is_comment_attach="+encodeURIComponent(d)),b=b+("&hl="+SATERAITO_LANG);c?window.open(f+b+"&inline=1"):Sateraito.Util.isSmartPhone()?window.open(f+
b):(b+="&token="+encodeURIComponent(a),0==$("#dummy_frame").size()&&$("body").append('<iframe id="dummy_frame" style="width:0px;height:0px;display:block;border: none;position: relative;"></iframe>'),$("#dummy_frame").attr("src",e+b))})},validateForm:function(a,b){var c=!1;$("#template_body_"+a).find(":input.mandatory").each(function(){var b=this,d=$(b).attr("name"),e=$(b).attr("type"),k=$(b).attr("mandatory_msg"),l=!1;"radio"==e?$("#template_body_"+a).find(":input[name="+d+"]").is(":checked")||(l=
!0,k&&""!=k||(k=MyLang.getMsg("VC_NEED_FOR_RADIO"))):"checkbox"==e?$("#template_body_"+a).find(":input[name="+d+"]").is(":checked")||(l=!0,k&&""!=k||(k=MyLang.getMsg("VC_NEED_FOR_CHECKBOX"))):""==$(b).val()&&(l=!0,k&&""!=k||(k=MyLang.getMsg("VC_NEED")));if(l)return alert(k),function(){$(b).focus()}.defer(700),c=!0,!1});if(!c){var d=!0;Ext.ComponentMgr.get("form_panel_"+a).getForm().items.each(function(a){a.validate()||(a.focus(),d=!1)});if(!d)return!1;var e=Ext.getCmp("doc_detail_window_"+a);return"undefined"!=
typeof e.wfEventHandler&&"function"==typeof e.wfEventHandler.onFormValidate?(0,e.wfEventHandler.onFormValidate)(b):Calc.checkAllFieldsCalced("template_body_"+a)?!0:(alert(MyLang.getMsg("MSG_NOAVAILABLE_SUBMIT_WITHOUT_CALC")),!1)}},_getUpdateDocValues:function(a,b){var c=$("#template_body_"+a).find("input[type=hidden][name=workflow_template_setting]").attr("checkbox_behavior"),d={};Ext.each(b,function(){var b=""+this,b=$("#template_body_"+a).find(":input[name="+b+"]");for(elements_idx=0;elements_idx<
b.length;elements_idx++){var f=b[elements_idx],g=$(f).attr("name"),h=$(f).val(),k=$(f).attr("type");"radio"==k&&(h=$("#template_body_"+a).find("input[name="+g+"]:checked").val());"checkbox"==k&&(h="VALUE_ATTR"==c?$(f).is(":checked")?"undefined"!=typeof $(f).attr("value")?$(f).attr("value"):!0:null:$(f).is(":checked"));if($(f).hasClass("number")||$(f).hasClass("sum")||$(f).hasClass("diff")||$(f).hasClass("multi")||$(f).hasClass("divide"))h=NumUtil.removeComma(h);$(f).is(".do_not_save")||"undefined"!=
typeof g&&("checkbox"==k&&"VALUE_ATTR"==c?null!=h?d[g]="undefined"!=typeof d[g]?d[g]+(""!=d[g]?",":"")+h:h:"undefined"==typeof d[g]&&(d[g]=""):d[g]=h)}});return d},updateDocFields:function(a,b,c,d,e,f){b=DocDetailWindow._getUpdateDocValues(a,b);var g=null,h=$("#template_body_"+a).find("div.approver_comment_form").find("textarea[name=approver_comment_detail]").val()||null;null!=h&&(g=$("#template_body_"+a).find("div.approver_comment_form").find("textarea[name=approver_comment_detail]").attr("process_number"),
g={approver_comment_detail:h,process_number:parseInt(g,10)});var h=Ext.ComponentMgr.get("doc_comment_"+a).getValue(),k=[];d||$("#template_body_"+a).find("input[name=process]").each(function(){if("1"==$(this).attr("updated")){var a=parseInt($(this).attr("number"),10),b=$(this).val(),c=b.split(",");""==b.trim()&&(c=[]);k.push({approver:c,number:a})}});WorkflowDoc.requestUpdateDoc(a,b,g,h,c,k,e,function(a){f(a)})},checkMyProcessIn:function(a,b){var c={inApproveProcess:!1,inViewProcess:!1};-1!=a.approver_candidates.indexOf(b)&&
-1==a.approvers.indexOf(b)&&a.status==WorkflowDoc.PROCESS_STATUS_IN_PROCESS&&(a.approve_type==WorkflowDoc.APPROVE_TYPE_APPROVE?c.inApproveProcess=!0:a.approve_type==WorkflowDoc.APPROVE_TYPE_LOOK&&(c.inViewProcess=!0));return c},createPrevButton:function(a){return new Ext.Button({iconCls:"page-prev",handler:function(){var b=Ext.ComponentMgr.get("tab_set").getActiveTab();LoginMgr.isAdminMode()&&(b=Ext.ComponentMgr.get("search_result_grid"));var c=b.selModel,d=b.getStore(),b=d.findExact("doc_id",a);
if(-1!=b&&0<b&&(--b,d=d.getAt(b),"undefined"!=typeof d)){var d=d.data.doc_id,e=Ext.ComponentMgr.get("doc_detail_window_"+a);DocDetailWindow.showWindow(d,e);c.selectRow(b)}}})},createNextButton:function(a){return new Ext.Button({iconCls:"page-next",handler:function(){var b=Ext.ComponentMgr.get("tab_set").getActiveTab();LoginMgr.isAdminMode()&&(b=Ext.ComponentMgr.get("search_result_grid"));var c=b.selModel,d=b.getStore(),b=d.findExact("doc_id",a);if(-1!=b&&(b+=1,d=d.getAt(b),"undefined"!=typeof d)){var d=
d.data.doc_id,e=Ext.ComponentMgr.get("doc_detail_window_"+a);DocDetailWindow.showWindow(d,e);c.selectRow(b)}}})},createUpdateButton:function(a,b,c,d){return new Ext.Button({id:a,diabled:!0,text:MyLang.getMsg("MSG_UPDATE"),handler:function(){if(DocDetailWindow.validateForm(b,"update"))if(SateraitoUI.changeEnabledComponents(!1),confirm(MyLang.getMsg("MSG_CONFIRM_PRE_UPDATE_DOC"))){var a=WorkflowDoc.createOpenNotifications("template_body_"+b);DocDetailWindow.updateDocFields(b,c,!1,!1,a,function(a){SateraitoUI.changeEnabledComponents(!0);
a?(alert(MyLang.getMsg("MSG_UPDATE_DOCUNENT")),d&&!IS_OPENID_MODE&&Ext.ComponentMgr.get("doc_detail_window_"+b).close()):alert(MyLang.getMsg("ERROR_WHILE_UPDATING"))})}else SateraitoUI.changeEnabledComponents(!0)}})},createReSubmitButton:function(a,b,c,d){"undefined"==typeof c&&(c=[]);return new Ext.Button({id:a,diabled:!0,text:MyLang.getMsg("MSG_RESUBMIT"),handler:function(){SateraitoUI.changeEnabledComponents(!1);if(DocDetailWindow.validateForm(b,"resubmit")){var a=function(f,g){"undefined"==typeof f&&
(f=!1);"undefined"==typeof g&&(g=!1);var h=$("#template_body_"+b).find(":input[name=doc_cover_date_from]").val(),k=$("#template_body_"+b).find(":input[name=doc_cover_date_to]").val();if(null==h||null==k||""==h||""==k||f)if(g)if(confirm(MyLang.getMsg("MSG_CONFIRM_PRE_RESUBMIT_DOC"))){$("#template_body_"+b).find("input[type=hidden][name=workflow_doc_before_resubmit_handler]").each(function(){var a=this.onclick;"function"==typeof a&&a($("#template_body_"+b).parents("form")[0])});var l=[];$("#template_body_"+
b).find("input[name=process]").each(function(){if("1"==$(this).attr("updated")){var a=parseInt($(this).attr("number"),10),b=$(this).val(),c=b.split(",");""==b.trim()&&(c=[]);l.push({approver:c,number:a})}});var h=DocDetailWindow._getUpdateDocValues(b,c),k=Ext.ComponentMgr.get("doc_comment_"+b).getValue(),n=WorkflowDoc.createFinalApproveNoDef(b),m=WorkflowDoc.createSerialNoDef(b),q=WorkflowDoc.getMasterRowForUpdate(b),r=$("#template_body_to_changedocstatus_"+b).html();WorkflowDoc.reSubmitDoc(b,r,h,
k,l,n,m,q,function(a){if("undefined"!=typeof a&&"error"==a.status){var c="",c="NOEXIST_TARGET_DOC"==a.error_code?MyLang.getMsg("ERR_FAILED_GET_TARGET_DOC"):MyLang.getMsg("ERR_RESUBMIT_DOC");alert(c)}else IS_OPENID_MODE&&OidMiniMessage.showNormalMiniMessage(MyLang.getMsg("MSG_RESUBMIT_DOCUNENT"),1E4);IS_OPENID_MODE?(Ext.ComponentMgr.get("doc_detail_window_"+b).close(),DocDetailWindow.showWindow(b,null,d)):(MyPanel.reloadAllGrid(),Ext.ComponentMgr.get("doc_detail_window_"+b).close())})}else SateraitoUI.changeEnabledComponents(!0);
else WorkflowDoc.checkAttachFiles(b,function(b){b.result?a(f,!0):("ATTACHFILE_REQUIRED"==b.result_code?alert(MyLang.getMsg("VC_REQUIRED_ATTACH_FILE")):alert(b.msg),SateraitoUI.changeEnabledComponents(!0))});else WorkflowDoc.checkDuplicateCoverDate(b,h,k,function(b){b?a(!0,g):(alert(MyLang.getMsg("MSG_DUPLICATE_COVER_DATE_TERM")),SateraitoUI.changeEnabledComponents(!0))})};a(!1)}else SateraitoUI.changeEnabledComponents(!0)}})},createLookedButton:function(a,b,c,d){"undefined"==typeof c&&(c=[]);var e=
MyLang.getMsg("MSG_LOOK_AND_CLOSE");IS_OPENID_MODE&&(e=MyLang.getMsg("MSG_LOOK"));return new Ext.Button({id:a,diabled:!0,text:e,handler:function(){SateraitoUI.changeEnabledComponents(!1);var a=function(){if(confirm(MyLang.getMsg("MSG_CONFIRM_PRE_LOOK_DOC"))){var a=[];$("#template_body_"+b).find("input[name=process]").each(function(){if("1"==$(this).attr("updated")){var b=parseInt($(this).attr("number"),10),c=$(this).val(),d=c.split(",");""==c.trim()&&(d=[]);a.push({approver:d,number:b})}});var e=
WorkflowDoc.createFinalApproveNoDef(b),f=WorkflowDoc.createSerialNoDef(b),g=WorkflowDoc.getMasterRowForUpdate(b),h=Ext.ComponentMgr.get("doc_comment_"+b).getValue(),r=WorkflowDoc.createOpenNotifications("template_body_"+b),t=function(){WorkflowDoc.changeDocStatus(b,WorkflowDoc.STATUS_PASSED,WorkflowDoc.APPROVE_TYPE_LOOK,h,a,e,f,g,r,function(a){if("undefined"!=typeof a&&"error"==a.status){a=a.error_code;var c="",c="NOEXIST_TARGET_WA"==a?MyLang.getMsg("ERR_FAILED_LOOK_DOC_BY_ALREADY_DEALED"):"NOEXIST_TARGET_DOC"==
a?MyLang.getMsg("ERR_FAILED_GET_TARGET_DOC"):MyLang.getMsg("ERR_LOOK_DOC");alert(c)}else IS_OPENID_MODE&&OidMiniMessage.showNormalMiniMessage(MyLang.getMsg("MSG_LOOK_DOCUNENT"),1E4);IS_OPENID_MODE?(Ext.ComponentMgr.get("doc_detail_window_"+b).close(),DocDetailWindow.showWindow(b,null,d)):(MyPanel.reloadAllGrid(),Ext.ComponentMgr.get("doc_detail_window_"+b).close())})};0<c.length||DocDetailWindow.isApproverCommentDictExists(b)?DocDetailWindow.updateDocFields(b,c,!0,!0,null,function(a){a?t():(SateraitoUI.changeEnabledComponents(!0),
alert(MyLang.getMsg("ERROR_WHILE_UPDATING")))}):t()}else SateraitoUI.changeEnabledComponents(!0)};if(DocDetailWindow.validateForm(b,"look")){var e=LoginMgr.getViewerEmail(),h=!1;$("#template_body_"+b).find("div.q_and_a").each(function(){var c=$(this).hasClass("mandatory_for_look"),d=$(this).hasClass("mandatory_for_self_look");if(c||d){h=!0;var n=$(this).attr("word_for_question");"undefined"==typeof n&&(n=MyLang.getMsg("QUESTION"));var m=$(this).attr("name");QandA.requestQandAList(b,m,function(b){var h=
!1;Ext.each(b,function(){"undefined"==typeof this.question_detail||""==this.question_detail||"undefined"!=typeof this.answer_detail&&""!=this.answer_detail||(c?(h=!0,alert(MyLang.getMsg("CANNOT_APPROVE_BECAUSE_EXIST_NOTANSWER_QUESTION")+";"+n),SateraitoUI.changeEnabledComponents(!0)):d&&this.question_email==e&&(h=!0,alert(MyLang.getMsg("CANNOT_APPROVE_BECAUSE_EXIST_NOTANSWER_QUESTION")+";"+n),SateraitoUI.changeEnabledComponents(!0)))});h||a()})}});h||a()}else SateraitoUI.changeEnabledComponents(!0)}})},
createApproveButton:function(a,b,c,d){"undefined"==typeof c&&(c=[]);return new Ext.Button({id:a,diabled:!0,text:MyLang.getMsg("MSG_APPROVE"),handler:function(){SateraitoUI.changeEnabledComponents(!1);var a=function(){if(confirm(MyLang.getMsg("MSG_CONFIRM_PRE_APPROVE_DOC"))){$("#template_body_"+b).find("input[type=hidden][name=workflow_doc_before_approve_handler]").each(function(){var a=this.onclick;"function"==typeof a&&a($("#template_body_"+b).parents("form")[0])});var a=[];$("#template_body_"+b).find("input[name=process]").each(function(){if("1"==
$(this).attr("updated")){var b=parseInt($(this).attr("number"),10),c=$(this).val(),d=c.split(",");""==c.trim()&&(d=[]);a.push({approver:d,number:b})}});var e=Ext.ComponentMgr.get("doc_comment_"+b).getValue(),f=WorkflowDoc.createFinalApproveNoDef(b),g=WorkflowDoc.createSerialNoDef(b),m=WorkflowDoc.getMasterRowForUpdate(b),q=WorkflowDoc.createOpenNotifications("template_body_"+b),r=function(){WorkflowDoc.changeDocStatus(b,WorkflowDoc.STATUS_PASSED,WorkflowDoc.APPROVE_TYPE_APPROVE,e,a,f,g,m,q,function(a){if("undefined"!=
typeof a&&"error"==a.status){a=a.error_code;var c="",c="NOEXIST_TARGET_WA"==a?MyLang.getMsg("ERR_FAILED_APPROVE_DOC_BY_ALREADY_DEALED"):"NOEXIST_TARGET_DOC"==a?MyLang.getMsg("ERR_FAILED_GET_TARGET_DOC"):MyLang.getMsg("ERR_APPROVE_DOC");alert(c)}else IS_OPENID_MODE&&OidMiniMessage.showNormalMiniMessage(MyLang.getMsg("MSG_APPROVE_DOCUNENT"),1E4);IS_OPENID_MODE?(Ext.ComponentMgr.get("doc_detail_window_"+b).close(),DocDetailWindow.showWindow(b,null,d)):(MyPanel.reloadAllGrid(),Ext.ComponentMgr.get("doc_detail_window_"+
b).close())})};0<c.length||DocDetailWindow.isApproverCommentDictExists(b)?DocDetailWindow.updateDocFields(b,c,!0,!0,null,function(a){a?r():(SateraitoUI.changeEnabledComponents(!0),alert(MyLang.getMsg("ERROR_WHILE_UPDATING")))}):r()}else SateraitoUI.changeEnabledComponents(!0)};if(DocDetailWindow.validateForm(b,"approve")){var f=LoginMgr.getViewerEmail(),g=!1;$("#template_body_"+b).find("div.q_and_a").each(function(){var c=$(this).hasClass("mandatory_for_approve"),d=$(this).hasClass("mandatory_for_self_approve");
if(c||d){g=!0;var l=$(this).attr("word_for_question");"undefined"==typeof l&&(l=MyLang.getMsg("QUESTION"));var n=$(this).attr("name");QandA.requestQandAList(b,n,function(b){var g=!1;Ext.each(b,function(){"undefined"==typeof this.question_detail||""==this.question_detail||"undefined"!=typeof this.answer_detail&&""!=this.answer_detail||(c?(g=!0,alert(MyLang.getMsg("CANNOT_APPROVE_BECAUSE_EXIST_NOTANSWER_QUESTION")+";"+l),SateraitoUI.changeEnabledComponents(!0)):d&&this.question_email==f&&(g=!0,alert(MyLang.getMsg("CANNOT_APPROVE_BECAUSE_EXIST_NOTANSWER_QUESTION")+
";"+l),SateraitoUI.changeEnabledComponents(!0)))});g||a()})}});g||a()}else SateraitoUI.changeEnabledComponents(!0)}})},createRejectButton:function(a,b,c,d){"undefined"==typeof c&&(c=[]);return new Ext.Button({id:a,diabled:!0,text:MyLang.getMsg("MSG_REJECT"),handler:function(){SateraitoUI.changeEnabledComponents(!1);var a=function(){if(confirm(MyLang.getMsg("MSG_CONFIRM_PRE_REJECT_DOC"))){$("#template_body_"+b).find("input[type=hidden][name=workflow_doc_before_reject_handler]").each(function(){var a=
this.onclick;"function"==typeof a&&a($("#template_body_"+b).parents("form")[0])});var a=[];$("#template_body_"+b).find("input[name=process]").each(function(){if("1"==$(this).attr("updated")){var b=parseInt($(this).attr("number"),10),c=$(this).val(),d=c.split(",");""==c.trim()&&(d=[]);a.push({approver:d,number:b})}});var e=WorkflowDoc.createFinalApproveNoDef(b),g=WorkflowDoc.createSerialNoDef(b),h=WorkflowDoc.getMasterRowForUpdate(b),q=WorkflowDoc.createOpenNotifications("template_body_"+b),r=function(){WorkflowDoc.changeDocStatus(b,
WorkflowDoc.STATUS_REJECTED,WorkflowDoc.APPROVE_TYPE_APPROVE,f,a,e,g,h,q,function(a){if("undefined"!=typeof a&&"error"==a.status){a=a.error_code;var c="",c="NOEXIST_TARGET_WA"==a?MyLang.getMsg("ERR_FAILED_REJECT_DOC_BY_ALREADY_DEALED"):"NOEXIST_TARGET_DOC"==a?MyLang.getMsg("ERR_FAILED_GET_TARGET_DOC"):MyLang.getMsg("ERR_REJECT_DOC");alert(c)}else IS_OPENID_MODE&&OidMiniMessage.showNormalMiniMessage(MyLang.getMsg("MSG_REJECT_DOCUNENT"),1E4);IS_OPENID_MODE?(Ext.ComponentMgr.get("doc_detail_window_"+
b).close(),DocDetailWindow.showWindow(b,null,d)):(MyPanel.reloadAllGrid(),SateraitoUI.changeEnabledComponents(!0),Ext.ComponentMgr.get("doc_detail_window_"+b).close())})};0<c.length||DocDetailWindow.isApproverCommentDictExists(b)?DocDetailWindow.updateDocFields(b,c,!0,!0,null,function(a){a?r():(SateraitoUI.changeEnabledComponents(!0),alert(MyLang.getMsg("ERROR_WHILE_UPDATING")))}):r()}else SateraitoUI.changeEnabledComponents(!0)};if(DocDetailWindow.validateForm(b,"reject")){var f=Ext.ComponentMgr.get("doc_comment_"+
b).getValue();if(""==f.trim())alert(MyLang.getMsg("EXP_ABOUT_INPUT_COMMENT_WITH_REJECT")),SateraitoUI.changeEnabledComponents(!0);else{var g=LoginMgr.getViewerEmail(),h=!1;$("#template_body_"+b).find("div.q_and_a").each(function(){var c=$(this).hasClass("mandatory_for_reject"),d=$(this).hasClass("mandatory_for_self_reject");if(c||d){h=!0;var f=$(this).attr("word_for_question");"undefined"==typeof f&&(f=MyLang.getMsg("QUESTION"));var m=$(this).attr("name");QandA.requestQandAList(b,m,function(b){var h=
!1;Ext.each(b,function(){"undefined"==typeof this.question_detail||""==this.question_detail||"undefined"!=typeof this.answer_detail&&""!=this.answer_detail||(c?(h=!0,alert(MyLang.getMsg("CANNOT_REJECT_BECAUSE_EXIST_NOTANSWER_QUESTION")+";"+f),SateraitoUI.changeEnabledComponents(!0)):d&&this.question_email==g&&(h=!0,alert(MyLang.getMsg("CANNOT_REJECT_BECAUSE_EXIST_NOTANSWER_QUESTION")+";"+f),SateraitoUI.changeEnabledComponents(!0)))});h||a()})}});h||a()}}else SateraitoUI.changeEnabledComponents(!0)}})},
createRemandButton:function(a,b,c,d){"undefined"==typeof c&&(c=[]);return new Ext.Button({id:a,diabled:!0,text:MyLang.getMsg("MSG_REMAND"),handler:function(){SateraitoUI.changeEnabledComponents(!1);var a=function(a,e,f){$("#template_body_"+b).find("input[type=hidden][name=workflow_doc_before_remand_handler]").each(function(){var a=this.onclick;"function"==typeof a&&a($("#template_body_"+b).parents("form")[0])});var g=[];$("#template_body_"+b).find("input[name=process]").each(function(){if("1"==$(this).attr("updated")){var a=
parseInt($(this).attr("number"),10),b=$(this).val(),c=b.split(",");""==b.trim()&&(c=[]);g.push({approver:c,number:a})}});WorkflowDoc.getMasterRowForUpdate(b);var h=function(){WorkflowDoc.remandDocStatus(b,a,e,f,function(a){if("undefined"!=typeof a&&"error"==a.status){a=a.error_code;var c="",c="ALREADY_FINAL_APPROVED"==a?MyLang.getMsg("ERR_FAILED_REMAND_DOC_BY_ALREADY_FINAL_APPROVED"):"ALREADY_REJECTED"==a?MyLang.getMsg("ERR_FAILED_REMAND_DOC_BY_ALREADY_REJECTED"):"DENY_REMAND"==a?MyLang.getMsg("ERR_FAILED_REMAND_DOC_BY_DENIED"):
"NOEXIST_TARGET_DOC"==a?MyLang.getMsg("ERR_FAILED_GET_TARGET_DOC"):MyLang.getMsg("ERR_REMAND_DOC");alert(c)}else IS_OPENID_MODE&&OidMiniMessage.showNormalMiniMessage(MyLang.getMsg("MSG_REMAND_DOCUNENT"),1E4);IS_OPENID_MODE?(Ext.ComponentMgr.get("doc_detail_window_"+b).close(),DocDetailWindow.showWindow(b,null,d)):(MyPanel.reloadAllGrid(),SateraitoUI.changeEnabledComponents(!0),Ext.ComponentMgr.get("doc_detail_window_"+b).close())})};0<c.length||DocDetailWindow.isApproverCommentDictExists(b)?DocDetailWindow.updateDocFields(b,
c,!0,!0,null,function(a){a?h():(SateraitoUI.changeEnabledComponents(!0),alert(MyLang.getMsg("ERROR_WHILE_UPDATING")))}):h()};if(DocDetailWindow.validateForm(b,"remand")){var f=Ext.ComponentMgr.get("doc_comment_"+b).getValue();if(""==f.trim())alert(MyLang.getMsg("EXP_ABOUT_INPUT_COMMENT_WITH_REMAND")),SateraitoUI.changeEnabledComponents(!0);else{var g=$("#template_body_"+b).find("input[name=process][current_approving=1]").attr("number"),h;h='<div style="font-size:13px;padding:10px;">'+("<h1>"+MyLang.getMsg("SELECT_REMAND_PROCESS_NUMBER")+
"</h1>");h+='<p style="margin:10px;">';h+=MyLang.getMsg("MSG_CONFIRM_PRE_REMAND_DOC")+"<br>";h+="</p>";h+='<table class="detail" style="width:99%">';h+="<tr>";h+='<td style="width:30%" class="detail_name">';h+=MyLang.getMsg("REMAND_PROCESS_NUMBER");h+="</td>";h+='<td style="width:70%" class="detail_value">';h+='<select id="remand_process_number_'+b+'" style="width:100%;" >';h+='<option value="0" >'+MyLang.getMsg("REMAND_TARGET_SUBMITTER")+"</option>";if("undefined"!=typeof g&&!isNaN(g))for(var g=
parseInt(g,10),k=1;k<g;k++){var l=$("#template_body_"+b).find("input[name=process][number="+k+"]").attr("disp");h="undefined"==typeof l||""==l?h+('<option value="'+k+'" >'+MyLang.getMsg("REMAND_TARGET_APPROVER")+" "+k+"</option>"):h+('<option value="'+k+'" >'+l+"</option>")}h+="</select>";h+="</td>";h+="</tr>";h+="</table>";h+="</div>";h=new Ext.Panel({autoWidth:!0,autoScroll:!1,html:h});k=[];k.push({text:MyLang.getMsg("MSG_REMAND"),handler:function(){var c=$("#remand_process_number_"+b).val();"undefined"==
typeof c||"__noselect"==c||isNaN(c)?alert(MyLang.getMsg("VC_INDICATE_REMAND_PROCESS_NUMBER")):(Ext.ComponentMgr.get("select_remand_process_"+b).close(),a(parseInt(g,10),parseInt(c,10),f))}});k.push({text:MyLang.getMsg("MSG_CLOSE"),handler:function(){Ext.ComponentMgr.get("select_remand_process_"+b).close();SateraitoUI.changeEnabledComponents(!0)}});h=new Ext.Window({id:"select_remand_process_"+b,width:400,autoHeight:!0,bodyStyle:"background-color:white;",title:MyLang.getMsg("SELECT_REMAND_PROCESS_NUMBER"),
plain:!0,autoScroll:!1,layout:"fit",items:[h],listeners:{close:function(){SateraitoUI.changeEnabledComponents(!0)}},buttons:k});h.show();h.dd.constrainTo(Ext.getBody())}}else SateraitoUI.changeEnabledComponents(!0)}})},createDeleteButton:function(a,b){return new Ext.Button({id:a,diabled:!0,text:MyLang.getMsg("MSG_DELETE"),handler:function(){confirm(MyLang.getMsg("MSG_CONFIRM_PRE_DELETE_DOC"))&&(SateraitoUI.changeEnabledComponents(!1),WorkflowDoc.deleteDoc(b,function(a){a&&(SateraitoUI.changeEnabledComponents(!0),
IS_OPENID_MODE||MyPanel.reloadAllGrid(),Ext.ComponentMgr.get("doc_detail_window_"+b).close())}))}})},createCommentPanel:function(a){return new Ext.Panel({id:"comment_panel_"+a,hidden:!0,height:60,layout:"border",border:!1,items:[new Ext.Panel({region:"west",html:'<div style="font-family:arial, tahoma, verdana, helvetica;font-size:12px;margin:5px;">'+MyLang.getMsg("COMMENT")+"</div>",width:150}),new Ext.form.TextArea({region:"center",id:"doc_comment_"+a})]})},createFileListHtml:function(a){var b="";
Ext.each(a,function(){b+='<span class="download_file_link link_cmd2" file_id="'+this.file_id+'">';b+=this.file_name;b+="</span>";b+="<br />"});return b},toDocLink:function(a,b){null==a&&(a="");var c;c=""+('<span class="link_cmd2" dummy_for_sort="'+Sateraito.Util.escapeHtml(a)+'" onclick="DocDetailWindow.showWindow(\''+b+"')\">");c+=Sateraito.Util.escapeHtml(a);return c+"</span>"},toDraftDocLink:function(a,b){null==a&&(a="");var c;c=""+('<span class="link_cmd2" dummy_for_sort="'+Sateraito.Util.escapeHtml(a)+
'" onclick="NewDocWindow.showDraftDocWindow(\''+b+"')\">");c+=Sateraito.Util.escapeHtml(a);return c+"</span>"},isApproverCommentDictExists:function(a){return 0<$("#template_body_"+a).find("div.approver_comment_form").find("textarea[name=approver_comment_detail]").size()?!0:!1},renderApproverCommentDict:function(a,b,c){$("#template_body_"+a).find("div.approver_comment_list").each(function(){var d=$(this).attr("process_number");"undefined"!=typeof d&&null!=d&&""!=d&&DocDetailWindow._renderApproverCommentDict(a,
b,d,this,c)})},_renderApproverCommentDict:function(a,b,c,d,e){ApproverCommentDict.requestApproverCommentDict(a,c,function(a){var g=LoginMgr.getViewerEmail(),h="",h=h+'<table class="approver_comment_list" style="width:100%">',h=h+"<tr>",h=h+('<th style="width:10%">'+MyLang.getMsg("FLD_APPROVER_COMMENT_NAME")+"</th>"),h=h+('<th style="width:90%">'+MyLang.getMsg("FLD_APPROVER_COMMENT_OPINION")+"</th>"),h=h+"</tr>";Ext.iterate(a,function(a,d){h+="<tr>";h+="<td nowrap>";h+='<span title="'+Sateraito.Util.escapeHtml(a)+
'">';h+=Sateraito.Util.escapeHtml(WorkflowUser.getUserName(a));h+="</span>";h+="</td>";h+="<td>";if(a==g&&e&&b==c){h+='<div class="approver_comment_form">';h+='<textarea name="approver_comment_detail" process_number="'+c+'" rows="4" style="width:100%">';if("undefined"!=typeof d){var f=Sateraito.Util.escapeHtml(d);h+=f}h+="</textarea>";h+="</div>"}else"undefined"!=typeof d&&(f=Sateraito.Util.escapeHtml(d),h+=Sateraito.Util.enterToBr(f));h+="</td>";h+="</tr>"});h+="</table>";$(d).html(h)})},renderQandA:function(a,
b,c){$("#template_body_"+a).find("div.q_and_a").each(function(){var d=$(this).attr("name");null==d&&(d="default");var e=$(this).attr("word_for_question");"undefined"==typeof e&&(e="");null==e&&(e="");var f;f="undefined"==typeof $(this).attr("is_stop_auto_approve_without_answer")?!1:!0;var g=parseInt($(this).attr("expand_rate_approve_expire_date"),0),h=$(this).attr("enable_only_process_number"),k=[];"undefined"!=typeof h&&null!=h&&""!=h&&(k=h.split(" "));var l=!0;0<k.length&&(l=!1,Ext.each(k,function(){if(!isNaN(this)&&
c==parseInt(this,10))return l=!0,!1}));k=$(this).attr("max_post_question");h=0;"undefined"!=typeof k&&null!=k&&""!=k&&(isNaN(k)||(h=parseInt(k,10)));k="undefined"==typeof $(this).attr("is_enable_with_final_approved_or_rejected")?!1:!0;DocDetailWindow._renderQandA(a,b,d,this,e,f,g,l,h,k)})},_renderQandA:function(a,b,c,d,e,f,g,h,k,l){var n=b.author_email,m=b.ghost_writer,q=LoginMgr.getViewerEmail();"undefined"==typeof e&&(e=MyLang.getMsg("QUESTION"));""==e&&(e=MyLang.getMsg("QUESTION"));"undefined"==
typeof h&&(h=!0);QandA.requestQandAList(a,c,function(r){var t=!1;if(q==n||""!=m&&q==m)t=!0;var s=0,p="",p=p+'<table class="q_and_a" style="width:100%">',p=p+"<tr>",p=p+('<th style="width:10%">'+MyLang.getMsg("FLD_QA_NAME")+"</th>"),p=p+('<th style="width:40%">'+e+"</th>"),p=p+('<th style="width:40%">'+MyLang.getMsg("FLD_QA_ANSWER")+"</th>"),p=p+"</tr>";Ext.each(r,function(){this.question_email==LoginMgr.getViewerEmail()&&s++;p+="<tr>";p+="<td nowrap>";p+='<span title="'+Sateraito.Util.escapeHtml(this.question_email)+
'">';p+=Sateraito.Util.escapeHtml(WorkflowUser.getUserName(this.question_email));p+="</span>";p+="</td>";p+="<td>";var d="";"undefined"!=typeof this.question_detail&&(d=Sateraito.Util.escapeHtml(this.question_detail));p+=Sateraito.Util.enterToBr(d);p+="</td>";p+="<td>";d="";"undefined"!=typeof this.answer_detail&&(d=Sateraito.Util.escapeHtml(this.answer_detail));t&&!IS_PRINT_WINDOW&&(l||"final_approved"!=b.status&&"rejected"!=b.status)?""==d.trim()?(p+='<div class="answer_form">',p+='<textarea name="answer_detail" rows="4" style="width:100%">',
p+="</textarea>",p+='<input type="button" class="answer_button" doc_id="'+a+'" q_and_a_name="'+c+'" question_no="'+this.question_no+'" is_stop_auto_approve_without_answer="'+f+'" expand_rate_approve_expire_date="'+g+'" value="\u56de\u7b54\u9001\u4fe1">',p+="</div>"):p+=Sateraito.Util.enterToBr(d):p+=Sateraito.Util.enterToBr(d);p+="</td>";p+="</tr>"});!t&&h&&!IS_PRINT_WINDOW&&(l||"final_approved"!=b.status&&"rejected"!=b.status)&&(0==k||s<k)&&(p+="<tr>",p+="<td>"+UserSetting.getUserName()+"</td>",
p+="<td>",p+='<div class="question_form">',p+='<textarea name="question_detail" rows="4" style="width:100%"></textarea>',p+='<input type="button" class="question_button" doc_id="'+a+'" q_and_a_name="'+c+'" is_stop_auto_approve_without_answer="'+f+'" expand_rate_approve_expire_date="'+g+'" value="'+e+'\u9001\u4fe1">',p+="</div>",p+="</td>",p+="<td></td>",p+="</tr>");p+="</table>";$(d).html(p);$("#template_body_"+a).find("input[type=button][q_and_a_name="+c+"].question_button").click(function(){$(this).attr("disabled",
"disabled");var a=$(this).attr("doc_id"),f=$(this).attr("q_and_a_name"),g=$(this).parents("div.question_form").find("textarea[name=question_detail]").val(),s;s="undefined"==typeof $(this).attr("is_stop_auto_approve_without_answer")?!1:!0;var m=parseInt($(this).attr("expand_rate_approve_expire_date"),0);g&&""!=g?QandA.postQuestion(a,f,g,e,s,m,function(){DocDetailWindow._renderQandA(a,b,c,d,e,s,m,h,k,l)}):(alert(MyLang.getMsg("VC_NOTINPUT_QUESTION")+":"+e),$(this).removeAttr("disabled"))});$("#template_body_"+
a).find("input[type=button][q_and_a_name="+c+"].answer_button").click(function(){$(this).attr("disabled","disabled");var a=$(this).attr("doc_id"),f=$(this).attr("q_and_a_name"),g=$(this).attr("question_no"),s=$(this).parents("div.answer_form").find("textarea[name=answer_detail]").val(),m;m="undefined"==typeof $(this).attr("is_stop_auto_approve_without_answer")?!1:!0;var n=parseInt($(this).attr("expand_rate_approve_expire_date"),0);s&&""!=s?QandA.postAnswer(a,f,g,s,e,m,n,function(){DocDetailWindow._renderQandA(a,
b,c,d,e,m,n,h,k,l)}):(alert(MyLang.getMsg("VC_EMPTY_QA_ANSWER")),$(this).removeAttr("disabled"))})})},renderCommentList:function(a){WorkflowDoc.requestCommentList(a,function(b){Ext.each(b,function(){var b=WorkflowDoc.getShortStatusName(this.status,this.approve_type,this.is_auto_approve,this.deputy_approver),c;c='<div style="margin:5px;">'+this.created_date;""!=this.ghost_writer?(c+='<span title="'+Sateraito.Util.escapeHtml(this.ghost_writer)+'">'+Sateraito.Util.escapeHtml(this.ghost_writer_name)+
"</span>",c+='(<span title="'+Sateraito.Util.escapeHtml(this.user_email)+'">'+Sateraito.Util.escapeHtml(this.user_name)+"</span>"+MyLang.getMsg("OF_GHOST_WRITE2")+")"):""!=this.deputy_approver?(c+=' <span title="'+Sateraito.Util.escapeHtml(this.user_email)+'">'+Sateraito.Util.escapeHtml(this.user_name)+"</span>",c+='(<span title="'+Sateraito.Util.escapeHtml(this.deputy_approver)+'">'+Sateraito.Util.escapeHtml(this.deputy_approver_name)+"</span>"+MyLang.getMsg("OF")+b+")"):(c+=' <span title="'+Sateraito.Util.escapeHtml(this.user_email)+
'">'+Sateraito.Util.escapeHtml(this.user_name)+"</span>",c+="("+b+")");c+="<p>"+Sateraito.Util.enterToBr(Sateraito.Util.escapeHtml(this.comment))+"</p>";c+="</div>";$("#comment_area_"+a).append(c);if(!this.is_remanded){var f=$("#template_body_"+a).find('span.approver_status[email="'+Sateraito.Util.jQEscape(this.user_email)+'"][process_number="'+Sateraito.Util.jQEscape(this.approve_number)+'"]');"undefined"!=typeof f&&(b=WorkflowDoc.getStatusName(this.status,this.approve_type,this.is_auto_approve,
this.deputy_approver),c=this.created_date.split(" "),this.status==WorkflowDoc.STATUS_REJECTED?($(f).text("\uff08"+c[0]+" "+b+"\uff09"),$(f).css("color","blue"),$(f).css("font-weight","bold"),$(f).attr("rendered","1")):this.status==WorkflowDoc.STATUS_PASSED?($(f).text("\uff08"+c[0]+" "+b+"\uff09"),$(f).css("color","green"),$(f).css("font-weight","bold"),$(f).attr("rendered","1")):this.status==WorkflowDoc.STATUS_FINAL_APPROVED&&($(f).text("\uff08"+c[0]+" "+b+"\uff09"),$(f).css("color","red"),$(f).css("font-weight",
"bold"),$(f).attr("rendered","1")),"undefined"!=typeof this.deputy_approver&&""!=this.deputy_approver&&(f=$("#template_body_"+a).find('span.approver_status[email="'+Sateraito.Util.jQEscape(this.deputy_approver)+'"][process_number="'+Sateraito.Util.jQEscape(this.approve_number)+'"]'),"undefined"!=typeof f&&($(f).text("\uff08"+c[0]+" "+MyLang.getMsg("PASSIVE")+b+"\uff09"),$(f).css("color","brown"),$(f).css("font-weight","bold"),$(f).attr("rendered","1"))))}});$("#template_body_"+a).find('span.approver_status[rendered="0"][in_process="1"]').each(function(){$(this).text("\uff08"+
WorkflowDoc.getStatusName(WorkflowDoc.STATUS_IN_PROCESS,$(this).attr("approve_type"),!1)+"\uff09");$(this).css("font-weight","bold");$(this).attr("rendered","1")});$("canvas").each(function(){$(this).attr("rendered","0")});b.reverse();Ext.each(b,function(){var b=this,c=WorkflowDoc.getShortStatusName(b.status,b.approve_type,b.is_auto_approve,b.deputy_approver);if(b.status!=WorkflowDoc.COMMENT_STATUS_UPDATED)if(b.status==WorkflowDoc.STATUS_SUBMITTED)$("#template_body_"+a).find("canvas[process="+WorkflowDoc.STATUS_SUBMITTED+
"][rendered=0]").each(function(){var a=b.created_date.split(" ");Hanko.renderHanko(35,this,c,a[0],b.user_name);$(this).attr("rendered","1");return!1}),$("#template_body_"+a).find("canvas[process=auto][rendered=0]").each(function(){var a=b.created_date.split(" ");Hanko.renderHanko(35,this,c,a[0],b.user_name);$(this).attr("rendered","1");return!1});else if(b.status==WorkflowDoc.COMMENT_STATUS_RESUBMITTED)$("#template_body_"+a).find("canvas[process="+WorkflowDoc.STATUS_SUBMITTED+"][rendered=0]").each(function(){var a=
b.created_date.split(" ");Hanko.renderHanko(35,this,c,a[0],b.user_name);$(this).attr("rendered","1");return!1}),$("#template_body_"+a).find("canvas[process=auto][rendered=0]").each(function(){var a=b.created_date.split(" ");Hanko.renderHanko(35,this,c,a[0],b.user_name);$(this).attr("rendered","1");return!1});else{var f=!1;$("#template_body_"+a).find("canvas[process_number="+b.approve_number+"][rendered=0]").each(function(){var a=b.created_date.split(" ");Hanko.renderHanko(35,this,c,a[0],b.user_name);
$(this).attr("rendered","1");f=!0;return!1});$("#template_body_"+a).find("canvas[process=auto][rendered=0]").each(function(){var a=b.created_date.split(" ");Hanko.renderHanko(35,this,c,a[0],b.user_name);$(this).attr("rendered","1");return!1});if(!f&&0<$("#template_body_"+a).find("canvas[process_number="+b.approve_number+"][rendered=1]").size()){var g=$("#template_body_"+a).find("canvas[process_number="+b.approve_number+"][rendered=1]:last"),h=$(g).attr("style"),k=$(g).attr("width"),l=$(g).attr("height");
$(g).after('<canvas process_number="'+b.approve_number+'" width="'+k+'" height="'+l+'" style="'+h+'" rendered="0">');g=$("#template_body_"+a).find("canvas[process_number="+b.approve_number+"][rendered=0]")[0];"undefined"!=typeof uu&&"undefined"!=typeof uu.canvas&&($(g).addClass("vml"),uu.canvas.init());h=b.created_date.split(" ");Hanko.renderHanko(35,g,c,h[0],b.user_name);$(g).attr("rendered","1")}}0>=$("#template_body_"+a).find("canvas[process=auto][rendered=0]").size()&&(g=$("#template_body_"+a).find("canvas[process=auto][rendered=1]:last"),
h=$(g).attr("style"),k=$(g).attr("width"),l=$(g).attr("height"),$(g).after('<canvas process="auto" width="'+k+'" height="'+l+'" style="'+h+'" rendered="0">'),g=$("#template_body_"+a).find("canvas[process=auto][rendered=0]")[0],"undefined"!=typeof uu&&"undefined"!=typeof uu.canvas&&($(g).addClass("vml"),uu.canvas.init()),Hanko.renderWaku(g))});$("#template_body_"+a).find("canvas[process=auto][rendered=0]").hide();$("#template_body_"+a).find("canvas[rendered=0]").each(function(){Hanko.renderWaku(this)});
if(IS_OPENID_MODE&&(b=Ext.ComponentMgr.get("doc_detail_window_"+a),"undefined"!=typeof b)){var c=$("#template_body_"+a).height();b.setHeight(c+120)}})},renderAttachmentFileList:function(a,b){var c;c=IS_PRINT_WINDOW?"0":b?"1":"0";WorkflowUser.requestToken(function(b){b=b.token;$("#attached_file_render_area_detail_"+a).html('<iframe style="width:100%;height:120px;border:solid 1px;border-color:#b5b8c8;" src="'+SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/attach/attachfilelist?token="+
encodeURIComponent(b)+"&doc_id="+a+"&is_editable="+c+"&hl="+SATERAITO_LANG+'">')})},renderClassChecklistWithCommentPublish:function(a,b,c){var d=!1;1==c.enable_doc_comment&&(d=!0);1==d?(DocCommentPublic.renderPublicCommentArea(b.doc_id),$("#comment_tree_title_table_"+a).show()):$("#comment_tree_title_table_"+a).hide()},showInputFields:function(a,b,c,d){var e=Ext.ComponentMgr.get("form_panel_"+b).getForm();Ext.each(a,function(){var a=""+this,g=$("#template_body_"+b).find(":input[name="+a+"]");$(g).attr("name");
var h=$(g).attr("type");"undefined"==typeof h&&(h="text");h=h.toLowerCase();$(g).is("select")?($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show(),c||d||$(g).removeAttr("disabled")):$(g).is("textarea")?($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show(),c||d||$(g).removeAttr("disabled")):"checkbox"==h?($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show(),c||d||$(g).removeAttr("disabled")):"radio"==
h?($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show(),c||d||$(g).removeAttr("disabled")):$(g).is("input")&&"text"==h?($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show(),c||d||$(g).removeAttr("disabled"),$(g).hasClass("number")&&(a=$(g).parents("div:hidden"),$(a).show(),FieldConvert._numberFieldConvert("template_body_"+b,e,g),$(a).hide()),$(g).hasClass("date")&&(a=$(g).parents("div:hidden"),$(a).show(),FieldConvert._dateFieldConvert("template_body_"+
b,e,g),$(a).hide())):$(g).is("input")&&0<=$.inArray(h,"date datetime datetime-local month week time number range search tel url email color".split(" "))?($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show(),c||d||$(g).removeAttr("disabled")):"button"==h&&($(g).is(".sateraito_master_select")&&$(g).show(),$(g).is(".clear_button")&&$(g).show())});$("#template_body_"+b).find(":input").change(function(){Calc.calcAll("template_body_"+b)});FieldConvert.bindClearButtonEvent("template_body_"+
b)},renderDocApprover:function(a,b,c,d,e){var f=null;"draft"==b.status&&null!=b.approver_values&&""!=b.approver_values&&(f=Ext.decode(b.approver_values));var g=f;if(null!=g)$("#template_body_"+a).find("input[name=process]").each(function(){var b=this,c=$(this).attr("number");$(this).hide();Ext.each(g,function(){if(c==""+this.number){var d=this.value.split(",");ApproverCandidate.addApprover(b,d,"template_body_"+a)}})}),e.defer(100),c.is_disable_attach_files||DocDetailWindow.renderAttachmentFileList(a,
!1),DocDetailWindow.renderCommentList(a),FieldConvert.bindMasterSelectButtonEvent("template_body_"+a,a),FieldConvert.bindEventToGoogleCalendarButtonEvent("template_body_"+a,a);else{var h=!1;"1"==$("#template_body_"+a).find("#in_admin_edit_process_"+a).val()&&(h=!0);var k=!1;"1"==$("#template_body_"+a).find("#in_resubmit_process_"+a).val()&&(k=!0);var l={};"undefined"!=typeof b.name_info&&""!=b.name_info&&(l=Ext.decode(b.name_info));DocDetailWindow.requestDocApprover(a,function(f){var g=null,q=!1,
r=!1,t=!1,s=[],p=[],z=!1;Ext.each(f,function(b,c){var d=this;"undefined"!=typeof d.approvers&&0<d.approvers.length&&(z=!0);var e=$("#template_body_"+a).find("span.approver_name_list[name=process][number="+d.approve_number+"]");ApproverList.renderApproverList(e,d.approver_candidates,d.approvers,d.status,d.approve_type,d.approve_number,l);var f=$("#template_body_"+a).find("input[name=process][number="+d.approve_number+"]");f.attr("value",Sateraito.Util.myImplode(d.approver_candidates));!h||"undefined"!=
typeof d.status&&null!=d.status&&""!=d.status||(f.attr("ok_to_admin_edit","1"),e.after('<input type="button" class="user_select_button" process_number="'+d.approve_number+'" value="'+MyLang.getMsg("ADD_APPROVER_BTN")+'" for_admin_edit >&nbsp;<input type="button" class="clear_approver_button" process_number="'+d.approve_number+'" value="'+MyLang.getMsg("CLEAR_APPROVER_BTN")+'" for_admin_edit >&nbsp;'));IS_ADMIN_CONSOLE||(e=LoginMgr.getViewerEmail(),f=DocDetailWindow.checkMyProcessIn(d,e),f.inApproveProcess?
(g=d.approve_number,q=!0):f.inViewProcess&&(g=d.approve_number,r=!0),d.no_agency||UserSetting.userSetting.whose_deputy_approver_i_am&&0<UserSetting.userSetting.whose_deputy_approver_i_am.length&&Ext.each(UserSetting.userSetting.whose_deputy_approver_i_am,function(){var a=DocDetailWindow.checkMyProcessIn(d,""+this);a.inApproveProcess?(g=d.approve_number,q=!0):a.inViewProcess&&(g=d.approve_number,r=!0)}),-1!=d.approver_candidates.indexOf(e)&&(-1==p.indexOf(d.approve_number)&&p.push(d.approve_number),
0<d.ok_to_update.length&&g==d.approve_number&&(t=!0,s=s.concat(d.ok_to_update))),d.no_agency||UserSetting.userSetting.whose_deputy_approver_i_am&&0<UserSetting.userSetting.whose_deputy_approver_i_am.length&&Ext.each(UserSetting.userSetting.whose_deputy_approver_i_am,function(){-1!=d.approver_candidates.indexOf(""+this)&&(-1==p.indexOf(d.approve_number)&&p.push(d.approve_number),0<d.ok_to_update.length&&g==d.approve_number&&(t=!0,s=s.concat(d.ok_to_update)))}))});var v=!1,A=!1,w=!c.allow_remand;if(h||
k){var t=w=A=v=!0,s=[],u=Ext.decode(b.doc_values);Ext.iterate(u,function(a,b){"doc_no"!=a&&s.push(a)});$("#template_body_"+a).find("input[name=process]").each(function(){var b=$(this).attr("ok_to_remove"),c=$(this).attr("ok_to_open_notification"),d=$(this).attr("ok_to_admin_edit"),e=$(this).attr("number");IS_PRINT_WINDOW||h||"undefined"==typeof c||$("#template_body_"+a).find("span.approver_name_list[number="+e+"]").find("span.approver_name").each(function(){var b=$(this).attr("email"),b='<img src="'+
SATERAITO_MY_SITE_URL+'/images/open_notification_off.png" class="btn_open_notification" email="'+b+'" status="off" style="padding-left:2px;height:14px;cursor:pointer;" onclick="ApproverCandidate.toggleOpenNotificationButton('+e+", '"+b+"', 'template_body_"+a+'\');" title="'+MyLang.getMsg("OPEN_NOTIFICATION_OFF")+'">';$(this).after(b)});!IS_PRINT_WINDOW&&(!h&&"undefined"!=typeof b||h&&"1"==d)&&$("#template_body_"+a).find("span.approver_name_list[number="+e+"]").find("span.approver_name").each(function(){var b=
$(this).attr("email"),b='<img src="'+SATERAITO_MY_SITE_URL+'/images/btn_delete.png" style="cursor:pointer;" onclick="ApproverCandidate.removeApprover('+e+", '"+b+"', 'template_body_"+a+"');\">";$(this).after(b)})})}else null!=g&&($("#template_body_"+a).find("input[name=process][number="+g+"]").attr("current_approving","1"),IS_PRINT_WINDOW||$("#template_body_"+a).find("input[name=process]").each(function(){var b=$(this).attr("ok_to_remove_process_number"),c=$(this).attr("number");"undefined"!=typeof b&&
(b=b.split(" "),Ext.each(b,function(){this==g&&$("#template_body_"+a).find("span.approver_name_list[number="+c+"]").find("span.approver_name").each(function(){var b=$(this).attr("email"),b='<img src="'+SATERAITO_MY_SITE_URL+'/images/btn_delete.png" style="cursor:pointer;" onclick="ApproverCandidate.removeApprover('+c+", '"+b+"', 'template_body_"+a+"');\">";$(this).after(b)})}))}),u=$("#template_body_"+a).find("input[name=process][number="+g+"]").attr("ok_to_attachfile"),"undefined"!=typeof u&&null!=
u&&(v=!0),u=$("#template_body_"+a).find("input[name=process][number="+g+"]").attr("no_reject"),"undefined"!=typeof u&&null!=u&&(A=!0),u=$("#template_body_"+a).find("input[name=process][number="+g+"]").attr("no_remand"),"undefined"!=typeof u&&null!=u&&(w=!0));if(!h){var B=WorkflowDoc.openNotifications[a];$("#template_body_"+a).find("input[name=process]").each(function(){var b=$(this).attr("ok_to_open_notification_process_number"),c=$(this).attr("number"),d=!1;"undefined"!=typeof b&&(b=b.split(" "),
Ext.each(b,function(){this==g&&(d=!0)}));$("#template_body_"+a).find("span.approver_name_list[number="+c+"]").find("span.approver_name").each(function(){var b=$(this).attr("email"),e=WorkflowDoc.getOpenNotificationStatus(B,c,b),g=e[0],e=e[1];if(!IS_PRINT_WINDOW&&(d||null!=e)){var f;d?f=null!=e&&"opened"==e.status?'<img src="'+SATERAITO_MY_SITE_URL+'/images/open_notification_opened.png" class="btn_open_notification" email="'+b+'" status="'+(g?"on":"off")+'" style="padding-left:2px;height:14px;" title="'+
MyLang.getMsg("DOC_OPEN_DATE")+":"+Sateraito.DateUtil.timeShorten(e.doc_open_date)+'" >':g?'<img src="'+SATERAITO_MY_SITE_URL+'/images/open_notification_on.png" class="btn_open_notification" email="'+b+'" status="on" style="padding-left:2px;height:14px;cursor:pointer;"  onclick="ApproverCandidate.toggleOpenNotificationButton('+c+", '"+b+"', 'template_body_"+a+'\');" title="'+MyLang.getMsg("OPEN_NOTIFICATION_ON")+'">':'<img src="'+SATERAITO_MY_SITE_URL+'/images/open_notification_off.png" class="btn_open_notification" email="'+
b+'" status="off" style="padding-left:2px;height:14px;cursor:pointer;"  onclick="ApproverCandidate.toggleOpenNotificationButton('+c+", '"+b+"', 'template_body_"+a+'\');" title="'+MyLang.getMsg("OPEN_NOTIFICATION_OFF")+'">':null!=e&&("opened"==e.status?f='<img src="'+SATERAITO_MY_SITE_URL+'/images/open_notification_opened.png" class="btn_open_notification" email="'+b+'" status="'+(g?"on":"off")+'" style="padding-left:2px;height:14px;" title="'+MyLang.getMsg("DOC_OPEN_DATE")+":"+Sateraito.DateUtil.timeShorten(e.doc_open_date)+
'" >':g&&(f='<img src="'+SATERAITO_MY_SITE_URL+'/images/open_notification_closed.png" class="btn_open_notification" email="'+b+'" status="on" style="padding-left:2px;height:14px;" title="'+MyLang.getMsg("OPEN_NOTIFICATION_CLOSED")+'" >'));$(this).after(f)}})})}$("#template_body_"+a).find(".show_by_process_number").each(function(){var a=this,b=$(a).attr("process_number");"undefined"!=typeof b&&null!=b&&""!=b&&(b=b.split(" "),Ext.each(b,function(){var b=""+this;Ext.each(p,function(){b==""+this&&$(a).show()})}))});
$("#template_body_"+a).find(".show_by_current_process_number").each(function(){var a=this,b=$(a).attr("process_number");"undefined"!=typeof b&&null!=b&&""!=b&&(b=b.split(" "),Ext.each(b,function(){g==""+this&&$(a).show()}))});DocDetailWindow.renderCommentList(a);DocDetailWindow.renderQandA(a,b,g);c.is_disable_attach_files||DocDetailWindow.renderAttachmentFileList(a,v);!IS_PRINT_WINDOW&&t&&DocDetailWindow.showInputFields(s,a,k,h);(q||r||k||h)&&Ext.ComponentMgr.get("comment_panel_"+a).show();IS_PRINT_WINDOW||
$("input[type=button]").each(function(){var a=this,b=$(a).attr("ok_to_show_process_number");null!=b&&"undefined"!=typeof b&&(b=b.split(" "),Ext.each(b,function(){this==g&&$(a).show()}))});var v=function(c,e,g,f,l,m,p,n,B,y){IS_OPENID_MODE||(e.add(DocDetailWindow.createPrevButton(a)),e.add(DocDetailWindow.createNextButton(a)));var u=[],v=!1;u.push(["",MyLang.getMsg("USER_DEFAULT_PRINT_LAYOUT")]);if("undefined"!=typeof c.template_body_for_print&&""!=c.template_body_for_print){var C=Ext.decode(c.template_body_for_print);
Ext.each(C,function(a){""!=a.title&&(u.push([a.layout_id,a.title]),v=!0)})}v&&(e.add({xtype:"combo",mode:"local",name:"print_layout_"+a,value:"",store:new Ext.data.ArrayStore({fields:["Value","Disp"],data:u}),valueField:"Value",displayField:"Disp",typeAhead:!0,triggerAction:"all",lazyRender:!1,selectOnFocus:!0,autoWidth:!0,editable:!1,listeners:{change:function(){$("#"+y+"_"+a).attr("href",SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/docprint/"+a+"?hl="+SATERAITO_LANG+
"&layout="+encodeURIComponent(this.value))}}}),e.add({html:"&nbsp;",xtype:"label"}));e.add({text:'<a href="'+SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/docprint/"+a+"?hl="+SATERAITO_LANG+'" id="'+encodeURIComponent(y)+"_"+a+'" target="_blank">'+MyLang.getMsg("CLICK_HERE_TO_OPEN_PRINT_WINDOW")+"</a>",xtype:"tbtext"});e.add({xtype:"tbfill"});q&&!IS_ADMIN_CONSOLE&&(e.add(DocDetailWindow.createApproveButton(g,a,s,d)),A||e.add(DocDetailWindow.createRejectButton(f,a,s,d)),
w||e.add(DocDetailWindow.createRemandButton(n,a,s,d)));r&&!IS_ADMIN_CONSOLE&&e.add(DocDetailWindow.createLookedButton(m,a,s,d));t&&!k&&e.add(DocDetailWindow.createUpdateButton(p,a,s,h));k&&!IS_ADMIN_CONSOLE&&e.add(DocDetailWindow.createReSubmitButton(B,a,s,d));var x=LoginMgr.getViewerEmail();"g"==d||IS_OPENID_MODE||IS_ADMIN_CONSOLE||c.is_prohibit_reapply||(x==b.author_email||""!=b.ghost_writer&&x==b.ghost_writer)&&e.add({text:MyLang.getMsg("MSG_REAPPLY"),handler:function(){Ext.ComponentMgr.get("doc_detail_window_"+
a).close();var c="";"undefined"!=typeof b.ghost_writer&&""!=b.ghost_writer&&(c=b.author_email);c.toLowerCase()==x.toLowerCase()&&(c="");NewDocWindow.showWindow(b.template_id,Ext.decode(b.doc_values),null,b.route_body,"",null,c,!0,b.doc_id,"")}});"g"==d||IS_OPENID_MODE||!IS_ADMIN_CONSOLE||h||e.add({text:MyLang.getMsg("MSG_EDIT"),handler:function(){Ext.ComponentMgr.get("doc_detail_window_"+a).close();DocDetailWindow.showWindow(a,null,d,"",!0)}});if(x==b.author_email||""!=b.ghost_writer&&x==b.ghost_writer)c=
c.delete_doc_type,g=!1,"APPLY"==c?g=b.status==WorkflowDoc.DOC_STATUS_IN_PROCESS&&!z:"APPROVE"==c?g=b.status==WorkflowDoc.DOC_STATUS_IN_PROCESS||b.status==WorkflowDoc.DOC_STATUS_REJECTED||b.status==WorkflowDoc.DOC_STATUS_REMANDED:"FINAL_APPROVE"==c&&(g=!0),g&&!IS_ADMIN_CONSOLE&&e.add(DocDetailWindow.createDeleteButton(l,a));"g"==d||IS_OPENID_MODE||(l=MyLang.getMsg("MSG_CLOSE"),!q&&!r||IS_ADMIN_CONSOLE||(l=MyLang.getMsg("CANCEL")),e.add({text:l,handler:function(){(!q&&!r||IS_ADMIN_CONSOLE||confirm(MyLang.getMsg("MSG_CONFIRM_CLOSE_WINDOW_WITH_DELETE_CURRENT_DOCUMENT")))&&
Ext.ComponentMgr.get("doc_detail_window_"+a).close()}}));e.doLayout()},u=Ext.ComponentMgr.get("button_toptoolbar_"+a),y=Ext.ComponentMgr.get("button_toolbar_"+a);u&&v(c,u,"approve_button2","reject_button2","delete_button2","looked_button2","update_button2","remand_button2","resubmit_button2","open_print_link2");y&&v(c,y,"approve_button","reject_button","delete_button","looked_button","update_button","remand_button","resubmit_button","open_print_link");DocDetailWindow.renderApproverCommentDict(a,g,
!IS_PRINT_WINDOW&&(q||r));IS_OPENID_MODE&&(v=Ext.ComponentMgr.get("doc_detail_window_"+a),"undefined"!=typeof v&&(u=$("#template_body_"+a).height(),v.setHeight(u+120)));(function(){e();Ext.each(f,function(b,c){var d=this;$("#template_body_"+a).find("input.approve_expire_date[target_process_number="+d.approve_number+"]").each(function(){""==$(this).val()&&d.approve_expire_date&&(approve_expire_date=d.approve_expire_date,approve_expire_date=approve_expire_date.split(" ")[0],$(this).val(approve_expire_date),
$("#template_body_"+a).find("span[name="+$(this).attr("name")+"]").text(approve_expire_date))})})}).defer(100);FieldConvert.bindMasterSelectButtonEvent("template_body_"+a,a);FieldConvert.bindEventToGoogleCalendarButtonEvent("template_body_"+a,a);IS_PRINT_WINDOW||null!=g&&WorkflowDoc.requestSendOpenNotification(a,g)})}},requestDocApprover:function(a,b,c){IS_OPENID_MODE?DocDetailWindow._requestDocApproverOid(a,b,c):DocDetailWindow._requestDocApprover(a,b,c)},_requestDocApproverOid:function(a,b,c){"undefined"==
typeof c&&(c=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getdocapprover?doc_id="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,success:function(a,c){var f=Ext.decode(a.responseText);b(f)},failure:function(){Sateraito.Util.console("retrying "+c);c<Sateraito.EventController.MAX_RETRY&&DocDetailWindow._requestDocApproverOid(a,b,c+1)}})},_requestDocApprover:function(a,b,c){DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();
"undefined"==typeof c&&(c=1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getdocapprover?doc_id="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,function(d){d.data?(d=d.data,Sateraito.MiniMessage.clearMessage(),b(d)):(Sateraito.Util.console("[getdocapprover]("+c+")"+d.errors[0]),401==d.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+c),c<Sateraito.EventController.MAX_RETRY?
DocDetailWindow._requestDocApprover(a,b,c+1):(Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10))))},Sateraito.Util.requestParam())},showWindow:function(a,b,c,d,e){2==WorkflowUser.userListLoadingStatus?DocDetailWindow._showWindow(a,b,c,d,e):WorkflowUser.requestUserList(function(){DocDetailWindow._showWindow(a,b,c,d,e)})},_showWindow:function(a,b,c,d,e){var f=Ext.ComponentMgr.get("doc_detail_window_"+a);"undefined"!=typeof f&&null!=
f?(f.toFront(),b&&"undefined"!=typeof b&&b.close()):WorkflowDoc.requestDocDetail(a,function(g){b&&"undefined"!=typeof b&&b.close();var f=Ext.ComponentMgr.get("doc_detail_window_"+a);if("undefined"!=typeof f&&null!=f)f.toFront();else if("undefined"==typeof g.template_id)alert(MyLang.getMsg("MSG_ALREADY_DELETE_DOC_OR_ACCESS_DENIED"));else{var k=function(f,h){var k=Ext.ComponentMgr.get("doc_detail_window_"+a);if("undefined"!=typeof k&&null!=k)k.toFront(),b&&"undefined"!=typeof b&&b.close();else{k=""+
('<div id="template_body_'+a+'" class="main_body" style="font-size:13px;padding:0px;">');k+='<input type="hidden" id="in_resubmit_process_'+a+'" class="do_not_save" value="0" ></input>';k+='<input type="hidden" id="in_admin_edit_process_'+a+'" class="do_not_save" value="0" ></input>';k+='<div class="document_back"><div class="document_body">';k+='<table border="0" cellpadding="0" cellspacing="0" class="header_table">';k+='<tr background="'+SATERAITO_MY_SITE_URL+'/images/header_bga02.gif">';k+='<td width="49" height="40">';
k+='<img src="'+SATERAITO_MY_SITE_URL+'/images/header_marka.gif" border="0">';k+="</td>";k+='<td background="'+SATERAITO_MY_SITE_URL+'/images/header_bga01.gif" class="header_bga01" nowrap height="40" >';k+='<font size="4" color="#ffffff" face="\u30e1\u30a4\u30ea\u30aa,Meiryo,Hiragino Kaku Gothic Pro,\u30d2\u30e9\u30ae\u30ce\u89d2\u30b4 Pro W3,\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af">';k+='<b class="template_name"></b></font>';k+="</td>";k+='<td background="'+SATERAITO_MY_SITE_URL+'/images/header_bga02.gif" width="6" height="40" ></td>';
k+="</tr>";k+="</table>";k+='<div class="document_form">';k+=g.template_body;k+='<div id="route_body" class="route_body" >';g.route_body&&(k+=g.route_body);k+="</div>";k+="</div>";k+='<div style="font-size:13px;margin:5px;padding:5px;border-top:solid 1px silver;" id="attached_file_render_area_detail_'+a+'" class="attachment_area" >';k+="</div>";k+='<div id="comment_tree_title_table_'+a+'" style="font-size:13px;margin:5px;padding:5px;border-top:solid 1px silver;" >';k+='<table style="margin:0px">';
k+="<tr>";k+="<td>"+MyLang.getMsg("DOC_COMMENT")+":</td>";k+="</tr>";k+="</table>";k+='<div id="comment_tree_area_'+a+'" class="comment_tree" style="margin:0px 10px 10px 10px;">';k+="</div>";k+="</div>";k+='<div style="font-size:13px;margin:5px;padding:5px;border-top:solid 1px silver;" id="comment_area_'+a+'" class="comment_area" >';k+="</div>";k+="</div>";k+="</div>";k+="</div>";k+='<div id="template_body_to_changedocstatus_'+a+'" style="display:none;">'+g.template_body+"</div>";k=new Ext.form.FormPanel({bodyStyle:"background-color:white;",
layout:"fit",id:"form_panel_"+a,formId:"form_"+a,autoScroll:!0,html:k});WorkflowDoc.docIds[k.formId]=a;WorkflowDoc.relativeDocIds[a]=g.relative_doc_id;"undefined"!=typeof g.relative_doc_id_chain&&0<g.relative_doc_id_chain.length&&(WorkflowDoc.relativeDocIdChains[a]=g.relative_doc_id_chain);WorkflowDoc.initMasterRowForUpdate(a);k.region="center";var l=DocDetailWindow.createCommentPanel(a);l.region="south";IS_OPENID_MODE&&(document.title=("undefined"!=typeof g.doc_title&&""!=g.doc_title?g.doc_title+
" - ":"")+f.template_name);if(IS_PRINT_WINDOW)(new Ext.Panel({items:[k]})).render(d);else{var m=[k];m.push(l);var l=new Ext.Toolbar({id:"button_toptoolbar_"+a,items:[]}),n=new Ext.Toolbar({id:"button_toolbar_"+a,items:[]}),q;q=IS_OPENID_MODE?!0:"g"!=c?!0:!1;var w=new Ext.Window({id:"doc_detail_window_"+a,width:800,height:SateraitoUI.getWindowHeightWithUserPrefs(600),maximizable:!0,closable:q,title:g.template_name,plain:!0,autoScroll:"g"==c?!0:!1,layout:"border",items:m,buttonAlign:"left",tbar:l,fbar:n});
IS_OPENID_MODE&&(w.x=0,w.y=0);w.show();w.dd.constrainTo(Ext.getBody())}UserSetting.submitterSetting[k.formId]=h;e&&$("#template_body_"+a).find("#in_admin_edit_process_"+a).val("1");var u=!1;IS_ADMIN_CONSOLE||g.status!=WorkflowDoc.DOC_STATUS_REMANDED||LoginMgr.viewerEmail!=g.author_email&&(""==g.ghost_writer||LoginMgr.viewerEmail!=g.ghost_writer)||($("#template_body_"+a).find("#in_resubmit_process_"+a).val("1"),u=!0);"undefined"!=typeof uu&&"undefined"!=typeof uu.canvas&&($("#template_body_"+a).find("canvas").each(function(){$(this).addClass("vml")}),
uu.canvas.init());$("#template_body_"+a).find(".show_only_creating_doc").hide();$("#template_body_"+a).find("div.section_area").each(function(){var a=$(this).html(),b=$(this).attr("section_title");"undefined"==typeof b&&(b="");var c;c='<div class="section_area_title">'+('<img class="section_arrow_img" src="'+SATERAITO_MY_SITE_URL+'/images/arrowDown.gif" />');c+=b+"</div>";c+='<div class="section_show_hide_area" >'+a+"</div>";$(this).html(c)});$("#template_body_"+a).find(":input").each(function(){var a=
$(this).attr("name");"undefined"==typeof a&&(a="");var b=$(this).attr("type");"undefined"==typeof b&&(b="text");var b=b.toLowerCase(),c=$(this).css("display");"undefined"!=typeof c&&"none"==c.toLowerCase()&&$(this).attr("is_display_none","on");$(this).is("button")||($(this).is("select")?(a='<span class="sateraito_doc_value" name="'+a+'"></span>',$(this).after(a),$(this).hide()):$(this).is("textarea")?(a='<span class="sateraito_doc_value" name="'+a+'"></span>',$(this).after(a),$(this).hide()):"button"==
b?u||(e?($(this).is(".department_1_select_button")&&$(this).hide(),$(this).is(".user_select_button")&&$(this).hide(),$(this).is(".clear_approver_button")&&$(this).hide()):($(this).is(".sateraito_master_select")&&$(this).hide(),$(this).is(".department_1_select_button")&&$(this).hide(),$(this).is(".user_select_button")&&$(this).hide(),$(this).is(".clear_approver_button")&&$(this).hide(),$(this).is(".clear_button")&&$(this).hide())):"radio"==b?(a='<span class="sateraito_doc_value" name="'+a+'"></span>',
$(this).after(a),$(this).hide()):"checkbox"==b?(a='<span class="sateraito_doc_value" name="'+a+'"></span>',$(this).after(a),$(this).hide()):"hidden"!=b&&("process"==a.toLowerCase()?(b=$(this).attr("number"),a=""+('<span class="approver_name_list" name="'+a+'" number="'+b+'">'),a+="</span>"):a='<span class="sateraito_doc_value" name="'+a+'"></span>',$(this).after(a),$(this).hide()))});DocDetailWindow.renderDocApprover(a,g,f,c,function(){var b=Ext.decode(g.doc_values),c=$("#template_body_"+a),d=c.find(":input"),
e=c.find("span.sateraito_doc_value");Ext.iterate(b,function(b,c){var g=d.filter("[name="+b+"]");for(elements_idx=0;elements_idx<g.length;elements_idx++){var f=g[elements_idx];if($(f).is("input")){var h=$(f).attr("type");"undefined"==typeof h&&(h="text");h=h.toLowerCase();if("radio"==h)$("#template_body_"+a).find(":input[name="+b+"]").removeAttr("checked"),$("#template_body_"+a).find(":input[name="+b+"]").val([c]),$("#template_body_"+a).find(":input[name="+b+"]").each(function(){"on"!=$(this).attr("is_display_none")&&
($(this).attr("checked")?$(this).next("span.sateraito_doc_value").html('<img src="'+SATERAITO_MY_SITE_URL+'/images/radio_on.png" border="0">'):$(this).next("span.sateraito_doc_value").html('<img src="'+SATERAITO_MY_SITE_URL+'/images/radio_off.png" border="0">'))});else if("checkbox"==h)1==c?$(f).attr("checked","checked"):0==c?$(f).removeAttr("checked"):0<=(","+c+",").indexOf(","+$(f).val()+",")?$(f).attr("checked","checked"):$(f).removeAttr("checked"),"on"!=$(f).attr("is_display_none")&&($(f).is(":checked")?
$(f).next("span.sateraito_doc_value").html('<img src="'+SATERAITO_MY_SITE_URL+'/images/check_on.png" border="0">'):$(f).next("span.sateraito_doc_value").html('<img src="'+SATERAITO_MY_SITE_URL+'/images/check_off.png" border="0">'));else{if("hidden"!=h){if($(f).hasClass("number")||$(f).hasClass("sum")||$(f).hasClass("diff")||$(f).hasClass("multi")||$(f).hasClass("divide"))c=NumUtil.addComma(NumUtil.removeComma(c));h=Sateraito.Util.escapeHtml(c);e.filter("[name="+b+"]").html(Sateraito.Util.enterToBr(h))}$(f).val(c)}}else if($(f).is("select"))$(f).val(c),
f=$(f).find('option[value="'+Sateraito.Util.jQEscape(c)+'"]').text().trim(),e.filter("[name="+b+"]").html(Sateraito.Util.enterToBr(Sateraito.Util.escapeHtml(f)));else if($(f).is("textarea")){var h=Sateraito.Util.escapeHtml(c),k=$(f).clone(!0).removeAttr("name").attr("readonly","readonly");k.css("border-color","#FFF #FFF #FFF #FFF");k.css("border-style","solid 0px");k.css("padding-left","0px");k.css("overflow","hidden");k.val(c);k.show();(function(){k.autosize();k.val(c)}).defer(100);$("#template_body_"+
a).find("span.sateraito_doc_value[name="+b+"]").append(k);$(f).val(c)}}});$("#template_body_"+a).find("input[type=hidden][name=workflow_doc_load_handler]").each(function(){var b=this.onclick;"function"==typeof b&&"undefined"!=typeof $("#template_body_"+a).parents("form")[0]&&b($("#template_body_"+a).parents("form")[0])});$("#template_body_"+a).find("input[type=hidden][name=existing_workflow_doc_load_handler]").each(function(){var b=this.onclick;"function"==typeof b&&"undefined"!=typeof $("#template_body_"+
a).parents("form")[0]&&b($("#template_body_"+a).parents("form")[0])});u&&$("#template_body_"+a).find("input[type=hidden][name=resubmit_workflow_doc_load_handler]").each(function(){var b=this.onclick;"function"==typeof b&&"undefined"!=typeof $("#template_body_"+a).parents("form")[0]&&b($("#template_body_"+a).parents("form")[0])})});DocDetailWindow.renderClassChecklistWithCommentPublish(a,g,f);$("#template_body_"+a).find(".template_name").text(g.template_name);g.status!=WorkflowDoc.STATUS_FINAL_APPROVED&&
$("#template_body_"+a).find(".hide_if_not_final_approved").hide();LoginMgr.getViewerEmail()!=g.author_email&&$("#template_body_"+a).find(".hide_if_not_author").hide();LoginMgr.getViewerEmail()==g.author_email||""!=g.ghost_writer&&LoginMgr.getViewerEmail()==g.ghost_writer||$("#template_body_"+a).find(".hide_if_not_author_or_ghost_writer").hide();LoginMgr.getViewerEmail()!=g.final_approver_or_rejector_email&&$("#template_body_"+a).find(".hide_if_not_final_approver").hide();Department1SelectWindow.bindButtonClickEvent("template_body_"+
a);FieldConvert.bindUserSelectButtonEvent("template_body_"+a);FieldConvert.bindClearApproverButtonEvent("template_body_"+a);FieldConvert.bindMasterReferenceChangeEvent("template_body_"+a);IS_PRINT_WINDOW||"g"!=c&&IS_OPENID_MODE||("g"==c||WorkflowTemplate.isTemplateShowAsMaxWindow(g.template_id))&&function(){w.restore();w.maximize()}.defer("g"==c?3E3:100)}},l,n,m=0,q=function(){m++;if(3<=m){var a=WorkflowTemplate.getPreloadMasterCodesOnExistingDoc(l);if(0==a.length)k(l,n);else{var b=a.length,c=0;Ext.each(a,
function(){SateraitoWF.requestMasterData(""+this,function(a){c++;c==b&&k(l,n)})})}}};WorkflowTemplate.requestTemplateForLoadDoc(g.template_id,function(a){l=a;q()});WorkflowDoc.requestOpenNotificationList(g.doc_id,function(a){q()});UserSetting.requestUserSetting(function(a,b){n=b;q()},g.author_email)}})}};WorkflowConfig={docListConfig:null,getColumnTitle:function(a,b){var c=WorkflowConfig.getDefaultColumnTitle(b,!1);if("undefined"!=typeof a){var d;Ext.each(a,function(){this.column_id==b&&(d=this.column_title)});
"undefined"!=typeof d&&""!=d&&(c=d)}return c},getNotmalColumnIds:function(){return"submit_date template_name author_name status doc_no doc_title final_approve_no final_approved_or_rejected_date final_approver_or_rejector".split(" ")},getDefaultColumnTitle:function(a,b){var c="";switch(a){case "created_date":c=b?MyLang.getMsg("FLD_SAVE_DATE"):MyLang.getMsg("FLD_APPLY_DATE");break;case "submit_date":c=b?MyLang.getMsg("FLD_SAVE_DATE"):MyLang.getMsg("FLD_APPLY_DATE");break;case "template_name":c=MyLang.getMsg("FLD_TEMPLATE_NAME");
break;case "author_name":c=MyLang.getMsg("FLD_AUTHOR_NAME");break;case "status":c=MyLang.getMsg("FLD_STATUS");break;case "doc_no":c=MyLang.getMsg("FLD_DOC_NO");break;case "doc_title":c=MyLang.getMsg("FLD_DOC_TITLE");break;case "ghost_writer":c=MyLang.getMsg("FLD_GHOST_WRITER");break;case "ghost_writer_name":c=MyLang.getMsg("FLD_GHOST_WRITER_NAME");break;case "final_approve_no":c=MyLang.getMsg("FLD_FINAL_APPROVE_NO");break;case "final_approved_or_rejected_date":c=MyLang.getMsg("FLD_FINAL_APPROVED_OR_REJECTED_DATE");
break;case "final_approver_or_rejector":c=MyLang.getMsg("FLD_FINAL_APPROVER_OR_REJECTOR")}return c},requestDocListConfig:function(a,b){IS_OPENID_MODE?WorkflowConfig._requestDocListConfigOid(a,b):WorkflowConfig._requestDocListConfig(a,b)},_requestDocListConfigOid:function(a,b){"undefined"==typeof b&&(b=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/getdoclistconfig?hl="+SATERAITO_LANG,success:function(b,d){var e=Ext.decode(b.responseText);WorkflowConfig.docListConfig=
e;a(e)},failure:function(){b<Sateraito.EventController.MAX_RETRY&&WorkflowConfig._requestDocListConfigOid(a,b+1)}})},_requestDocListConfig:function(a,b){"undefined"==typeof b&&(b=1);DisplayMgr.isLoadMaskShown()||Sateraito.MiniMessage.showLoadingMessage();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/getdoclistconfig?hl="+SATERAITO_LANG,function(c){if(c.data){var d=c.data;Sateraito.MiniMessage.clearMessage();d=c.data;c=d.doc_list_config;WorkflowConfig.docListConfig=
c;a(c)}else Sateraito.Util.console("[getdoclistconfig]("+b+")"+c.errors[0]),401==c.rc?(DisplayMgr.hideLoadMask(),Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT"))):(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+b),b<Sateraito.EventController.MAX_RETRY?WorkflowConfig._requestDocListConfig(a,b+1):(DisplayMgr.hideLoadMask(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)))},Sateraito.Util.requestParam())}};NumUtil={addComma:function(a){a=
""+a;var b=a.indexOf(".");0>b&&(b=a.length);for(var c=a.substring(b,a.length),d=0;d<b;d++){var e=a.substring(b-1-d,b-1-d+1);if("0">e||"9"<e){c=a.substring(0,b-d)+c;break}0<d&&0==d%3&&(c=","+c);c=e+c}return c},removeComma:function(a){if("undefined"==typeof a||null==a)return"";value=""+a;return value.split(",").join("")}};OtherSetting={requestOtherSetting:function(a){IS_OPENID_MODE?OtherSetting._requestOtherSettingOid(a):OtherSetting._requestOtherSetting(a)},_requestOtherSetting:function(a,b){"undefined"==
typeof b&&(b=1);SateraitoUI.showLoadingMessage();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/othersetting/getothersetting",function(c){c.data?(SateraitoUI.clearMessage(),a(c.data)):(Sateraito.Util.console(c.errors[0]),SateraitoUI.showTimerMessage(MyLang.getMsg("RELOADING")+" "+b),b<Sateraito.EventController.MAX_RETRY?OtherSetting._requestOtherSetting(a,b+1):(DisplayMgr.hideLoadMask(),401==c.rc?SateraitoUI.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):
SateraitoUI.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)))},Sateraito.Util.requestParam())},_requestOtherSettingOid:function(a,b){"undefined"==typeof b&&(b=1);OidMiniMessage.showLoadingMessage();Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/othersetting/oid/getothersetting",success:function(b,d){var e=Ext.decode(b.responseText);OidMiniMessage.clearMessage();a(e)},failure:function(){Sateraito.Util.console("retrying "+b);b<Sateraito.EventController.MAX_RETRY?
function(){OtherSetting._requestOtherSettingOid(a,b+1)}.defer(1E3):(DisplayMgr.hideLoadMask(),OidMiniMessage.clearMessage())}})},requestUpdateOtherSettingAdmin:function(a,b){SateraitoUI.showLoadingMessage(MyLang.getMsg("UPDATING"));gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/othersetting/updateothersettingadmin",function(a){a.data?(SateraitoUI.clearMessage(),b(!0)):(Sateraito.Util.console(a.errors[0]),SateraitoUI.clearMessage(),b(!1))},Sateraito.Util.requestParam(!0,
a))},requestUpdateImpersonateEmail:function(a){IS_OPENID_MODE?OtherSetting._requestUpdateImpersonateEmailOid(a):OtherSetting._requestUpdateImpersonateEmail(a)},_requestUpdateImpersonateEmail:function(a,b){"undefined"==typeof b&&(b=1);SateraitoUI.showLoadingMessage();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/othersetting/updateimpersonateemail",function(c){SateraitoUI.clearMessage();c.data?a(c.data):(Sateraito.Util.console(c.errors[0]),SateraitoUI.showTimerMessage(MyLang.getMsg("RELOADING")+
" "+b),b<Sateraito.EventController.MAX_RETRY?OtherSetting._requestUpdateImpersonateEmail(a,b+1):401==c.rc?SateraitoUI.showTimerMessage(MyLang.getMsg("ERROR_TIMEOUT"),86400):SateraitoUI.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10))},Sateraito.Util.requestParam(!0,{}))},requestIsUserAdminOAuth2:function(a,b){"undefined"==typeof b&&(b=1);SateraitoUI.showLoadingMessage();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/datafetcher/isuseradminoauth2",
function(c){SateraitoUI.clearMessage();c.data?a(c.data):(Sateraito.Util.console(c.errors[0]),SateraitoUI.showTimerMessage(MyLang.getMsg("RELOADING")+" "+b),b<Sateraito.EventController.MAX_RETRY?OtherSetting._requestUpdateImpersonateEmail(a,b+1):401==c.rc?SateraitoUI.showTimerMessage(MyLang.getMsg("ERROR_TIMEOUT"),86400):SateraitoUI.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10))},Sateraito.Util.requestParam())},_requestUpdateImpersonateEmailOid:function(a,b){"undefined"==typeof b&&(b=1,
OidMiniMessage.showLoadingMessage());Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/othersetting/oid/updateimpersonateemail",method:"POST",timeout:12E4,success:function(b,d){var e=Ext.decode(b.responseText);OidMiniMessage.clearMessage();a(e)},failure:function(){Sateraito.Util.console("retrying "+b);b<Sateraito.EventController.MAX_RETRY?OtherSetting._requestUpdateImpersonateEmailOid(a,b+1):OidMiniMessage.clearMessage()}})},updateImpersonateEmail:function(){OtherSetting.requestUpdateImpersonateEmail(function(){Ext.Msg.show({title:MyLang.getMsg("WORKFLOW"),
icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("SETTING_SAVED"),buttons:Ext.Msg.OK})})}};DisplayMgr={loadMask:null,_isLoadMaskShown:!1,adjustByViewportWidth:function(a){var b=a;Ext.ComponentMgr.all.each(function(c){if(c.isXType("viewport")&&c.getWidth()<a)return b=c.getWidth(),!1});return b},adjustByViewportHeight:function(a){var b=a;Ext.ComponentMgr.all.each(function(c){if(c.isXType("viewport")&&c.getHeight()<a)return b=c.getHeight(),!1});return b},showLoadMask:function(){DisplayMgr.loadMask=new Ext.LoadMask(Ext.getBody(),
{msg:MyLang.getMsg("LOADING")});DisplayMgr.loadMask.show();DisplayMgr._isLoadMaskShown=!0},hideLoadMask:function(){null!=DisplayMgr.loadMask&&DisplayMgr.loadMask.hide();DisplayMgr._isLoadMaskShown=!1},isLoadMaskShown:function(){return DisplayMgr._isLoadMaskShown},toSpanWithTitle:function(a,b){null==a&&(a="");null==b&&(b="");return'<span dummy_for_sort="'+Sateraito.Util.escapeHtml(a)+'" title="'+Sateraito.Util.escapeHtml(b)+'">'+Sateraito.Util.escapeHtml(a)+"</span>"},openPopup:function(a){var b=window.open(a,
MyLang.getMsg("SIGN_IN"));finishedInterval=setInterval(function(){b.closed&&(LoginMgr.checkUser(SATERAITO_MY_SITE_URL,SATERAITO_GOOGLE_APPS_DOMAIN),clearInterval(finishedInterval))},1E3)}};CsvExportMgr={_downloadFileOid:function(a,b,c){var d=(new Date).getTime();$.timer(5E3,function(e){Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid/checkcsvtaskstatus?request_token="+encodeURIComponent(a)+"&hl="+SATERAITO_LANG,success:function(a,g){var h=Ext.decode(a.responseText);
OidMiniMessage.clearMessage();if("SUCCESS"==h.status)location.href=jsondata.download_url,e.stop(),c(!0,h.code);else if("FAILED"==h.status)e.stop(),c(!1,h.code);else{var k=Math.floor((new Date).getTime()-d);0<=b&&k>b&&(e.stop(),c(!1,h.code))}},failure:function(){e.stop();c(!1,"")}})})},_downloadFile:function(a,b,c){var d=(new Date).getTime();$.timer(5E3,function(e){gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/checkcsvtaskstatus?request_token="+
encodeURIComponent(a)+"&hl="+SATERAITO_LANG,function(a){if(a.data){var g=a.data;"SUCCESS"==g.status?(e.stop(),WorkflowUser.requestToken(function(a){var b=g.download_url,b=0>b.indexOf("?")?b+"?token="+encodeURIComponent(a.token):b+"&token="+encodeURIComponent(a.token);$("#dummy_frame").attr("src",b)}),c(!0,g.code)):"FAILED"==g.status?(e.stop(),c(!1,g.code)):(a=Math.floor((new Date).getTime()-d),0<=b&&a>b&&(e.stop(),c(!1,g.code)))}else Sateraito.Util.console("[checkcsvtaskstatus]"+a.errors[0]),401==
a.rc&&Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")),e.stop(),c(!1,"")},Sateraito.Util.requestParam(!0,{}))})},exportCsv:function(a,b,c,d){IS_OPENID_MODE?CsvExportMgr._exportCsvOid(a,b,c,d):CsvExportMgr._exportCsv(a,b,c,d)},_exportCsvOid:function(a,b,c,d){DisplayMgr.isLoadMaskShown()||OidMiniMessage.showLoadingMessage();"undefined"==typeof d&&(d=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/oid"+a,method:"POST",params:{is_admin:b,
hl:SATERAITO_LANG},success:function(a,b){var d=Ext.decode(a.responseText);OidMiniMessage.clearMessage();CsvExportMgr._downloadFileOid(d.request_token,3E5,c)},failure:function(){Sateraito.Util.console("retrying "+d);1>d?CsvExportMgr._exportCsvOid(a,b,c,d+1):OidMiniMessage.clearMessage()}})},_exportCsv:function(a,b,c,d){"undefined"==typeof d&&(d=1);Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("EXPORTING"));gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+
a,function(e){e.data?CsvExportMgr._downloadFile(e.data.request_token,3E5,c):(Sateraito.Util.console("[exportcsv]("+d+")"+e.errors[0]),401==e.rc?Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("ERROR_TIMEOUT")):(1>d?(Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+d),CsvExportMgr._exportCsv(a,b,c,d+1)):(Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_EXPORTING"),10)),c(!1,"")))},Sateraito.Util.requestParam(!0,{is_admin:b,
hl:SATERAITO_LANG}))}};DocCommentPublic={addNewCommentPublic:function(a){Ext.Msg.show({icon:Ext.MessageBox.QUESTION,msg:MyLang.getMsg("DOC_COMMENT_ADD_MSG"),buttons:Ext.Msg.OKCANCEL,fn:function(b){"ok"==b&&DocCommentPublic._addNewCommentPublic(a)}})},_addNewCommentPublic:function(a){var b=$(a).attr("doc_id"),c=$(a).attr("new_comment_id"),d=$(a).attr("reply_to_comment_id");a=Ext.getCmp("comment_tree_textarea_"+b+"_"+d).getRawValue();$("#comment_tree_textarea_buttons_render_area_"+b+"_"+d).find(":input").attr("disabled",
"disabled");DocCommentPublic.requestAddNewComment(c,b,d,a,function(){$("#comment_tree_textarea_buttons_render_area_"+b+"_"+d).find(":input").removeAttr("disabled");Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("DOC_COMMENT_ADD_SUCCESS"),buttons:Ext.Msg.OK,fn:function(){"__not_set"==d&&DocCommentPublic.requestNewCommentId(function(a){Ext.getCmp("comment_tree_textarea_"+b+"_"+d).setValue("");$("span.comment_file_attach_link[doc_id="+b+"][reply_to_comment_id="+d+"]").attr("comment_id",a);
$("div.comment_attached_file_list_render_area[doc_id="+b+"][reply_to_comment_id="+d+"]").attr("comment_id",a);$("div.comment_attached_file_list_render_area[doc_id="+b+"][reply_to_comment_id="+d+"]").html("");$("#comment_tree_textarea_buttons_render_area_"+b+"_"+d).find(":input[reply_to_comment_id="+d+"]").attr("new_comment_id",a)});DocCommentPublic.renderCommentTree(b)}})})},addNewCommentPublicPlusSM:function(a){Ext.Msg.show({icon:Ext.MessageBox.QUESTION,msg:MyLang.getMsg("DOC_COMMENT_ADD_SEND_MAIL_MSG"),
buttons:Ext.Msg.OKCANCEL,fn:function(b){"ok"==b&&DocCommentPublic._addNewCommentPublicPlusSM(a)}})},_addNewCommentPublicPlusSM:function(a){var b=$(a).attr("doc_id"),c=$(a).attr("new_comment_id"),d=$(a).attr("reply_to_comment_id");a=Ext.getCmp("comment_tree_textarea_"+b+"_"+d).getRawValue();$("#comment_tree_textarea_buttons_render_area_"+b+"_"+d).find(":input").attr("disabled","disabled");DocCommentPublic.requestAddNewCommentPlusSM(c,b,d,a,!0,function(){$("#comment_tree_textarea_buttons_render_area_"+
b+"_"+d).find(":input").removeAttr("disabled");Ext.Msg.show({icon:Ext.MessageBox.INFO,msg:MyLang.getMsg("DOC_COMMENT_ADD_SUCCESS"),buttons:Ext.Msg.OK,fn:function(){"__not_set"==d&&DocCommentPublic.requestNewCommentId(function(a){Ext.getCmp("comment_tree_textarea_"+b+"_"+d).setValue("");$("span.comment_file_attach_link[doc_id="+b+"][reply_to_comment_id="+d+"]").attr("comment_id",a);$("div.comment_attached_file_list_render_area[doc_id="+b+"][reply_to_comment_id="+d+"]").attr("comment_id",a);$("div.comment_attached_file_list_render_area[doc_id="+
b+"][reply_to_comment_id="+d+"]").html("");$("#comment_tree_textarea_buttons_render_area_"+b+"_"+d).find(":input[reply_to_comment_id="+d+"]").attr("new_comment_id",a)});DocCommentPublic.renderCommentTree(b)}})})},attachFileToComment:function(a){var b=$(a).attr("doc_id"),c=$(a).attr("comment_id");AttachFileToCommentWindow.showWindow(b,c,function(){DocCommentPublic.refreshAttachFileList(b,c)})},cancelCommentPublic:function(a){var b=$(a).attr("doc_id");$(a).attr("new_comment_id");a=$(a).attr("reply_to_comment_id");
"__not_set"==a?(Ext.getCmp("comment_tree_textarea_"+b+"_"+a).setValue(""),Ext.getCmp("comment_tree_textarea_"+b+"_"+a).setHeight(DocCommentPublic.DEFAULT_TEXTAREA_HEIGHT),$("div.comment_attached_file_list_render_area[doc_id="+b+"][reply_to_comment_id="+a+"]").html(""),$("#comment_tree_textarea_buttons_render_area_"+b+"_"+a).find(":input.comment_button").attr("disabled","disabled")):($("div.comment_reply_render_area[doc_id="+b+"][reply_to_comment_id="+a+"]").remove(),$("span.comment_reply_link[doc_id="+
b+"][comment_id="+a+"]").show())},createReplyCommentArea:function(a){DocCommentPublic.requestNewCommentId(function(b){var c=$(a).attr("doc_id"),d=$(a).attr("comment_id");b=DocCommentPublic.createCommentBoxHtml(c,b,d);$(a).hide();$(a).parent("p.comment_footer[comment_id="+d+"]").after('<div class="comment_reply_render_area" style="margin-left:20px;margin-top:15px;" doc_id="'+c+'" reply_to_comment_id="'+d+'">'+b+"</div>");DocCommentPublic.renderCommentBox(c,d)})},createCommentBoxHtml:function(a,b,c){var d;
d='<table style="width:100%"><tr>';d+='<td id="comment_tree_textarea_add_new_render_area_'+a+"_"+c+'" style="width:50%;"></td>';d+='<td style="vertical-align:top;">';d+='<span class="link_cmd comment_file_attach_link"';d+=' style="margin-left:5px;"';d+=' onclick="DocCommentPublic.attachFileToComment(this);" doc_id="'+a+'" reply_to_comment_id="'+c+'" comment_id="'+b+'">';d+='<img src="'+SATERAITO_MY_SITE_URL+'/images/clip.png" style="vertical-align:middle;">';d+=MyLang.getMsg("DOC_ATTACHMENT_FILE")+
"</span>";d+='<div style="margin:5px;" class="comment_attached_file_list_render_area" doc_id="'+a+'" reply_to_comment_id="'+c+'" comment_id="'+b+'">';d+="</div>";d+="</td>";d+="</tr>";d+="</table>";d+='<div id="comment_tree_textarea_buttons_render_area_'+a+"_"+c+'" style="margin-bottom:5px;margin-top:5px;">';d+='<input type="button" class="comment_button" value="'+MyLang.getMsg("DOC_COMMENT")+'" doc_id="'+a+'" new_comment_id="'+b+'" reply_to_comment_id="'+c+'"';d+=' onclick="DocCommentPublic.addNewCommentPublic(this);" disabled>';
d+="&nbsp;";d+='<input type="button" class="comment_button" value="'+MyLang.getMsg("POST_COMMENT_PLUS_SEND_MAIL")+'" doc_id="'+a+'" new_comment_id="'+b+'" reply_to_comment_id="'+c+'"';d+=' onclick="DocCommentPublic.addNewCommentPublicPlusSM(this);" disabled>';d+="&nbsp;";d+='<input type="button"  value="'+MyLang.getMsg("CANCEL")+'" doc_id="'+a+'" new_comment_id="'+b+'" reply_to_comment_id="'+c+'"';d+=' onclick="DocCommentPublic.cancelCommentPublic(this);">';return d+="</div>"},deleteAttachedFile:function(a){var b=
$(a).attr("doc_id"),c=$(a).attr("comment_id");a=$(a).attr("file_id");DocCommentPublic.requestDeleteCommentAttachedFile(b,c,a,function(){DocCommentPublic.refreshAttachFileList(b,c)})},openMailWindow:function(a){var b=$(a).attr("email");a=$(a).attr("user_name");var c;c=1==Sateraito.Util.isSmartPhone()?"https://mail.google.com/mail/mu/mp/333/#co/to=":"https://mail.google.com/a/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/?view=cm&fs=1&tf=1&su=&to=";b=encodeURI(c+('"'+a+'" <'+b+">"));window.open(b)},refreshAttachFileList:function(a,
b){DocCommentPublic.requestCommentAttachedFileList(a,b,function(c){var d="";Ext.each(c,function(){var c=(""+this.file_name).split("."),f="0";"pdf"==c[c.length-1].toLowerCase()&&(f="1");d+='<span class="link_cmd download_attached_file" file_id="'+this.file_id+'" downloadable="1" is_pdf="'+f+'" is_comment_attach="1">';d+=this.file_name;d+="</span>&nbsp;";d+='<img title="'+MyLang.getMsg("PREVIEW_ON_GOOGLE_DRIVE")+'" onclick="WorkflowDoc.openGoogleDocViewer(this);" file_id="'+this.file_id+'"  src="'+
SATERAITO_MY_SITE_URL+'/images/preview.gif" style="cursor:pointer;width:15px;height:15px; vertical-align: bottom;" class="info" >&nbsp;';d+='<input type="button" value="'+MyLang.getMsg("DELETE_FILE")+'" doc_id="'+a+'" comment_id="'+b+'" file_id="'+this.file_id+'"';d+=' onclick="DocCommentPublic.deleteAttachedFile(this);">';d+="<br>"});$("div.comment_attached_file_list_render_area[doc_id="+a+"][comment_id="+b+"]").html(d)})},renderCommentTree:function(a){var b=function(a,b){var c=[];Ext.each(a,function(){""+
this.reply_to_comment_id==b&&c.push(this)});return c},c=function(b,c){var d="",d=d+('<div class="comment_entry" comment_id="'+b.comment_id+'" style="margin-left:'+c+'px;margin-bottom:10px;background-color:#F8F8F8;padding:5px;">'),d=d+"<p>",d=d+('<span style="font-weight:bold;" title="'+Sateraito.Util.escapeHtml(b.author_email)+'">'),d=d+Sateraito.Util.escapeHtml(b.author_name),d=d+"</span>",d=d+"&nbsp;",d=d+('<span class="link_cmd" email="'+Sateraito.Util.escapeHtml(b.author_email)+'" user_name="'+
Sateraito.Util.escapeHtml(b.author_name)+'" onclick="DocCommentPublic.openMailWindow(this);">'),d=d+(Sateraito.Util.escapeHtml(b.author_email)+"</span>"),d=d+("&nbsp;&nbsp;&nbsp;"+Sateraito.Util.enterToBr(b.created_date)),d=d+"</p>",d=d+'<p style="margin:8px;word-break:break-all;">',d=d+Sateraito.Util.enterToBr(Sateraito.Util.escapeHtml(b.comment)),d=d+"</p>",d=d+('<p class="comment_footer" comment_id="'+b.comment_id+'">');IS_PRINT_WINDOW||(d+='<span class="link_cmd comment_reply_link" onclick="DocCommentPublic.createReplyCommentArea(this);" doc_id="'+
a+'" comment_id="'+b.comment_id+'">',d+=MyLang.getMsg("DOC_COMMENT_REPLY")+"</span>");0<b.attached_files.length&&(d+="&nbsp;&nbsp;"+MyLang.getMsg("DOC_ATTACHMENT_FILE_DOWNLOAD")+"\uff1a&nbsp;",Ext.each(b.attached_files,function(){var a=(""+this.file_name).split("."),b="0";"pdf"==a[a.length-1].toLowerCase()&&(b="1");d+='<span class="link_cmd download_attached_file" file_id="'+this.file_id+'" downloadable="1" is_pdf="'+b+'" is_comment_attach="1">';d+=this.file_name+"</span>&nbsp;&nbsp;";d+='<img title="'+
MyLang.getMsg("PREVIEW_ON_GOOGLE_DRIVE")+'" onclick="WorkflowDoc.openGoogleDocViewer(this);" file_id="'+this.file_id+'"  src="'+SATERAITO_MY_SITE_URL+'/images/preview.gif" style="cursor:pointer;width:15px;height:15px; vertical-align: bottom;" class="info" >&nbsp;'}));d+="</p>";return d+="</div>"},d=function(e,f,g){f=b(e,f);Ext.each(f,function(){var b=c(this,g);$("#comment_tree_render_area_"+a).append(b);d(e,this.comment_id,g+20)})};$("#comment_tree_render_area_"+a).html("");DocCommentPublic.requestComments(a,
function(a){d(a,"__not_set",0)})},renderPublicCommentArea:function(a){DocCommentPublic.requestNewCommentId(function(b){var c="";IS_PRINT_WINDOW||(c+=DocCommentPublic.createCommentBoxHtml(a,b,"__not_set"));c+='<div id="comment_tree_render_area_'+a+'"></div>';$("#comment_tree_area_"+a).html(c);IS_PRINT_WINDOW||DocCommentPublic.renderCommentBox(a,"__not_set");DocCommentPublic.renderCommentTree(a)})},DEFAULT_TEXTAREA_HEIGHT:30,renderCommentBox:function(a,b){new Ext.form.TextArea({id:"comment_tree_textarea_"+
a+"_"+b,emptyText:MyLang.getMsg("DOC_ADD_COMMENT"),grow:!0,renderTo:"comment_tree_textarea_add_new_render_area_"+a+"_"+b,width:400,growMin:DocCommentPublic.DEFAULT_TEXTAREA_HEIGHT,enableKeyEvents:!0,docId:a,replyToCommentId:b,enableOrDisableButtons:function(c){""==(""+c.getRawValue()).trim()?$("#comment_tree_textarea_buttons_render_area_"+a+"_"+b).find(":input.comment_button").attr("disabled","disabled"):$("#comment_tree_textarea_buttons_render_area_"+a+"_"+b).find(":input.comment_button").removeAttr("disabled")},
listeners:{blur:function(a){this.enableOrDisableButtons(this)},keyup:function(a){this.enableOrDisableButtons(this)}}})},requestCommentAttachedFileList:function(a,b,c,d){IS_OPENID_MODE?DocCommentPublic._requestCommentAttachedFileListOid(a,b,c,d):DocCommentPublic._requestCommentAttachedFileList(a,b,c,d)},_requestCommentAttachedFileListOid:function(a,b,c,d){"undefined"==typeof d&&(d=1,OidMiniMessage.showLoadingMessage());Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+
LoginMgr.appId+"/attach/oid/getcommentattachedfilelist?doc_id="+encodeURIComponent(a)+"&comment_id="+encodeURIComponent(b)+"&hl="+SATERAITO_LANG,method:"GET",success:function(a,b){var d=Ext.decode(a.responseText);OidMiniMessage.clearMessage();c(d)},failure:function(){Sateraito.Util.console("retrying "+d);d<Sateraito.EventController.MAX_RETRY?DocCommentPublic._requestCommentAttachedFileListOid(a,b,c,d+1):OidMiniMessage.clearMessage()}})},_requestCommentAttachedFileList:function(a,b,c,d){"undefined"==
typeof d&&(d=1,Sateraito.MiniMessage.showLoadingMessage());var e=SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/attach/getcommentattachedfilelist?doc_id="+encodeURIComponent(a)+"&comment_id="+encodeURIComponent(b)+"&hl="+SATERAITO_LANG;gadgets.io.makeRequest(e,function(e){e.data?(Sateraito.MiniMessage.clearMessage(),c(e.data)):(Sateraito.Util.console(e.errors[0]),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+d),d<Sateraito.EventController.MAX_RETRY?
DocCommentPublic._requestCommentAttachedFileList(a,b,c,d+1):(Sateraito.MiniMessage.clearMessage(),401==e.rc?Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_TIMEOUT"),86400):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)))},Sateraito.Util.requestParam())},requestNewCommentId:function(a,b){IS_OPENID_MODE?DocCommentPublic._requestNewCommentIdOid(a,b):DocCommentPublic._requestNewCommentId(a,b)},_requestNewCommentIdOid:function(a,b){"undefined"==typeof b&&(b=
1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/commentpublish/oid/getnewcommentid",method:"GET",success:function(b,d){var e=Ext.decode(b.responseText);Sateraito.MiniMessage.clearMessage();a(e.new_comment_id)},failure:function(){Sateraito.Util.console("retrying "+b);b<Sateraito.EventController.MAX_RETRY?DocCommentPublic._requestNewCommentIdOid(a,b+1):OidMiniMessage.clearMessage()}})},_requestNewCommentId:function(a,b){"undefined"==typeof b&&(b=
1);gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/commentpublish/getnewcommentid",function(c){c.data?a(c.data.new_comment_id):(Sateraito.Util.console(c.errors[0]),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+b),b<Sateraito.EventController.MAX_RETRY?DocCommentPublic._requestNewCommentId(a,b+1):Sateraito.MiniMessage.showTimerMessage(Sateraito.Lang.getMsg("FAILED_TO_LOAD_SETTINGS"),10))},Sateraito.Util.requestParam())},requestAddNewComment:function(a,
b,c,d,e,f){IS_OPENID_MODE?DocCommentPublic._requestAddNewCommentOid(a,b,c,d,e,f):DocCommentPublic._requestAddNewComment(a,b,c,d,e,f)},_requestAddNewComment:function(a,b,c,d,e,f){"undefined"==typeof f&&(f=1);Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("NOW_UPDATING"));gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/commentpublish/addnewcomment",function(a){a.data?(a=a.data,Sateraito.MiniMessage.clearMessage(),e(a)):(Sateraito.Util.console(a.errors[0]),
Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ADD_NEW_COMMENT_ERR_MSG"),10))},Sateraito.Util.requestParam(!0,{comment_id:a,doc_id:b,reply_to_comment_id:c,comment:d,hl:SATERAITO_LANG}))},_requestAddNewCommentOid:function(a,b,c,d,e,f){"undefined"==typeof f&&(f=1);OidMiniMessage.showLoadingMessage(MyLang.getMsg("NOW_UPDATING"));Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/commentpublish/oid/addnewcomment",
method:"POST",params:{comment_id:a,doc_id:b,reply_to_comment_id:c,comment:d,hl:SATERAITO_LANG},success:function(a,b){OidMiniMessage.clearMessage();var c=Ext.decode(a.responseText);e(c)},failure:function(){OidMiniMessage.showNormalMiniMessage(MyLang.getMsg("ADD_NEW_COMMENT_ERR_MSG"),10)}})},requestAddNewCommentPlusSM:function(a,b,c,d,e,f,g){IS_OPENID_MODE?DocCommentPublic._requestAddNewCommentPlusSMOid(a,b,c,d,e,f,g):DocCommentPublic._requestAddNewCommentPlusSM(a,b,c,d,e,f,g)},_requestAddNewCommentPlusSM:function(a,
b,c,d,e,f,g){"undefined"==typeof g&&(g=1);Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("NOW_UPDATING"));gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/commentpublish/addnewcomment",function(a){a.data?(a=a.data,Sateraito.MiniMessage.clearMessage(),f(a)):(Sateraito.Util.console(a.errors[0]),Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ADD_NEW_COMMENT_ERR_MSG"),10))},Sateraito.Util.requestParam(!0,
{comment_id:a,doc_id:b,reply_to_comment_id:c,comment:d,is_send_mail:e,hl:SATERAITO_LANG}))},_requestAddNewCommentPlusSMOid:function(a,b,c,d,e,f,g){"undefined"==typeof g&&(g=1);OidMiniMessage.showLoadingMessage(MyLang.getMsg("NOW_UPDATING"));Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/commentpublish/oid/addnewcomment",method:"POST",params:{comment_id:a,doc_id:b,reply_to_comment_id:c,comment:d,is_send_mail:e,hl:SATERAITO_LANG},success:function(a,
b){OidMiniMessage.clearMessage();var c=Ext.decode(a.responseText);f(c)},failure:function(){OidMiniMessage.showNormalMiniMessage(MyLang.getMsg("ADD_NEW_COMMENT_ERR_MSG"),10)}})},requestDeleteCommentAttachedFile:function(a,b,c,d,e){IS_OPENID_MODE?DocCommentPublic._requestDeleteCommentAttachedFileOid(a,b,c,d,e):DocCommentPublic._requestDeleteCommentAttachedFile(a,b,c,d,e)},_requestDeleteCommentAttachedFileOid:function(a,b,c,d,e){"undefined"==typeof e&&(e=1);OidMiniMessage.showLoadingMessage(MyLang.getMsg("NOW_UPDATING"));
Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/attach/oid/deletecommentattachedfile",method:"POST",params:{doc_id:a,comment_id:b,file_id:c,hl:SATERAITO_LANG},success:function(a,b){OidMiniMessage.clearMessage();var c=Ext.decode(a.responseText);(function(){d(c)}).defer(1E3)},failure:function(){OidMiniMessage.showNormalMiniMessage(MyLang.getMsg("DELETE_COMMENT_ATTACHED_FILE_ERR_MSG"),10)}})},_requestDeleteCommentAttachedFile:function(a,b,c,d,e){"undefined"==
typeof e&&(e=1);Sateraito.MiniMessage.showLoadingMessage(MyLang.getMsg("NOW_UPDATING"));gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/attach/deletecommentattachedfile",function(a){if(a.data){var b=a.data;Sateraito.MiniMessage.clearMessage();(function(){d(b)}).defer(1E3)}else Sateraito.Util.console(a.errors[0]),Sateraito.MiniMessage.clearMessage(),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("DELETE_COMMENT_ATTACHED_FILE_ERR_MSG"),10)},Sateraito.Util.requestParam(!0,
{doc_id:a,comment_id:b,file_id:c,hl:SATERAITO_LANG}))},requestComments:function(a,b,c){IS_OPENID_MODE?DocCommentPublic._requestCommentsOid(a,b,c):DocCommentPublic._requestComments(a,b,c)},_requestCommentsOid:function(a,b,c){"undefined"==typeof c&&(c=1);Ext.Ajax.request({url:SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/commentpublish/oid/getcomments?doc_id="+a,method:"GET",success:function(a,c){var f=Ext.decode(a.responseText);OidMiniMessage.clearMessage();b(f)},failure:function(){Sateraito.Util.console("retrying "+
c);c<Sateraito.EventController.MAX_RETRY?DocCommentPublic._requestCommentsOid(a,b,c+1):OidMiniMessage.clearMessage()}})},_requestComments:function(a,b,c){"undefined"==typeof c&&(c=1);Sateraito.MiniMessage.showLoadingMessage();gadgets.io.makeRequest(SATERAITO_MY_SITE_URL+"/"+SATERAITO_GOOGLE_APPS_DOMAIN+"/"+LoginMgr.appId+"/commentpublish/getcomments?doc_id="+a,function(d){d.data||(Sateraito.Util.console(d.errors[0]),Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("RELOADING")+" "+c),c<Sateraito.EventController.MAX_RETRY?
DocCommentPublic._requestComments(a,b,c+1):(Sateraito.MiniMessage.clearMessage(),401==d.rc?Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_TIMEOUT"),86400):Sateraito.MiniMessage.showTimerMessage(MyLang.getMsg("ERROR_WHILE_LOADING"),10)));d=d.data;Sateraito.MiniMessage.clearMessage();b(d)},Sateraito.Util.requestParam())}};MyUtil={isValidAppId:function(a){return!/^[a-zA-Z][a-zA-Z0-9_-]+$/.test(a)||1<a.split("_____").length?!1:!0},getToken:function(){return USER_TOKEN},setToken:function(a){USER_TOKEN=
a}};MyUtil={isValidAppId:function(a){return!/^[a-zA-Z][a-zA-Z0-9_-]+$/.test(a)||1<a.split("_____").length?!1:!0}};DocDetailWindow={init:function(a){var b=[];$("#template_body_"+a).find("*").each(function(){var a=$(this).attr("name");"undefined"!=typeof a&&null!=a&&""!=a&&"process"!=a.toLowerCase()&&b.push(a)});DocDetailWindow.showInputFields(b,a);FieldConvert.bindMasterSelectButtonEvent("template_body_"+a,a);FieldConvert.bindEventToGoogleCalendarButtonEvent("template_body_"+a,a)},showInputFields:function(a,
b,c,d){var e=Ext.ComponentMgr.get("form_panel_"+b).getForm();Ext.each(a,function(){var a=""+this,g=$("#template_body_"+b).find(":input[name="+a+"]");$(g).attr("name");var h=$(g).attr("type");"undefined"==typeof h&&(h="text");h=h.toLowerCase();$(g).is("select")?($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show()):$(g).is("textarea")?($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show()):"checkbox"==h?($("#template_body_"+b).find("span.sateraito_doc_value[name="+
a+"]").hide(),$(g).show()):"radio"==h?($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show()):$(g).is("input")&&"text"==h?($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show(),$(g).hasClass("number")&&FieldConvert._numberFieldConvert("template_body_"+b,e,g),$(g).hasClass("date")&&(a=$(g).parents("div:hidden"),$(a).show(),FieldConvert._dateFieldConvert("template_body_"+b,e,g),$(a).hide())):$(g).is("input")&&0<=$.inArray(h,"date datetime datetime-local month week time number range search tel url email color".split(" "))?
($("#template_body_"+b).find("span.sateraito_doc_value[name="+a+"]").hide(),$(g).show(),c||d||$(g).removeAttr("disabled")):"button"==h&&($(g).is(".sateraito_master_select")&&$(g).show(),$(g).is(".clear_button")&&$(g).show())});$("#template_body_"+b).find(":input").change(function(){Calc.calcAll("template_body_"+b)});FieldConvert.bindClearButtonEvent("template_body_"+b)}}})();
